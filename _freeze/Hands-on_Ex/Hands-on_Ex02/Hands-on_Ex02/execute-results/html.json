{
  "hash": "82b3e4a4cf59d647808ed487f026ed47",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 2\"\ndate: 21 Apr 2025\ndate-modified: \"last-modified\"\nauthor: \"Liaw Ying Ting, Celin\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# Extension of ggplot 2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  pacman::p_load(ggrepel, patchwork, ggthemes, hrbrthemes, tidyverse)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"Exam_data.csv\")\n```\n:::\n\n\n\n## Overlapping Annotations\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label(aes(label = ID), \n             hjust = .5, \n             vjust = -.5) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## Using ggrepel to repel overlapping text\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label_repel(aes(label = ID), \n                   fontface = \"bold\") +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n# Ggplot2 Themes:\n\n## Classic Theme\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  theme_classic() +\n  ggtitle(\"Distribution of Maths scores\") \n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Economist Theme\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum(base_family = \"sans\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## Combining ggplot2 graphs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum(axis_title_size = 18,\n              base_size = 15,\n              grid = \"Y\",\n              base_family = \"sans\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, \n                 y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n\n\n## Combining 2 Plots side by side\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Combining 3 graphs - Using \"/\" to stack 2 graphs and \"\\|\" to place the plots beside each other\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## Placing plots next to each other based on the provided layout - using inset_element\n\ninset_element:\n\n-   Left = 0.02 - left edge start 2% from left side of the main plot\n\n-   Bottom = 0.7 - Bottom edge start 70% from the bottom of the main plot (Near the top)\n\n-   Right = 0.5 - Right edge ends at 50% of the width\n\n-   top = 1 top edge ends at 100% of height\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, \n                   left = 0.02, \n                   bottom = 0.7, \n                   right = 0.5, \n                   top = 1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## Using patchwork and theme together\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork <- (p1 / p2) | p3\npatchwork & theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n# Visual Analytics Methods of the Week\n\n## Plotting a Box Plot of the English scores of the different classes\n\n-   From the box plot below, there is a downward trend of English scores from 3A to 3I, showing that students from Class 3A generally scored better than students in the other classes\n\n-   There are also some classes with outliers, for example class 3E and 3F where there are one or more students who scored significantly lower than the rest of the class\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, aes(y = ENGLISH, x= CLASS)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n## Plotting a Violin Plot of science scores in the different Races\n\n-   From the violin plot, it can be seen that there is a majority of \"Chinese\" students who scored in the 75 range and \"Other\" students scoring in the 68 range for science subject\n\n-   For Indian students, their science scores are quite evenly spread out from 12.5 to 87.5\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(y = SCIENCE, \n           x= RACE)) +\n  geom_violin()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n## Plotting a pie chart of the proportion of the different races\n\n-   It can be seen from the pie chart that more than half of the student population are Chinese and the next majority is Malay\n\n-   The Indian and Other students seem to have the same proportion\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nrace_counts <- exam_data %>%\n  count(RACE)\n\nggplot(race_counts, aes(x = \"\", y = n, fill = RACE)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(theta = \"y\") +\n  labs(title = \"Student Distribution by Race\",\n       y = NULL,\n       x = NULL,\n       fill = \"Race\") +\n  theme_void() +\n  theme(plot.title = element_text(hjust = 0.5, size = 16))\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## Raincloud Plots of Scores by Gender\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggdist)\n\n# ensure GENDER is a factor\nexam_data$GENDER <- as.factor(exam_data$GENDER)\n\na1 <- ggplot(exam_data, aes(x = ENGLISH, y = GENDER, fill = GENDER)) +\n  # lighter half-density cloud\n  stat_halfeye(\n    side          = \"right\",\n    adjust        = 0.5,\n    width         = 0.6,\n    justification = 0.1,\n    .width        = 0,\n    point_colour  = NA,\n    alpha         = 0.3\n  ) +\n  # central boxplot\n  geom_boxplot(\n    width         = 0.12,\n    outlier.shape = NA,\n    position      = position_nudge(y = 0.2),\n    alpha         = 0.8\n  ) +\n  # jittered points on top\n  geom_jitter(\n    width  = 0,\n    height = 0.15,\n    size   = 1.5,\n    alpha  = 0.6,\n    aes(color = GENDER)\n  ) +\n  # matching palette\n  scale_fill_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  scale_color_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  # side-by-side panels\n  facet_wrap(~ GENDER, nrow = 1, scales = \"free_y\") +\n  theme_ipsum_rc(base_size = 12) +\n  labs(\n    title = \"Raincloud Plot of English Scores by Gender\",\n    x     = \"English Score\",\n    y     = NULL\n  ) +\n  theme(\n    legend.position    = \"none\",\n    axis.text.y        = element_blank(),\n    axis.ticks.y       = element_blank(),\n    panel.grid.major.y = element_blank()\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ensure GENDER is a factor\nexam_data$GENDER <- as.factor(exam_data$GENDER)\n\na2 <- ggplot(exam_data, aes(x = MATHS, y = GENDER, fill = GENDER)) +\n  # lighter half-density cloud\n  stat_halfeye(\n    side          = \"right\",\n    adjust        = 0.5,\n    width         = 0.6,\n    justification = 0.1,\n    .width        = 0,\n    point_colour  = NA,\n    alpha         = 0.3\n  ) +\n  # central boxplot\n  geom_boxplot(\n    width         = 0.12,\n    outlier.shape = NA,\n    position      = position_nudge(y = 0.2),\n    alpha         = 0.8\n  ) +\n  # jittered points on top\n  geom_jitter(\n    width  = 0,\n    height = 0.15,\n    size   = 1.5,\n    alpha  = 0.6,\n    aes(color = GENDER)\n  ) +\n  # matching palette\n  scale_fill_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  scale_color_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  # side-by-side panels\n  facet_wrap(~ GENDER, nrow = 1, scales = \"free_y\") +\n  theme_ipsum_rc(base_size = 12) +\n  labs(\n    title = \"Raincloud Plot of Maths Scores by Gender\",\n    x     = \"English Score\",\n    y     = NULL\n  ) +\n  theme(\n    legend.position    = \"none\",\n    axis.text.y        = element_blank(),\n    axis.ticks.y       = element_blank(),\n    panel.grid.major.y = element_blank()\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ensure GENDER is a factor\nexam_data$GENDER <- as.factor(exam_data$GENDER)\n\na3 <- ggplot(exam_data, aes(x = SCIENCE, y = GENDER, fill = GENDER)) +\n  # lighter half-density cloud\n  stat_halfeye(\n    side          = \"right\",\n    adjust        = 0.5,\n    width         = 0.6,\n    justification = 0.1,\n    .width        = 0,\n    point_colour  = NA,\n    alpha         = 0.3\n  ) +\n  # central boxplot\n  geom_boxplot(\n    width         = 0.12,\n    outlier.shape = NA,\n    position      = position_nudge(y = 0.2),\n    alpha         = 0.8\n  ) +\n  # jittered points on top\n  geom_jitter(\n    width  = 0,\n    height = 0.15,\n    size   = 1.5,\n    alpha  = 0.6,\n    aes(color = GENDER)\n  ) +\n  # matching palette\n  scale_fill_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  scale_color_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  # side-by-side panels\n  facet_wrap(~ GENDER, nrow = 1, scales = \"free_y\") +\n  theme_ipsum_rc(base_size = 12) +\n  labs(\n    title = \"Raincloud Plot of Science Scores by Gender\",\n    x     = \"English Score\",\n    y     = NULL\n  ) +\n  theme(\n    legend.position    = \"none\",\n    axis.text.y        = element_blank(),\n    axis.ticks.y       = element_blank(),\n    panel.grid.major.y = element_blank()\n  )\n```\n:::\n\n\n\nUsing \"/\" to combine the charts, we can get the figures below.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/combined-raincloud-1.png){width=768}\n:::\n:::\n\n\n\n## Diverging Stacked Bar Chart split by Gender\n\nThe subjects are split into 3 bands for each subject: Low(0-39), Medium(40-69), High(70-100).\n\nFrom the charts, there are more females in the High band for English and Science Subjects while the Math subjects are more or less equal for both females and males.\n\nIn the medium band for English, there are more males then females while for Math and Science, there are more females than males.\n\nIn the low band, however, there are consistently more males than females.\n\nTo conclude, females generally score higher for English and Science subjects and score higher than males in general.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(forcats)\n\n# 1. Categorize each subject into performance bands\nexam_bands <- exam_data %>%\n  mutate(\n    ENGLISH_BAND = cut(ENGLISH, breaks = c(-Inf, 39, 69, 100),\n                       labels = c(\"Low\", \"Medium\", \"High\")),\n    MATHS_BAND   = cut(MATHS,   breaks = c(-Inf, 39, 69, 100),\n                       labels = c(\"Low\", \"Medium\", \"High\")),\n    SCIENCE_BAND = cut(SCIENCE, breaks = c(-Inf, 39, 69, 100),\n                       labels = c(\"Low\", \"Medium\", \"High\"))\n  )\n\n# 2. Reshape data to long format for faceting\nlong_bands <- exam_bands %>%\n  select(GENDER, ENGLISH_BAND, MATHS_BAND, SCIENCE_BAND) %>%\n  pivot_longer(cols = ends_with(\"_BAND\"),\n               names_to = \"SUBJECT\",\n               values_to = \"PERFORMANCE\") %>%\n  mutate(\n    SUBJECT = recode(SUBJECT,\n                     ENGLISH_BAND = \"English\",\n                     MATHS_BAND = \"Maths\",\n                     SCIENCE_BAND = \"Science\"),\n    PERFORMANCE = factor(PERFORMANCE, levels = c(\"Low\", \"Medium\", \"High\"))\n  )\n\n# 3. Prepare data for plotting\nplot_data <- long_bands %>%\n  count(SUBJECT, GENDER, PERFORMANCE) %>%\n  mutate(n = ifelse(GENDER == \"Male\", -n, n))\n\n# 4. Create diverging stacked bar chart with facets\nggplot(plot_data, aes(x = PERFORMANCE, y = n, fill = GENDER)) +\n  geom_bar(stat = \"identity\", width = 0.7) +\n  coord_flip() +\n  facet_wrap(~ SUBJECT, ncol = 1, scales = \"free_y\") +\n  scale_y_continuous(labels = abs) +\n  scale_fill_manual(values = c(\"Female\" = \"#00AFBB\", \"Male\" = \"#FC4E07\")) +\n  labs(\n    title = \"Diverging Stacked Bar Charts: Performance Bands by Gender\",\n    x = \"Performance Band\",\n    y = \"Number of Students\"\n  ) +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}