{
  "hash": "bbec3bc749c967a4287e9168d740e531",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Exercise 1 Part 2\"\nauthor: \"Liaw Ying Ting, Celin\"\ndate: 7 May 2025\ndate-modified: \"last-modified\"\n\nformat:\n  html:\n    code-fold: true\n    code-tools: true\n\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1 Overview\n\nFor part 2 of the Take-Home Exercise 1, I will be evaluating one of my peer's [Ng Wee Tinn Shermainn's](https://isss608-sherm.netlify.app/take-home_ex/take-home_ex01/take-home_ex01) website for her Take-Home Exercise 1. I will be providing 3 good design principles and 3 areas for further improvements for the data visualisation plots done by Shermainn\n\n# 2 Critique of Plots\n\n## 2.1 Top 10 subzones of each age group\n\n**3 Good Design Principles:**\n\n-   Analysis is split into the different population age groups which makes it easier to analyse the graphs based on the age groups\n\n-   The analysis identifies the top 10 subzones for each age group and makes it easier to identify the facilities that are required for each subzone based on age group\n\n-   The graphs are ordered in descending order according to their population (from the largest population to the 10th largest population), making it easier for viewing based on the position of the bar graph, making it easy to identify which subzone has the largest population\n\n**3 Areas for Further Improvements:**\n\n-   The colours for the bar charts are in shades of grey which makes it hard to differentiate the different subzones. It would be better if specific colours are used for each area. In the code below, I will be adding colours to the graphs to make it easy to differentiate between the different subzones.\n\n-   There are many tabs in one page and it may be hard to do comparisons. It would be better to make them all in 1 page so that comparisons can be done easily. The code <code style=\"color: blue;\">#\\| code-fold: true</code> is added so that the codes can be hidden and only the graphs are shown for easier comparisons.\n\n-   The chart also only shows the top 10 subzones but the other subzones were not shown. It would be better if the lowest 10 subzones or all subzones can be shown. In the makeover below, I will be adding the top and bottom 10 subzones for easy reference.\n\n**I have added screenshots of her graphs below:**\n\n![](images/clipboard-3643626400.png)\n\n![](images/clipboard-113017287.png)\n\n![![](images/clipboard-3905315391.png)](images/clipboard-3870114261.png)\n\n![](images/clipboard-3918813645.png)\n\n![![](images/clipboard-1500488551.png)](images/clipboard-1048234095.png)\n\n## 2.2 Data Wrangling\n\n### 2.2.1 Load Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,patchwork, ggthemes, dplyr)\n```\n:::\n\n\n\n### 2.2.2 Import Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata <- read_csv(\"respopagesex2024.csv\")\n```\n:::\n\n\n\n### 2.2.3 Categorizing into Main zones and Subzones\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Clean and process the data\npopdata_cleaned <- popdata %>%\n  rename(\n    Planning_Area = PA,\n    Subzone = SZ,\n    Population = Pop\n  ) %>%\n  filter(Sex != \"Total\", Age != \"Total\", Subzone != \"Total\") %>%\n  mutate(\n    Population = as.numeric(Population),\n    Age = as.numeric(Age),\n    Age_Group = case_when(\n      Age >= 0 & Age <= 4 ~ \"Young (0-4)\",\n      Age >= 5 & Age <= 12 ~ \"Youth (5-12)\",\n      Age >= 13 & Age <= 17 ~ \"Teens (13-17)\",\n      Age >= 18 & Age <= 64 ~ \"Working Adults (18-64)\",\n      Age >= 65 ~ \"Elderly (65+)\",\n      TRUE ~ NA_character_\n    )\n  ) %>%\n  filter(!is.na(Age_Group)) %>%\n  group_by(Planning_Area, Subzone, Age_Group) %>%\n  summarise(Total_Population = sum(Population, na.rm = TRUE), .groups = \"drop\")\n\n# View results\nhead(popdata_cleaned)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  Planning_Area Subzone                Age_Group              Total_Population\n  <chr>         <chr>                  <chr>                             <dbl>\n1 Ang Mo Kio    Ang Mo Kio Town Centre Elderly (65+)                       880\n2 Ang Mo Kio    Ang Mo Kio Town Centre Teens (13-17)                       290\n3 Ang Mo Kio    Ang Mo Kio Town Centre Working Adults (18-64)             3170\n4 Ang Mo Kio    Ang Mo Kio Town Centre Young (0-4)                         120\n5 Ang Mo Kio    Ang Mo Kio Town Centre Youth (5-12)                        420\n6 Ang Mo Kio    Cheng San              Elderly (65+)                      6580\n```\n\n\n:::\n:::\n\n\n\n### 2.2.4 Top 10 and Bottom 10 Subzones of each age group\n\nIn this code, i have added colours to the different Subzones and also put the top 10 and bottom 10 subzones side-by-side to make it more easier to compare.\n\nThe code <code style=\"color: blue;\">#\\| code-fold: true</code> is also added at the top of the codes to make sure the codes are collapsible and the other graphs can be easily comparable after collapsing the codes. They have also been displayed from the youngest to the oldest.\n\n**Top 10 vs Bottom 10 Subzones of Young Population (0-4 Years Old)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load necessary libraries\npacman::p_load(tidyverse, patchwork, RColorBrewer)\n\n# Get top 10 and bottom 10 subzones of young population\ntop_young_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Young (0-4)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\nbottom_young_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Young (0-4)\", Total_Population > 0) %>%\n  arrange(Total_Population) %>%\n  slice_head(n = 10)\n\n# SAFE color assignment for top and bottom (brewer.pal only works up to 12 for Set3 and 8 for Pastel2)\ntop_n <- nrow(top_young_subzones)\nbottom_n <- nrow(bottom_young_subzones)\n\ntop_palette <- brewer.pal(max(3, min(top_n, 12)), \"Set3\")\nbottom_palette <- brewer.pal(max(3, min(bottom_n, 8)), \"Pastel2\")\n\ntop_colors <- setNames(top_palette[1:top_n], top_young_subzones$Subzone)\nbottom_colors <- setNames(bottom_palette[1:bottom_n], bottom_young_subzones$Subzone)\n\n# Plot: Top 10\ny1 <- ggplot(top_young_subzones, \n             aes(x = reorder(Subzone, Total_Population), \n                 y = Total_Population, \n                 fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Top 10 Subzones\\n of Young Population\",\n    x = \"Subzone\",\n    y = \"Number of Young Residents\"\n  ) +\n  scale_fill_manual(values = top_colors) +\n  scale_y_continuous(\n    breaks = seq(0, max(top_young_subzones$Total_Population), by = 1000),\n    labels = function(x) paste0(x / 1000, \"K\"),\n    limits = c(0, max(top_young_subzones$Total_Population) + 1000),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Plot: Bottom 10\ny2 <- ggplot(bottom_young_subzones, \n             aes(x = reorder(Subzone, Total_Population), \n                 y = Total_Population, \n                 fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Bottom 10 Subzones\\n of Young Population\",\n    x = \"Subzone\",\n    y = \"Number of Young Residents\"\n  ) +\n  scale_fill_manual(values = bottom_colors) +\n  scale_y_continuous(\n    limits = c(0, max(bottom_young_subzones$Total_Population) + 50),\n    labels = function(x) ifelse(x >= 1000, paste0(x / 1000, \"K\"), x),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Combine the plots side by side\ny1 + y2 +\n  plot_layout(ncol = 2) +\n  plot_annotation(\n    title = \"Comparison of Young Population (0–4YO)\\n Across Singapore Subzones\",\n    subtitle = \"Top 10 vs Bottom 10 Subzones of Youngest Residents\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 12)\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_Part2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n**Top 10 vs Bottom 10 Subzones of Youths (5-12 Years Old)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load required packages\npacman::p_load(tidyverse, patchwork, RColorBrewer)\n\n# Get top 10 and bottom 10 subzones of youth population\ntop_youth_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Youth (5-12)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\nbottom_youth_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Youth (5-12)\", Total_Population > 0) %>%\n  arrange(Total_Population) %>%\n  slice_head(n = 10)\n\n# Safely assign palette colors\ntop_n <- nrow(top_youth_subzones)\nbottom_n <- nrow(bottom_youth_subzones)\n\ntop_palette <- brewer.pal(max(3, min(top_n, 12)), \"Set3\")\nbottom_palette <- brewer.pal(max(3, min(bottom_n, 8)), \"Pastel2\")\n\ntop_colors <- setNames(top_palette[1:top_n], top_youth_subzones$Subzone)\nbottom_colors <- setNames(bottom_palette[1:bottom_n], bottom_youth_subzones$Subzone)\n\n# Plot: Top 10\ny_top <- ggplot(top_youth_subzones, \n                aes(x = reorder(Subzone, Total_Population), \n                    y = Total_Population, \n                    fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Top 10 Subzones of\\n Youth Population\",\n    x = \"Subzone\",\n    y = \"Number of Youth Residents\"\n  ) +\n  scale_fill_manual(values = top_colors) +\n  scale_y_continuous(\n    breaks = seq(0, 10000, by = 2000),\n    labels = function(x) paste0(x / 1000, \"K\"),\n    limits = c(0, max(top_youth_subzones$Total_Population) + 2000),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Plot: Bottom 10\ny_bottom <- ggplot(bottom_youth_subzones, \n                   aes(x = reorder(Subzone, Total_Population), \n                       y = Total_Population, \n                       fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Bottom 10 Subzones of\\n Youth Population\",\n    x = \"Subzone\",\n    y = \"Number of Youth Residents\"\n  ) +\n  scale_fill_manual(values = bottom_colors) +\n  scale_y_continuous(\n    limits = c(0, max(bottom_youth_subzones$Total_Population) + 50),\n    labels = function(x) ifelse(x >= 1000, paste0(x / 1000, \"K\"), x),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Combine both plots side by side\ny_top + y_bottom +\n  plot_layout(ncol = 2) +\n  plot_annotation(\n    title = \"Comparison of Youth Population (5–12YO)\\n Across Singapore Subzones\",\n    subtitle = \"Top 10 vs Bottom 10 Subzones of Youth Residents\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 12)\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_Part2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n**Top 10 vs Bottom 10 Subzones of Teens (13-17 Years Old)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load required packages\npacman::p_load(tidyverse, patchwork, RColorBrewer)\n\n# Get top 10 and bottom 10 subzones by teen population\ntop_teen_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Teens (13-17)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\nbottom_teen_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Teens (13-17)\", Total_Population > 0) %>%\n  arrange(Total_Population) %>%\n  slice_head(n = 10)\n\n# Color-safe assignment\ntop_n <- nrow(top_teen_subzones)\nbottom_n <- nrow(bottom_teen_subzones)\n\ntop_palette <- brewer.pal(max(3, min(top_n, 12)), \"Set3\")\nbottom_palette <- brewer.pal(max(3, min(bottom_n, 8)), \"Pastel2\")\n\ntop_colors <- setNames(top_palette[1:top_n], top_teen_subzones$Subzone)\nbottom_colors <- setNames(bottom_palette[1:bottom_n], bottom_teen_subzones$Subzone)\n\n# Plot: Top 10\nt_top <- ggplot(top_teen_subzones, \n                aes(x = reorder(Subzone, Total_Population), \n                    y = Total_Population, \n                    fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Top 10 Subzones of\\n Teen Population\",\n    x = \"Subzone\",\n    y = \"Number of Teen Residents\"\n  ) +\n  scale_fill_manual(values = top_colors) +\n  scale_y_continuous(\n    breaks = seq(0, 6000, by = 1000),\n    labels = function(x) paste0(x / 1000, \"K\"),\n    limits = c(0, max(top_teen_subzones$Total_Population) + 1000),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Plot: Bottom 10\nt_bottom <- ggplot(bottom_teen_subzones, \n                   aes(x = reorder(Subzone, Total_Population), \n                       y = Total_Population, \n                       fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Bottom 10 Subzones of\\n Teen Population\",\n    x = \"Subzone\",\n    y = \"Number of Teen Residents\"\n  ) +\n  scale_fill_manual(values = bottom_colors) +\n  scale_y_continuous(\n    limits = c(0, max(bottom_teen_subzones$Total_Population) + 50),\n    labels = function(x) ifelse(x >= 1000, paste0(x / 1000, \"K\"), x),\n    expand = c(0, 0)\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Combine both plots side by side\nt_top + t_bottom +\n  plot_layout(ncol = 2) +\n  plot_annotation(\n    title = \"Comparison of Teen Population (13–17YO)\\n Across Singapore Subzones\",\n    subtitle = \"Top 10 vs Bottom 10 Subzones of Teen Residents\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 12)\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_Part2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n**Top 10 vs Bottom 10 Subzones of Working Adults (18-64 Years Old)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load required packages\npacman::p_load(tidyverse, patchwork, RColorBrewer, scales)\n\n# Get top 10 and bottom 10 subzones by working adults population\ntop_working_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Working Adults (18-64)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\nbottom_working_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Working Adults (18-64)\", Total_Population > 0) %>%\n  arrange(Total_Population) %>%\n  slice_head(n = 10)\n\n# Safely assign colors based on count\ntop_n <- nrow(top_working_subzones)\nbottom_n <- nrow(bottom_working_subzones)\n\ntop_palette <- brewer.pal(max(3, min(top_n, 12)), \"Set3\")\nbottom_palette <- brewer.pal(max(3, min(bottom_n, 8)), \"Pastel2\")\n\ntop_colors <- setNames(top_palette[1:top_n], top_working_subzones$Subzone)\nbottom_colors <- setNames(bottom_palette[1:bottom_n], bottom_working_subzones$Subzone)\n\n# Plot: Top 10\na_top <- ggplot(top_working_subzones, \n                aes(x = reorder(Subzone, Total_Population), \n                    y = Total_Population, \n                    fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = comma(Total_Population)), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  coord_flip() +\n  labs(\n    title = \"Top 10 Subzones of\\nWorking Adult Population\",\n    x = \"Subzone\",\n    y = \"Number of Working Adults\"\n  ) +\n  scale_fill_manual(values = top_colors) +\n  scale_y_continuous(\n  breaks = seq(0, 100000, by = 20000),\n  limits = c(0, 110000 + 5000),\n  expand = c(0, 0),\n  labels = function(x) paste0(x / 1000, \"K\")\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Plot: Bottom 10\na_bottom <- ggplot(bottom_working_subzones, \n                   aes(x = reorder(Subzone, Total_Population), \n                       y = Total_Population, \n                       fill = Subzone)) +\n  geom_col() +\n  geom_text(aes(label = comma(Total_Population)), \n            hjust = -0.1, size = 3.5, color = \"black\") +  # adjusted label position\n  coord_flip() +\n  labs(\n    title = \"Bottom 10 Subzones of\\nWorking Adult Population\",\n    x = \"Subzone\",\n    y = \"Number of Working Adults\"\n  ) +\n  scale_fill_manual(values = bottom_colors) +\n  scale_y_continuous(\n    limits = c(0, max(bottom_working_subzones$Total_Population) + 500),\n    expand = c(0, 0),\n    labels = comma\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Combine both plots side by side\na_top + a_bottom +\n  plot_layout(ncol = 2) +\n  plot_annotation(\n    title = \"Comparison of Working Adult Population (18–64YO)\\nAcross Singapore Subzones\",\n    subtitle = \"Top 10 vs Bottom 10 Subzones of Working Adults Residents\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 12)\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_Part2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n**Top 10 vs Bottom 10 Subzones of Elderly Population (65+ Years Old)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ntop_elderly_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Elderly (65+)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\n# Load required libraries\npacman::p_load(tidyverse, patchwork, ggthemes, RColorBrewer)\n\n# Load the data\npopdata <- read_csv(\"respopagesex2024.csv\")\n\n# Clean and process the data\npopdata_cleaned <- popdata %>%\n  rename(\n    Planning_Area = PA,\n    Subzone = SZ,\n    Population = Pop\n  ) %>%\n  filter(Sex != \"Total\", Age != \"Total\", Subzone != \"Total\") %>%\n  mutate(\n    Population = as.numeric(Population),\n    Age = as.numeric(Age),\n    Age_Group = case_when(\n      Age >= 0 & Age <= 4 ~ \"Young (0-4)\",\n      Age >= 5 & Age <= 12 ~ \"Youth (5-12)\",\n      Age >= 13 & Age <= 17 ~ \"Teens (13-17)\",\n      Age >= 18 & Age <= 64 ~ \"Working Adults (18-64)\",\n      Age >= 65 ~ \"Elderly (65+)\",\n      TRUE ~ NA_character_\n    )\n  ) %>%\n  filter(!is.na(Age_Group)) %>%\n  group_by(Planning_Area, Subzone, Age_Group) %>%\n  summarise(Total_Population = sum(Population, na.rm = TRUE), .groups = \"drop\")\n\n# Top 10 subzones by elderly population\ntop_elderly_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Elderly (65+)\") %>%\n  arrange(desc(Total_Population)) %>%\n  slice_head(n = 10)\n\n# Bottom 10 subzones (filter out 0s)\nbottom_elderly_subzones <- popdata_cleaned %>%\n  filter(Age_Group == \"Elderly (65+)\", Total_Population > 0) %>%\n  arrange(Total_Population) %>%\n  slice_head(n = 10)\n\n# Plot: Top 10\ne1 <- ggplot(top_elderly_subzones, \n             aes(x = reorder(Subzone, Total_Population), \n                 y = Total_Population, \n                 fill = Subzone)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +  # Move label inside\n  labs(\n    title = \"Top 10 Subzones\\n by Elderly Population\",\n    x = \"Subzone\",\n    y = \"Elderly Population\"\n  ) +\n  scale_fill_brewer(palette = \"Set3\") +\n  scale_x_discrete(expand = expansion(mult = c(0.05, 0.05))) +\n  # scale_y_continuous(\n  #   breaks = seq(0, 25000, by = 5000),  # Cleaner axis ticks\n  #   limits = c(0, max(top_elderly_subzones$Total_Population) + 2000),  \n  #   expand = c(0, 0)  \n  # ) +\n  scale_y_continuous(\n  breaks = seq(0, 25000, by = 5000),  # Tick marks at 5K intervals\n  limits = c(0, max(top_elderly_subzones$Total_Population) + 2000),\n  labels = function(x) paste0(x / 1000, \"K\"),\n  expand = c(0, 0)\n  ) +\n\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Plot: Bottom 10\ne2 <- ggplot(bottom_elderly_subzones, \n             aes(x = reorder(Subzone, Total_Population), \n                 y = Total_Population, \n                 fill = Subzone)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = Total_Population), \n            hjust = 1.05, size = 3.5, color = \"black\") +\n  labs(\n    title = \"Bottom 10 Subzones\\n by Elderly Population\",\n    x = \"Subzone\",\n    y = \"Elderly Population\"\n  ) +\n  scale_fill_brewer(palette = \"Set3\") +\n  scale_x_discrete(expand = expansion(mult = c(0.05, 0.05))) +\n  scale_y_continuous(\n    limits = c(0, max(bottom_elderly_subzones$Total_Population) + 20),  \n    expand = c(0, 0)  \n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5, face = \"bold\"),\n    axis.text = element_text(size = 10)\n  )\n\n# Combine plots side by side\ne1 + e2 + \n  plot_layout(ncol = 2) + \n  plot_annotation(\n    title = \"Comparison of Elderly Population(65+ YO)\\n Across Singapore Subzones\",\n    subtitle = \"Top 10 vs Bottom 10 Subzones of Elderly Residents (Age 65+)\",\n    theme = theme(\n      plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n      plot.subtitle = element_text(hjust = 0.5, size = 12)\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex01_Part2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-Home_Ex01_Part2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}