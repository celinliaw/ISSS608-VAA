<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liaw Ying Ting, Celin">
<meta name="dcterms.date" content="2025-05-13">

<title>Hands-On_Ex05 - Modelling, Visualising and Analysing Network Data with R – Celin’s ISSS608 Site</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Assets/orange_cat_favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2f6844b3748638c5738d4cf93630e566.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Celin’s ISSS608 Site</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part1.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part3.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part4.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex01/In-Class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex02/In-Class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex03/In-Class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex04/In-Class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex05/In-Class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex06/In-Class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex07/In-Class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex08/In-Class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex09/In-Class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex10/In-Class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01_Part2.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#modelling-visualising-and-analysing-network-data-with-r" id="toc-modelling-visualising-and-analysing-network-data-with-r" class="nav-link active" data-scroll-target="#modelling-visualising-and-analysing-network-data-with-r">9 Modelling, Visualising and Analysing Network Data with R</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">9.1 Overview</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">9.2 Getting Started</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">9.3 The Data</a>
  <ul class="collapse">
  <li><a href="#the-edges-data" id="toc-the-edges-data" class="nav-link" data-scroll-target="#the-edges-data">9.3.1 The Edges Data</a></li>
  <li><a href="#the-nodes-data" id="toc-the-nodes-data" class="nav-link" data-scroll-target="#the-nodes-data">9.3.2 The Nodes Data</a></li>
  <li><a href="#importing-network-data-from-files" id="toc-importing-network-data-from-files" class="nav-link" data-scroll-target="#importing-network-data-from-files">9.3.3 Importing network data from files</a></li>
  <li><a href="#reviewing-imported-data" id="toc-reviewing-imported-data" class="nav-link" data-scroll-target="#reviewing-imported-data">9.3.4 Reviewing Imported Data</a></li>
  <li><a href="#wrangling-time" id="toc-wrangling-time" class="nav-link" data-scroll-target="#wrangling-time">9.3.5 Wrangling Time</a></li>
  <li><a href="#reviewing-the-revised-date-fields" id="toc-reviewing-the-revised-date-fields" class="nav-link" data-scroll-target="#reviewing-the-revised-date-fields">9.3.6 Reviewing the revised date fields</a></li>
  <li><a href="#wrangling-attributes" id="toc-wrangling-attributes" class="nav-link" data-scroll-target="#wrangling-attributes">9.3.7 Wrangling Attributes</a></li>
  <li><a href="#reviewing-the-revised-edges-file" id="toc-reviewing-the-revised-edges-file" class="nav-link" data-scroll-target="#reviewing-the-revised-edges-file">9.3.8 Reviewing the revised edges file</a></li>
  </ul></li>
  <li><a href="#creating-network-objects-using-tidygraph" id="toc-creating-network-objects-using-tidygraph" class="nav-link" data-scroll-target="#creating-network-objects-using-tidygraph">9.4 Creating network objects using tidygraph</a>
  <ul class="collapse">
  <li><a href="#the-tbl_graph-object" id="toc-the-tbl_graph-object" class="nav-link" data-scroll-target="#the-tbl_graph-object">9.4.1 The tbl_graph object</a></li>
  <li><a href="#the-dplyr-verbs-in-tidygraph" id="toc-the-dplyr-verbs-in-tidygraph" class="nav-link" data-scroll-target="#the-dplyr-verbs-in-tidygraph">9.4.2 The dplyr verbs in tidygraph</a></li>
  <li><a href="#using-tbl_graph-to-build-tidy-graph-data-model" id="toc-using-tbl_graph-to-build-tidy-graph-data-model" class="nav-link" data-scroll-target="#using-tbl_graph-to-build-tidy-graph-data-model">9.4.3 Using <code>tbl_graph()</code> to build tidy graph data model</a></li>
  <li><a href="#reviewing-the-output-tidygraphs-graph-object" id="toc-reviewing-the-output-tidygraphs-graph-object" class="nav-link" data-scroll-target="#reviewing-the-output-tidygraphs-graph-object">9.4.4 Reviewing the output tidygraph’s graph object</a></li>
  <li><a href="#reviewing-the-output-tidygraphs-graph-object-1" id="toc-reviewing-the-output-tidygraphs-graph-object-1" class="nav-link" data-scroll-target="#reviewing-the-output-tidygraphs-graph-object-1">9.4.5 Reviewing the output tidygraph’s graph object</a></li>
  <li><a href="#changing-the-active-object" id="toc-changing-the-active-object" class="nav-link" data-scroll-target="#changing-the-active-object">9.4.6 Changing the active object</a></li>
  </ul></li>
  <li><a href="#plotting-static-network-graphs-with-ggraph-package" id="toc-plotting-static-network-graphs-with-ggraph-package" class="nav-link" data-scroll-target="#plotting-static-network-graphs-with-ggraph-package">9.5 Plotting Static Network Graphs with ggraph package</a>
  <ul class="collapse">
  <li><a href="#plotting-a-basic-network-graph" id="toc-plotting-a-basic-network-graph" class="nav-link" data-scroll-target="#plotting-a-basic-network-graph">9.5.1 Plotting a basic network graph</a></li>
  <li><a href="#changing-the-default-network-graph-theme" id="toc-changing-the-default-network-graph-theme" class="nav-link" data-scroll-target="#changing-the-default-network-graph-theme">9.5.2 Changing the default network graph theme</a></li>
  <li><a href="#changing-the-coloring-of-the-plot" id="toc-changing-the-coloring-of-the-plot" class="nav-link" data-scroll-target="#changing-the-coloring-of-the-plot">9.5.3 Changing the coloring of the plot</a></li>
  <li><a href="#working-with-ggraphs-layouts" id="toc-working-with-ggraphs-layouts" class="nav-link" data-scroll-target="#working-with-ggraphs-layouts">9.5.4 Working with ggraph’s layouts</a></li>
  <li><a href="#modifying-network-nodes" id="toc-modifying-network-nodes" class="nav-link" data-scroll-target="#modifying-network-nodes">9.5.6 Modifying network nodes</a></li>
  </ul></li>
  <li><a href="#creating-facet-graphs" id="toc-creating-facet-graphs" class="nav-link" data-scroll-target="#creating-facet-graphs">9.6 Creating Facet Graphs</a>
  <ul class="collapse">
  <li><a href="#working-with-facet_edges" id="toc-working-with-facet_edges" class="nav-link" data-scroll-target="#working-with-facet_edges">9.6.1 Working with <em>facet_edges()</em></a></li>
  <li><a href="#working-with-facet_edges-1" id="toc-working-with-facet_edges-1" class="nav-link" data-scroll-target="#working-with-facet_edges-1">9.6.2 Working with <em>facet_edges()</em></a></li>
  <li><a href="#a-framed-facet-graph" id="toc-a-framed-facet-graph" class="nav-link" data-scroll-target="#a-framed-facet-graph">9.6.3 A Framed facet graph</a></li>
  <li><a href="#working-with-facet_nodes" id="toc-working-with-facet_nodes" class="nav-link" data-scroll-target="#working-with-facet_nodes">9.6.4 Working with <em>facet_nodes()</em></a></li>
  </ul></li>
  <li><a href="#network-metrics-analysis" id="toc-network-metrics-analysis" class="nav-link" data-scroll-target="#network-metrics-analysis">9.7 Network Metrics Analysis</a>
  <ul class="collapse">
  <li><a href="#computing-centrality-indices" id="toc-computing-centrality-indices" class="nav-link" data-scroll-target="#computing-centrality-indices">9.7.1 Computing centrality indices</a></li>
  <li><a href="#visualising-network-metrics" id="toc-visualising-network-metrics" class="nav-link" data-scroll-target="#visualising-network-metrics">9.7.2 Visualising network metrics</a></li>
  </ul></li>
  <li><a href="#building-interactive-network-graph-with-visnetwork" id="toc-building-interactive-network-graph-with-visnetwork" class="nav-link" data-scroll-target="#building-interactive-network-graph-with-visnetwork">9.8 Building Interactive Network Graph with visNetwork</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">9.8.1 Data Preparation</a></li>
  <li><a href="#plotting-the-first-interactive-network-graph" id="toc-plotting-the-first-interactive-network-graph" class="nav-link" data-scroll-target="#plotting-the-first-interactive-network-graph">9.8.2 Plotting the first interactive network graph</a></li>
  <li><a href="#working-with-layout" id="toc-working-with-layout" class="nav-link" data-scroll-target="#working-with-layout">9.8.3 Working with layout</a></li>
  <li><a href="#working-with-visual-attributes---nodes" id="toc-working-with-visual-attributes---nodes" class="nav-link" data-scroll-target="#working-with-visual-attributes---nodes">9.8.4 Working with visual attributes - Nodes</a></li>
  <li><a href="#working-with-visual-attributes---edges" id="toc-working-with-visual-attributes---edges" class="nav-link" data-scroll-target="#working-with-visual-attributes---edges">9.8.5 Working with visual Attributes - Edges</a></li>
  <li><a href="#interactivity" id="toc-interactivity" class="nav-link" data-scroll-target="#interactivity">9.8.6 Interactivity</a></li>
  </ul></li>
  <li><a href="#building-circular-plots---extra" id="toc-building-circular-plots---extra" class="nav-link" data-scroll-target="#building-circular-plots---extra">9.9 Building Circular Plots - Extra</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Hands-On_Ex05 - Modelling, Visualising and Analysing Network Data with R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liaw Ying Ting, Celin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 13, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 15, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="modelling-visualising-and-analysing-network-data-with-r" class="level1">
<h1>9 Modelling, Visualising and Analysing Network Data with R</h1>
</section>
<section id="overview" class="level1">
<h1>9.1 Overview</h1>
<p>In the hands-on exercise, I will be learning how to model, analyse and visualize network data with R.</p>
<p>By the end of this hands-on exercise, I will be able to:</p>
<ul>
<li><p>Create graph objects data frames, manipulate them using appropriate appropriate functions of <em>dpylr, lubricate and tidygraph</em></p></li>
<li><p>Build network graph visualisation using appropriate functions of <em>ggraph</em></p></li>
<li><p>compute network geometrics using <em>tidygraph</em></p></li>
<li><p>build advanced graph visualisation by incorporating the network geometrics</p></li>
<li><p>build interactive network visualisation using <em>visNetwork</em> package</p></li>
</ul>
</section>
<section id="getting-started" class="level1">
<h1>9.2 Getting Started</h1>
<p>9.2.1 Installing and Launching R Packages</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(igraph, tidygraph, ggraph, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               visNetwork, lubridate, clock,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               tidyverse, graphlayouts, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               concaveman, ggforce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="the-data" class="level1">
<h1>9.3 The Data</h1>
<p>The data sets used in this hands-on exercise is from an oil exploration and extraction company. There are two data sets. One contains the nodes data and the other contains the edges (also known as link) data.</p>
<section id="the-edges-data" class="level2">
<h2 class="anchored" data-anchor-id="the-edges-data">9.3.1 The Edges Data</h2>
<ul>
<li><em>GAStech_email_edge-v2.csv</em> consists of the names, department and title of 55 employees</li>
</ul>
<p><img src="images/clipboard-1196216663.png" class="img-fluid"></p>
</section>
<section id="the-nodes-data" class="level2">
<h2 class="anchored" data-anchor-id="the-nodes-data">9.3.2 The Nodes Data</h2>
<ul>
<li>GAStech_email_nodes.csv consists of the names, department and title of the 55 employees</li>
</ul>
<p><img src="images/clipboard-688382718.png" class="img-fluid"></p>
</section>
<section id="importing-network-data-from-files" class="level2">
<h2 class="anchored" data-anchor-id="importing-network-data-from-files">9.3.3 Importing network data from files</h2>
<p>In this step, GAStech_email_node.csv and GAStech_email_edges-v2.csv will be imported into Rstudio environment by using <code style="color: blue;">read_csv</code> of <strong>readr</strong> package.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>GAStech_nodes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"GAStech_email_node.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>GAStech_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"GAStech_email_edge-v2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reviewing-imported-data" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-imported-data">9.3.4 Reviewing Imported Data</h2>
<p>Next, the structure of the data frame will be examined using <em>glimpse()</em> of <strong>dplyr.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(GAStech_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,063
Columns: 8
$ source      &lt;dbl&gt; 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…
$ target      &lt;dbl&gt; 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…
$ SentDate    &lt;chr&gt; "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014"…
$ SentTime    &lt;time&gt; 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…
$ Subject     &lt;chr&gt; "GT-SeismicProcessorPro Bug Report", "GT-SeismicProcessorP…
$ MainSubject &lt;chr&gt; "Work related", "Work related", "Work related", "Work rela…
$ sourceLabel &lt;chr&gt; "Sven.Flecha", "Sven.Flecha", "Kanon.Herrero", "Kanon.Herr…
$ targetLabel &lt;chr&gt; "Isak.Baza", "Lucas.Alcazar", "Felix.Resumir", "Hideki.Coc…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The output report of GAStech_edges above revelas that the <em>SentDate</em> is treated as “Character” data type instead of <em>date</em> data type. This is an error! Before we continue, it is important for us to change the data type of <em>SentDate</em> field back to “Date” data type.</p>
</div>
</div>
</section>
<section id="wrangling-time" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-time">9.3.5 Wrangling Time</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>GAStech_edges <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SendDate =</span> <span class="fu">dmy</span>(SentDate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">wday</span>(SentDate,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>both</li>
</ul>
<!-- -->
<ul>
<li>both <code>dmy()</code> and <code>wday()</code> are functions of <strong>lubridate</strong> package. <a href="https://lubridate.tidyverse.org/">lubridate</a> is an R package that makes it easier to work with dates and times.</li>
<li><code>dmy()</code> transforms the <code>SentDate</code> to Date data type.</li>
<li><code>wday()</code> returns the day of the week as a decimal number or an ordered factor if label is TRUE. The argument abbr is FALSE keeps the daya spells in full, i.e.&nbsp;Monday. The function will create a new column in the data.frame i.e.&nbsp;Weekday and the output of <code>wday()</code> will save in this newly created field</li>
<li>the values in the <em>weekday</em> field are in ordinal scale</li>
</ul>
</div>
</div>
</section>
<section id="reviewing-the-revised-date-fields" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-the-revised-date-fields">9.3.6 Reviewing the revised date fields</h2>
<p>Table below shows the data structure of the reformatted <em>GAStech_edges</em> data frame</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,063
Columns: 10
$ source      &lt;dbl&gt; 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…
$ target      &lt;dbl&gt; 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…
$ SentDate    &lt;chr&gt; "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014"…
$ SentTime    &lt;time&gt; 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…
$ Subject     &lt;chr&gt; "GT-SeismicProcessorPro Bug Report", "GT-SeismicProcessorP…
$ MainSubject &lt;chr&gt; "Work related", "Work related", "Work related", "Work rela…
$ sourceLabel &lt;chr&gt; "Sven.Flecha", "Sven.Flecha", "Kanon.Herrero", "Kanon.Herr…
$ targetLabel &lt;chr&gt; "Isak.Baza", "Lucas.Alcazar", "Felix.Resumir", "Hideki.Coc…
$ SendDate    &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-0…
$ Weekday     &lt;ord&gt; Friday, Friday, Friday, Friday, Friday, Friday, Friday, Fr…</code></pre>
</div>
</div>
</section>
<section id="wrangling-attributes" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-attributes">9.3.7 Wrangling Attributes</h2>
<p>A close examination of <em>GAStech_edges</em> data.frame reveals that it consists of individual e-mail flow records. This is not very useful for visualisation.</p>
<p>In view of this, we will aggregate the individual by date, senders, receivers, main subject and day of the week.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>GAStech_edges_aggregated <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MainSubject <span class="sc">==</span> <span class="st">"Work related"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, Weekday) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>four functions from <strong>dplyr</strong> package are used. They are: <em>filter(), group(), summarise()</em> and <em>ungroup()</em></li>
<li>The output data.frame is called <strong>GAStech_edges_aggregated</strong></li>
<li>A new field called <em>Weight</em> has been added in GAStech_edges_aggregated</li>
</ul>
</div>
</div>
</section>
<section id="reviewing-the-revised-edges-file" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-the-revised-edges-file">9.3.8 Reviewing the revised edges file</h2>
<p>Table below shows the data structure of the reformatted <em>GAStech_edges</em> data frame</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,063
Columns: 10
$ source      &lt;dbl&gt; 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…
$ target      &lt;dbl&gt; 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…
$ SentDate    &lt;chr&gt; "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014", "6/1/2014"…
$ SentTime    &lt;time&gt; 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…
$ Subject     &lt;chr&gt; "GT-SeismicProcessorPro Bug Report", "GT-SeismicProcessorP…
$ MainSubject &lt;chr&gt; "Work related", "Work related", "Work related", "Work rela…
$ sourceLabel &lt;chr&gt; "Sven.Flecha", "Sven.Flecha", "Kanon.Herrero", "Kanon.Herr…
$ targetLabel &lt;chr&gt; "Isak.Baza", "Lucas.Alcazar", "Felix.Resumir", "Hideki.Coc…
$ SendDate    &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-0…
$ Weekday     &lt;ord&gt; Friday, Friday, Friday, Friday, Friday, Friday, Friday, Fr…</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-network-objects-using-tidygraph" class="level1">
<h1>9.4 Creating network objects using tidygraph</h1>
<p>In this section, you will learn how to create a graph data model by using <strong>tidygraph</strong> package. It provides a tidy API for graph/network manipulation. While network data itself is not tidy, it can be envisioned as two tidy tables, one for node data and one for edge data. <strong>Tidygraph</strong> provides a way to switch between the two tables and provides <strong>dplyr</strong> verbs for manipulating them. Furthermore, it provides access to a lot of graph algorithms with return values that facilitate their use in a tidy workflow.</p>
<p>The two articles below provide more information:</p>
<ul>
<li><p><a href="https://www.data-imaginist.com/2017/introducing-tidygraph/">Introducing tidygraph</a></p></li>
<li><p><a href="https://www.data-imaginist.com/posts/2018-02-12-tidygraph-1-1-a-tidy-hope/index.html">Tidygraph 1.1 - A Tidy hope</a></p></li>
</ul>
<section id="the-tbl_graph-object" class="level2">
<h2 class="anchored" data-anchor-id="the-tbl_graph-object">9.4.1 The tbl_graph object</h2>
<p>Two functions of <strong>tidygraph</strong> package can be used to create network objects, they are:</p>
<ul>
<li><p><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">tbl_graph()</a> creates a <strong>tbl_graph</strong> net work object from nodes and edges data</p></li>
<li><p><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">as_tbl_graph()</a> converts network data and objects to a <strong>tbl_graph</strong> network. Below are network data and objects supported by <code>as_tbl_graph()</code></p>
<ul>
<li><p>a node data.frame and an edge data.frame</p></li>
<li><p>data.frame, lst, matrix from base</p></li>
<li><p>igraph from igraph</p></li>
<li><p>network from network</p></li>
<li><p>dendogram and hclust from stats</p></li>
<li><p>Node from data.tree</p></li>
<li><p>phylo and evonet from ape</p></li>
<li><p>graphNEL, graphAM, graphBAM from graph (in Bioconductor)</p></li>
</ul></li>
</ul>
</section>
<section id="the-dplyr-verbs-in-tidygraph" class="level2">
<h2 class="anchored" data-anchor-id="the-dplyr-verbs-in-tidygraph">9.4.2 The dplyr verbs in tidygraph</h2>
<ul>
<li><em>activate()</em> verb from <strong>tidygraph</strong> serves as a switch between tibbles for nodes and edges. All dpylr verbs applied to <strong>tbl_graph</strong> object are applied to the active tibble</li>
</ul>
<p><img src="images/clipboard-2816690708.png" class="img-fluid"></p>
<ul>
<li>In the above the <em>.N()</em> function is used to gain access to the node data while manipulating the edge data. Similarly, <em>.E()</em> will give the edge data and <em>.G()</em> will give you the <strong>tbl_graph</strong> object itself</li>
</ul>
</section>
<section id="using-tbl_graph-to-build-tidy-graph-data-model" class="level2">
<h2 class="anchored" data-anchor-id="using-tbl_graph-to-build-tidy-graph-data-model">9.4.3 Using <code>tbl_graph()</code> to build tidy graph data model</h2>
<p>In this section, <code>tbl_graph()</code> of <strong>tinygraph</strong> package will be used to build a tidygraph’s network graph data.frame.</p>
<p>A reference guide of <a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">tbl_graph</a> can be found here.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>GAStech_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> GAStech_nodes,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> GAStech_edges_aggregated, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reviewing-the-output-tidygraphs-graph-object" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-the-output-tidygraphs-graph-object">9.4.4 Reviewing the output tidygraph’s graph object</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>GAStech_graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 54 nodes and 1372 edges
#
# A directed multigraph with 1 component
#
# Node Data: 54 × 4 (active)
      id label               Department     Title                               
   &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;          &lt;chr&gt;                               
 1     1 Mat.Bramar          Administration Assistant to CEO                    
 2     2 Anda.Ribera         Administration Assistant to CFO                    
 3     3 Rachel.Pantanal     Administration Assistant to CIO                    
 4     4 Linda.Lagos         Administration Assistant to COO                    
 5     5 Ruscella.Mies.Haber Administration Assistant to Engineering Group Mana…
 6     6 Carla.Forluniau     Administration Assistant to IT Group Manager       
 7     7 Cornelia.Lais       Administration Assistant to Security Group Manager 
 8    44 Kanon.Herrero       Security       Badging Office                      
 9    45 Varja.Lagos         Security       Badging Office                      
10    46 Stenig.Fusil        Security       Building Control                    
# ℹ 44 more rows
#
# Edge Data: 1,372 × 4
   from    to Weekday Weight
  &lt;int&gt; &lt;int&gt; &lt;ord&gt;    &lt;int&gt;
1     1     2 Sunday       5
2     1     2 Monday       2
3     1     2 Tuesday      3
# ℹ 1,369 more rows</code></pre>
</div>
</div>
</section>
<section id="reviewing-the-output-tidygraphs-graph-object-1" class="level2">
<h2 class="anchored" data-anchor-id="reviewing-the-output-tidygraphs-graph-object-1">9.4.5 Reviewing the output tidygraph’s graph object</h2>
<ul>
<li><p>The output above reveals that&nbsp;<em>GAStech_graph</em>&nbsp;is a tbl_graph object with 54 nodes and 4541 edges</p></li>
<li><p>The command also prints the first six rows of “Node Data” and the first three of “Edge Data”.</p></li>
<li><p>It states that the Node Data is <strong>active</strong>. The notion of an active tibble within a tbl_graph object makes it possible to manipulate the data in one tibble at a time.</p></li>
</ul>
</section>
<section id="changing-the-active-object" class="level2">
<h2 class="anchored" data-anchor-id="changing-the-active-object">9.4.6 Changing the active object</h2>
<p>The nodes tibble data frame is activated by default, but you can change which tibble data frame is active with the&nbsp;<em>activate()</em>&nbsp;function. Thus, if we wanted to rearrange the rows in the edges tibble to list those with the highest “weight” first, we could use&nbsp;<em>activate()</em>&nbsp;and then&nbsp;<em>arrange()</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 54 nodes and 1372 edges
#
# A directed multigraph with 1 component
#
# Edge Data: 1,372 × 4 (active)
    from    to Weekday   Weight
   &lt;int&gt; &lt;int&gt; &lt;ord&gt;      &lt;int&gt;
 1    40    41 Saturday      13
 2    41    43 Monday        11
 3    35    31 Tuesday       10
 4    40    41 Monday        10
 5    40    43 Monday        10
 6    36    32 Sunday         9
 7    40    43 Saturday       9
 8    41    40 Monday         9
 9    19    15 Wednesday      8
10    35    38 Tuesday        8
# ℹ 1,362 more rows
#
# Node Data: 54 × 4
     id label           Department     Title           
  &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;           
1     1 Mat.Bramar      Administration Assistant to CEO
2     2 Anda.Ribera     Administration Assistant to CFO
3     3 Rachel.Pantanal Administration Assistant to CIO
# ℹ 51 more rows</code></pre>
</div>
</div>
<p>More information can be found in the reference guide of <a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate()</a>.</p>
</section>
</section>
<section id="plotting-static-network-graphs-with-ggraph-package" class="level1">
<h1>9.5 Plotting Static Network Graphs with ggraph package</h1>
<p>Ggraph is an extension of ggplot2, making it easier to carry over basic ggplot skills to the design of network graphs.</p>
<p>As in all network graphs, there are three main aspects to a ggraph’s network graph, they are:</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Nodes.html">nodes</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Edges.html">edges</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Layouts.html">layouts</a></p></li>
</ul>
<p>For a comprehensive discussion of each of this aspect of graph, please refer to their respective vignettes provided.</p>
<section id="plotting-a-basic-network-graph" class="level2">
<h2 class="anchored" data-anchor-id="plotting-a-basic-network-graph">9.5.1 Plotting a basic network graph</h2>
<p>The code chunk below uses <a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph()</a>, <a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom-edge_link()</a>, and <a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a> to plot a network graph by using <em>GAStech_graph.</em></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The basic plotting function is <code>ggraph()</code>, which takes the data to be used for the graph and the type of layout desired. Both of the arguments for <code>ggraph</code> are built around <em>igraph</em>. Therefore, <code>ggraph()</code> can use either an <em>igraph</em> object or a tbl_graph object</li>
</ul>
</div>
</div>
</section>
<section id="changing-the-default-network-graph-theme" class="level2">
<h2 class="anchored" data-anchor-id="changing-the-default-network-graph-theme">9.5.2 Changing the default network graph theme</h2>
<p>In this section, you will use <a href="https://ggraph.data-imaginist.com/reference/theme_graph.html">theme_graph()</a> to remove the x and y axes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>())</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>ggraph</strong> introduces a special ggplot theme that provides better defaults for network graphs than the normal ggplot defaults. <code>theme_graph()</code>, besides removing axes, grids and broder, changes the font to Arial Narrow (this can be overridden)</p></li>
<li><p>The ggraph theme can be set for a series of plots with the <code>set_graph_style()</code> command run before the graphs are plotted or by using <code>theme_graph()</code> in the individual plots</p></li>
</ul>
</div>
</div>
</section>
<section id="changing-the-coloring-of-the-plot" class="level2">
<h2 class="anchored" data-anchor-id="changing-the-coloring-of-the-plot">9.5.3 Changing the coloring of the plot</h2>
<p>The code <code>theme_graph()</code> makes it easy to change the coloring of the plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">'grey50'</span>)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">'grey40'</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>(<span class="at">background =</span> <span class="st">'grey10'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">text_colour =</span> <span class="st">'white'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="working-with-ggraphs-layouts" class="level2">
<h2 class="anchored" data-anchor-id="working-with-ggraphs-layouts">9.5.4 Working with ggraph’s layouts</h2>
<p><strong>ggraph</strong> support many layout for standard use, they are: star, circle, nicely(default), dh, gem, graphopt, grid, mds, spahere, randomly, fr, kk, drl and lgl. Figures below and on the right show layouts supported by <code>ggraph</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"https://r4va.netlify.app/chap27/img/image4.jpg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://r4va.netlify.app/chap27/img/image4.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>9.5.5 Fruchterman and Reingold Layout</p>
<p>The code chunks below will be used to plot the network graph using Fruchterman and Reingold layout.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>())</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>layout</em> argument is used to define the layout to be used</li>
</ul>
</div>
</div>
</section>
<section id="modifying-network-nodes" class="level2">
<h2 class="anchored" data-anchor-id="modifying-network-nodes">9.5.6 Modifying network nodes</h2>
<p>Each node will be colours based on their respective departments</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">3</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>9.5.7 Modifying Edges</p>
<p>In the code chunk below, the thickness of the edges will be mapped with the <em>Weight</em> variable</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunks above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><em>geom_edge_link</em> draws edges in the simplest way - as straight lines between the start and end nodes. But it can do more than that. In the example above, argument <em>width</em> is used to map the width of the line in proportion to the weight attribute and argument alpha is used to introduce opacity on the line</li>
</ul>
</div>
</div>
</section>
</section>
<section id="creating-facet-graphs" class="level1">
<h1>9.6 Creating Facet Graphs</h1>
<p>Another very useful feature of <strong>ggraph</strong> is faceting. In visualising network data, this technique can be used to reduce edge over-plotting in a very meaning way by spreading nodes and edges out based on their attributes. In this section, you will learn how to use faceting technique to visualise network data.</p>
<p>There are three functions in ggraph to implement faceting, they are:</p>
<ul>
<li><p><a href="https://ggraph.data-imaginist.com/reference/facet_nodes.html"><em>facet_nodes()</em></a> whereby edges are only draw in a panel if both terminal nodes are present here,</p></li>
<li><p><a href="https://ggraph.data-imaginist.com/reference/facet_edges.html"><em>facet_edges()</em></a> whereby nodes are always drawn in al panels even if the node data contains an attribute named the same as the one used for the edge facetting, and</p></li>
<li><p><a href="https://ggraph.data-imaginist.com/reference/facet_graph.html"><em>facet_graph()</em></a> faceting on two variables simultaneously.</p></li>
</ul>
<section id="working-with-facet_edges" class="level2">
<h2 class="anchored" data-anchor-id="working-with-facet_edges">9.6.1 Working with <em>facet_edges()</em></h2>
<p>In the code chunk below,&nbsp;<a href="https://ggraph.data-imaginist.com/reference/facet_edges.html"><em>facet_edges()</em></a>&nbsp;is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="working-with-facet_edges-1" class="level2">
<h2 class="anchored" data-anchor-id="working-with-facet_edges-1">9.6.2 Working with <em>facet_edges()</em></h2>
<p>The code chunk below uses&nbsp;<em>theme()</em>&nbsp;to change the position of the legend.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-framed-facet-graph" class="level2">
<h2 class="anchored" data-anchor-id="a-framed-facet-graph">9.6.3 A Framed facet graph</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>() </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">th_foreground</span>(<span class="at">foreground =</span> <span class="st">"grey80"</span>,  </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">border =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="working-with-facet_nodes" class="level2">
<h2 class="anchored" data-anchor-id="working-with-facet_nodes">9.6.4 Working with <em>facet_nodes()</em></h2>
<p>In the code chunk below,&nbsp;<a href="https://ggraph.data-imaginist.com/reference/facet_nodes.html"><em>facet_nodes()</em></a>&nbsp;is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_nodes</span>(<span class="sc">~</span>Department)<span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">th_foreground</span>(<span class="at">foreground =</span> <span class="st">"grey80"</span>,  </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">border =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="network-metrics-analysis" class="level1">
<h1>9.7 Network Metrics Analysis</h1>
<section id="computing-centrality-indices" class="level2">
<h2 class="anchored" data-anchor-id="computing-centrality-indices">9.7.1 Computing centrality indices</h2>
<p>Centrality measures are a collection of statistical indices use to describe the relative important of the actors are to a network. There are four well-known centrality measures, namely: degree, betweenness, closeness and eigenvector. It is beyond the scope of this hands-on exercise to cover the principles and mathematics of these measure here. Students are encouraged to refer to&nbsp;<em>Chapter 7: Actor Prominence</em>&nbsp;of&nbsp;<strong>A User’s Guide to Network Analysis in R</strong>&nbsp;to gain better understanding of theses network measures.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span>betweenness_centrality))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things to learn from the code chunk above:
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><em>mutate()</em> of <strong>dplyr</strong> is used to perform the computation</p></li>
<li><p>the algorithm used, on the other hand, is the <em>centrality_betweenness()</em> of <strong>tidygraph</strong>.</p></li>
</ul>
</div>
</div>
</section>
<section id="visualising-network-metrics" class="level2">
<h2 class="anchored" data-anchor-id="visualising-network-metrics">9.7.2 Visualising network metrics</h2>
<p>It is important to note that from&nbsp;<strong>ggraph v2.0</strong>&nbsp;onward tidygraph algorithms such as centrality measures can be accessed directly in ggraph calls. This means that it is no longer necessary to precompute and store derived node and edge centrality measures on the graph in order to use them in a plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fu">centrality_betweenness</span>()))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>9.7.3 Visualising Community</p>
<p>tidygraph package inherits many of the community detection algorithms imbedded into igraph and makes them available to us, including&nbsp;<em>Edge-betweenness (group_edge_betweenness)</em>,&nbsp;<em>Leading eigenvector (group_leading_eigen)</em>,&nbsp;<em>Fast-greedy (group_fast_greedy)</em>,&nbsp;<em>Louvain (group_louvain)</em>,&nbsp;<em>Walktrap (group_walktrap)</em>,&nbsp;<em>Label propagation (group_label_prop)</em>,&nbsp;<em>InfoMAP (group_infomap)</em>,&nbsp;<em>Spinglass (group_spinglass)</em>, and&nbsp;<em>Optimal (group_optimal)</em>. Some community algorithms are designed to take into account direction or weight, while others ignore it. Use this&nbsp;<a href="https://tidygraph.data-imaginist.com/reference/group_graph.html">link</a>&nbsp;to find out more about community detection functions provided by tidygraph,</p>
<p>In the code chunk below&nbsp;<em>group_edge_betweenness()</em>&nbsp;is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_edge_betweenness</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> Weight, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">directed =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">width=</span>Weight), </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> community))  </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In order to support effective visual investigation, the community network above has been revised by using&nbsp;<a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html"><code>geom_mark_hull()</code></a>&nbsp;of&nbsp;<a href="https://ggforce.data-imaginist.com/">ggforce</a>&nbsp;package.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please be reminded that you must to install and include <a href="https://ggforce.data-imaginist.com/"><strong>ggforce</strong></a> and <a href="https://www.rdocumentation.org/packages/concaveman/versions/1.1.0/topics/concaveman"><strong>concaveman</strong></a> packages before running the code chunk below.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(concaveman)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_optimal</span>(<span class="at">weights =</span> Weight)),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">betweenness_measure =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_hull</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y, </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> community, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> community),  </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,  </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),  <span class="co"># Expand</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)  <span class="co"># Smoothness</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Department,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> betweenness_measure),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> <span class="dv">21</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="building-interactive-network-graph-with-visnetwork" class="level1">
<h1>9.8 Building Interactive Network Graph with visNetwork</h1>
<ul>
<li><p><a href="http://datastorm-open.github.io/visNetwork/">visNetwork()</a> is a R package for network visualization, using <a href="http://visjs.org/">vis.js</a> javascript library.</p></li>
<li><p><em>visNetwork()</em> function uses a nodes list and edges list to create an interactive graph.</p>
<ul>
<li><p>The nodes list must include an “id” column, and the edge list must have “from” and “to” columns.</p></li>
<li><p>The function also plots the labels for the nodes, using the names of the actors from the “label” column in the node list.</p></li>
</ul></li>
<li><p>The resulting graph is fun to play around with.</p>
<ul>
<li><p>You can move the nodes and the graph will use an algorithm to keep the nodes properly spaced.</p></li>
<li><p>You can also zoom in and out on the plot and move it around to re-center it.</p></li>
</ul></li>
</ul>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">9.8.1 Data Preparation</h2>
<p>Before we can plot the interactive network graph, we need to prepare the data model by using the code chunk below:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>GAStech_edges_aggregated <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GAStech_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourceLabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GAStech_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetLabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MainSubject <span class="sc">==</span> <span class="st">"Work related"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting-the-first-interactive-network-graph" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-first-interactive-network-graph">9.8.2 Plotting the first interactive network graph</h2>
<p>The code chunk below will be used to plot an interactive network graph by using the data prepared.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-fb022a2dd16da27ba036" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fb022a2dd16da27ba036">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],"label":["Mat.Bramar","Anda.Ribera","Rachel.Pantanal","Linda.Lagos","Ruscella.Mies.Haber","Carla.Forluniau","Cornelia.Lais","Kanon.Herrero","Varja.Lagos","Stenig.Fusil","Marin.Onda","Axel.Calzas","Brand.Tempestad","Elsa.Orilla","Isande.Borrasca","Kare.Orilla","Felix.Balas","Lars.Azada","Lidelse.Dedos","Willem.Vasco-Pais","Bertrand.Ovan","Adra.Nubarron","Birgitta.Frente","Gustav.Cazar","Vira.Frente","Linnea.Bergen","Lucas.Alcazar","Isak.Baza","Nils.Calixto","Sven.Flecha","Emile.Arpa","Varro.Awelon","Dante.Coginian","Edvard.Vann","Hennie.Osvaldo","Isia.Vann","Minke.Mies","Sten.Sanjorge.Jr","Felix.Resumir","Hideki.Cocinaro","Inga.Ferro","Loreto.Bodrogi","Ingrid.Barranco","Ada.Campo-Corrente","Orhan.Strum","Adan.Morlun","Albina.Hafon","Benito.Hawelon","Cecilia.Morluniau","Claudio.Hawelon","Dylan.Scozzese","Henk.Mies","Irene.Nant","Valeria.Morlun"],"Department":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Facilities","Engineering","Engineering","Engineering","Engineering","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Facilities","Facilities","Facilities","Security","Security","Security","Security","Executive","Security","Security","Security","Security","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities"],"Title":["Assistant to CEO","Assistant to CFO","Assistant to CIO","Assistant to COO","Assistant to Engineering Group Manager","Assistant to IT Group Manager","Assistant to Security Group Manager","Badging Office","Badging Office","Building Control","Drill Site Manager","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Engineer","Engineer","Engineering Group Manager","Environmental Safety Advisor","Facilities Group Manager","Geologist","Geologist","Hydraulic Technician","Hydraulic Technician","IT Group Manager","IT Helpdesk","IT Technician","IT Technician","IT Technician","Janitor","Janitor","Lead Janitor","Perimeter Control","Perimeter Control","Perimeter Control","Perimeter Control","President/CEO","Security Group Manager","Site Control","Site Control","Site Control","SVP/CFO","SVP/CIO","SVP/COO","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver"]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],"weight":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="working-with-layout" class="level2">
<h2 class="anchored" data-anchor-id="working-with-layout">9.8.3 Working with layout</h2>
<p>In the code chunk below, Fruchterman and Reingold layout is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-ce3b77348a5efba237be" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ce3b77348a5efba237be">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],"label":["Mat.Bramar","Anda.Ribera","Rachel.Pantanal","Linda.Lagos","Ruscella.Mies.Haber","Carla.Forluniau","Cornelia.Lais","Kanon.Herrero","Varja.Lagos","Stenig.Fusil","Marin.Onda","Axel.Calzas","Brand.Tempestad","Elsa.Orilla","Isande.Borrasca","Kare.Orilla","Felix.Balas","Lars.Azada","Lidelse.Dedos","Willem.Vasco-Pais","Bertrand.Ovan","Adra.Nubarron","Birgitta.Frente","Gustav.Cazar","Vira.Frente","Linnea.Bergen","Lucas.Alcazar","Isak.Baza","Nils.Calixto","Sven.Flecha","Emile.Arpa","Varro.Awelon","Dante.Coginian","Edvard.Vann","Hennie.Osvaldo","Isia.Vann","Minke.Mies","Sten.Sanjorge.Jr","Felix.Resumir","Hideki.Cocinaro","Inga.Ferro","Loreto.Bodrogi","Ingrid.Barranco","Ada.Campo-Corrente","Orhan.Strum","Adan.Morlun","Albina.Hafon","Benito.Hawelon","Cecilia.Morluniau","Claudio.Hawelon","Dylan.Scozzese","Henk.Mies","Irene.Nant","Valeria.Morlun"],"Department":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Facilities","Engineering","Engineering","Engineering","Engineering","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Facilities","Facilities","Facilities","Security","Security","Security","Security","Executive","Security","Security","Security","Security","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities"],"Title":["Assistant to CEO","Assistant to CFO","Assistant to CIO","Assistant to COO","Assistant to Engineering Group Manager","Assistant to IT Group Manager","Assistant to Security Group Manager","Badging Office","Badging Office","Building Control","Drill Site Manager","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Engineer","Engineer","Engineering Group Manager","Environmental Safety Advisor","Facilities Group Manager","Geologist","Geologist","Hydraulic Technician","Hydraulic Technician","IT Group Manager","IT Helpdesk","IT Technician","IT Technician","IT Technician","Janitor","Janitor","Lead Janitor","Perimeter Control","Perimeter Control","Perimeter Control","Perimeter Control","President/CEO","Security Group Manager","Site Control","Site Control","Site Control","SVP/CFO","SVP/CIO","SVP/COO","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver"],"x":[0.08795808362709412,0.3861968460566874,0.2297020364336819,0.6972806417308692,0.01126287412649507,0.3509304669154119,0.5917465075259103,-0.4966147903122148,-0.3281131721596645,-0.6753505864546636,0.6726289239227905,0.5363935323745628,0.7826801486266945,0.5832985954378422,0.570383034056579,0.9317517076302788,1,0.8417444412669033,0.8331647405956315,-0.9118683241955187,-0.1088093978362026,0.1656780973748182,0.9766463934156846,0.8370351909685072,0.6788179009876634,0.5418604529466517,0.03797285206907874,0.2041172748449189,-0.03343951446110116,0.3883254198636337,-0.06558033718585632,-0.2196483845514933,-0.420169354022068,-0.1229131011382785,-0.04807502630061322,-0.5230735064628582,-0.01596800482559091,-1,-0.4522150436645953,-0.187023018055411,-0.5793724734764576,-0.2342997665910383,-0.1213427356593928,-0.8183610453469075,-0.9396980093417175,-0.4926872834674071,-0.6874750511775205,-0.2055470218350313,-0.5147250313179705,-0.2965735933974898,-0.5221324319159899,-0.5322097537411445,-0.682280594076377,-0.3252875219908623],"y":[0.138964609845013,0.6434965475814103,0.5018224792525767,0.6528074220851732,0.09329487523552116,0.8555955888509745,0.4554539538437172,-0.8323375400718726,-0.8069700044326875,-0.6631653804957264,0.09579457029185612,-0.5003240620208567,-0.3048544250851475,-0.06752468198549377,-0.3185525793148899,-0.3739432592571342,-0.2036908541577602,0.07869833542403026,-0.5355117141361547,-0.1311839367086179,0.9642390185365703,-0.01314484292453222,-0.01234968644251166,-0.1344430616498715,-0.5009288525030695,0.979634940130149,-0.03912823482531913,-0.9730713571625438,-1,-0.8974438965478235,0.6987499935808301,0.8671263751619176,0.3755279672570744,-0.06028719072574962,-0.08040113628364942,-0.5611409116317132,-0.7066008947629955,0.1083419646498278,-0.4391751543237626,-0.4508662104616266,-0.318101282373475,-0.7017393696266525,0.07180291411437389,0.08867223961194681,-0.319264483846081,0.971668675931002,0.6000562275970791,0.5868004587631237,0.658219712620282,1,0.8293981572907436,0.4818208587899828,0.7835042153327378,0.7554798787385244]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],"weight":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="working-with-visual-attributes---nodes" class="level2">
<h2 class="anchored" data-anchor-id="working-with-visual-attributes---nodes">9.8.4 Working with visual attributes - Nodes</h2>
<p>visNetwork() looks for a field called “group” in the nodes object and colour the nodes according to the values of the group field.</p>
<p>The code chunk below rename Department field to group</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>GAStech_nodes <span class="ot">&lt;-</span> GAStech_nodes <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> Department) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-c9d6b6a6945af1b7a843" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c9d6b6a6945af1b7a843">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],"label":["Mat.Bramar","Anda.Ribera","Rachel.Pantanal","Linda.Lagos","Ruscella.Mies.Haber","Carla.Forluniau","Cornelia.Lais","Kanon.Herrero","Varja.Lagos","Stenig.Fusil","Marin.Onda","Axel.Calzas","Brand.Tempestad","Elsa.Orilla","Isande.Borrasca","Kare.Orilla","Felix.Balas","Lars.Azada","Lidelse.Dedos","Willem.Vasco-Pais","Bertrand.Ovan","Adra.Nubarron","Birgitta.Frente","Gustav.Cazar","Vira.Frente","Linnea.Bergen","Lucas.Alcazar","Isak.Baza","Nils.Calixto","Sven.Flecha","Emile.Arpa","Varro.Awelon","Dante.Coginian","Edvard.Vann","Hennie.Osvaldo","Isia.Vann","Minke.Mies","Sten.Sanjorge.Jr","Felix.Resumir","Hideki.Cocinaro","Inga.Ferro","Loreto.Bodrogi","Ingrid.Barranco","Ada.Campo-Corrente","Orhan.Strum","Adan.Morlun","Albina.Hafon","Benito.Hawelon","Cecilia.Morluniau","Claudio.Hawelon","Dylan.Scozzese","Henk.Mies","Irene.Nant","Valeria.Morlun"],"group":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Facilities","Engineering","Engineering","Engineering","Engineering","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Facilities","Facilities","Facilities","Security","Security","Security","Security","Executive","Security","Security","Security","Security","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities"],"Title":["Assistant to CEO","Assistant to CFO","Assistant to CIO","Assistant to COO","Assistant to Engineering Group Manager","Assistant to IT Group Manager","Assistant to Security Group Manager","Badging Office","Badging Office","Building Control","Drill Site Manager","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Engineer","Engineer","Engineering Group Manager","Environmental Safety Advisor","Facilities Group Manager","Geologist","Geologist","Hydraulic Technician","Hydraulic Technician","IT Group Manager","IT Helpdesk","IT Technician","IT Technician","IT Technician","Janitor","Janitor","Lead Janitor","Perimeter Control","Perimeter Control","Perimeter Control","Perimeter Control","President/CEO","Security Group Manager","Site Control","Site Control","Site Control","SVP/CFO","SVP/CIO","SVP/COO","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver"],"x":[0.1265914753478425,0.792016423753696,0.5762971484586241,1,0.08749221852300737,0.9836363088229396,0.7656659440913833,-0.9469134940713066,-0.7239429202216013,-1,0.5197997909693881,0.1282185517369825,0.1377428894824757,0.3545394962638706,-0.03382801181660511,0.3165495808449093,0.4795227710927699,0.6329692621127518,0.5733514917452815,-0.8891405478424856,0.722035488236362,0.08594330689748242,0.1491537122039923,0.358155607863035,-0.05330166918435075,-0.3444205908632245,-0.006211713810359565,-0.5214331048433036,-0.66532017940452,-0.8621873041649413,0.4306500144015701,0.7519931250732279,0.08154104217004532,-0.1283428741096377,-0.1172769252583256,-0.8337027403032231,-0.6010848545546235,-0.519066347430899,-0.7671770671614593,-0.4924467972431906,-0.5862973862767764,-0.8017657967048355,-0.0411359084244034,-0.5070274417342067,-0.7579609795138997,0.5483431306938018,0.3808269037396075,0.6236076933272501,0.2498864963314567,0.1107112595505788,0.3445848141302001,0.1291149131695568,0.5016947111350654,0.5662999410077929],"y":[0.06559513308249043,0.06114742018318986,-0.01844976485345873,-0.1513200547135479,-0.007163466535605845,0.1236056459876891,-0.233397341937528,-0.252089492334267,-0.2349872371659703,0.08157894754298756,-0.5088503184364481,-0.6725962052348025,-0.8628048984044094,-0.5072203214929366,-0.6683021294834213,-0.9130615872644827,-0.9138360231791406,-0.6377644177949785,-0.7901105433067974,0.5129466270958507,0.7674699351994654,-0.1548309515433955,-1,-0.7311617036855496,-0.8408358283373415,1,-0.04768930140468408,-0.8521922726064729,-0.6768120885556792,-0.6146394760816923,0.4025574254542583,0.5830443061427464,0.5271054250459888,0.03116145488109812,-0.05205917417799844,-0.1063305695805951,-0.3987455290982116,0.8018664706618537,0.2384753226552039,-0.1052579575459736,0.2132022448347228,0.04019696654750682,0.1158818311204146,0.6005470376176998,0.6455868024756923,0.7580053672161271,0.8169857161010488,0.4171504067135714,0.9202528995336778,0.8498840936931524,0.6652737844410075,0.6662695527341311,0.9274227191339499,0.5835052145046413]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],"weight":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":["Administration","Security","Engineering","Executive","Facilities","Information Technology"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="working-with-visual-attributes---edges" class="level2">
<h2 class="anchored" data-anchor-id="working-with-visual-attributes---edges">9.8.5 Working with visual Attributes - Edges</h2>
<p>In the code run below <em>visEdges()</em> is used to symbolise the edges.<br>
- The argument <em>arrows</em> is used to define where to place the arrow.<br>
- The <em>smooth</em> argument is used to plot the edges using a smooth curve.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"curvedCW"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-3118157468fef762b4c5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3118157468fef762b4c5">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],"label":["Mat.Bramar","Anda.Ribera","Rachel.Pantanal","Linda.Lagos","Ruscella.Mies.Haber","Carla.Forluniau","Cornelia.Lais","Kanon.Herrero","Varja.Lagos","Stenig.Fusil","Marin.Onda","Axel.Calzas","Brand.Tempestad","Elsa.Orilla","Isande.Borrasca","Kare.Orilla","Felix.Balas","Lars.Azada","Lidelse.Dedos","Willem.Vasco-Pais","Bertrand.Ovan","Adra.Nubarron","Birgitta.Frente","Gustav.Cazar","Vira.Frente","Linnea.Bergen","Lucas.Alcazar","Isak.Baza","Nils.Calixto","Sven.Flecha","Emile.Arpa","Varro.Awelon","Dante.Coginian","Edvard.Vann","Hennie.Osvaldo","Isia.Vann","Minke.Mies","Sten.Sanjorge.Jr","Felix.Resumir","Hideki.Cocinaro","Inga.Ferro","Loreto.Bodrogi","Ingrid.Barranco","Ada.Campo-Corrente","Orhan.Strum","Adan.Morlun","Albina.Hafon","Benito.Hawelon","Cecilia.Morluniau","Claudio.Hawelon","Dylan.Scozzese","Henk.Mies","Irene.Nant","Valeria.Morlun"],"group":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Facilities","Engineering","Engineering","Engineering","Engineering","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Facilities","Facilities","Facilities","Security","Security","Security","Security","Executive","Security","Security","Security","Security","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities"],"Title":["Assistant to CEO","Assistant to CFO","Assistant to CIO","Assistant to COO","Assistant to Engineering Group Manager","Assistant to IT Group Manager","Assistant to Security Group Manager","Badging Office","Badging Office","Building Control","Drill Site Manager","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Engineer","Engineer","Engineering Group Manager","Environmental Safety Advisor","Facilities Group Manager","Geologist","Geologist","Hydraulic Technician","Hydraulic Technician","IT Group Manager","IT Helpdesk","IT Technician","IT Technician","IT Technician","Janitor","Janitor","Lead Janitor","Perimeter Control","Perimeter Control","Perimeter Control","Perimeter Control","President/CEO","Security Group Manager","Site Control","Site Control","Site Control","SVP/CFO","SVP/CIO","SVP/COO","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver"],"x":[0.08931180873165867,0.6140804273620168,0.7889590237921182,1,0.09809598748685566,0.9584017958136144,0.8537635707309408,0.1427922823517243,0.2916921534697632,0.1440160171335101,-0.5463141613129674,-0.7412023079236518,-1,-0.6252741626197649,-0.5824802898108772,-0.8708657447594981,-0.8077931582153768,-0.4932273982344807,-0.9499639932515042,-0.7738111395902654,0.7537735556504821,-0.1605732003048453,-0.7626556081697694,-0.9973180756446992,-0.8251555255627951,-0.3035645463607439,-0.08592807012624071,-0.5577740557998434,-0.1524622950500134,-0.3624183580370705,0.1371894215190634,0.7766650006034697,0.5346659493442834,0.003820184859608222,0.09640466919178214,0.6226747526105951,-0.1189105467851964,-0.5315723275320055,0.5498959860845931,0.3249699946572877,0.08123016118644588,0.4522095970464381,-0.06218471157185956,-0.496482352596316,-0.6962909313633028,0.4608023325754409,0.6971381677678248,0.1206862669761475,0.2966305501900759,0.2854133587520926,0.4762998611865206,0.3010859504755381,0.6087407050893383,0.5424410213581399],"y":[-0.09265869739824328,-0.0511803162129304,0.1610773895019975,0.1470422935011906,0.00162395665686943,-0.09560498163362485,0.3645261834802622,0.7901024843095801,0.7542346326457707,0.9284393684895025,-0.5113872999601778,-0.06971515598068034,-0.1060996417596858,-0.629803232523052,-0.1148066104872711,-0.2164304742707188,-0.5635597666344774,-0.3305017160256873,-0.4725720310153039,0.4961177156655252,-0.7674032567929769,-0.1077251847779067,-0.3911083387140775,-0.3101891214312349,0.05649447229038551,-1,0.04420484610395836,0.8769885327496503,1,0.941168815088987,-0.6592099589188289,-0.5992181667390253,-0.3501870899929438,0.1037307143614452,0.1015684198657856,0.7057326559327022,0.661677482599909,0.334569354843961,0.5103688358619523,0.4358700580349055,0.5313253578396071,0.788860617430613,-0.05584324741789304,0.597353594127467,0.6935698362341307,-0.7486503931308222,-0.4874757624344458,-0.8446202095724225,-0.7368708720146802,-0.9490543582980655,-0.9362866684603695,-0.408202241403315,-0.8253958841204505,-0.5952690374720038]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],"weight":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":true,"type":"curvedCW"}},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":["Administration","Security","Engineering","Executive","Facilities","Information Technology"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Visit&nbsp;<a href="http://datastorm-open.github.io/visNetwork/edges.html">Option</a>&nbsp;to find out more about visEdges’s argument.</p>
</section>
<section id="interactivity" class="level2">
<h2 class="anchored" data-anchor-id="interactivity">9.8.6 Interactivity</h2>
<p>In the code chunk below, <em>visOptions()</em> is used to incorporate interactivity features in the data visualisation.</p>
<ul>
<li><p>The argument <em>highlightNearest</em> highlights nearest when clicking a node.</p></li>
<li><p>The argument <em>nodesIdSelection</em> adds an id node selection creating an HTML select element.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-47b557e60c4e015f2c57" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-47b557e60c4e015f2c57">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,44,45,46,8,9,10,11,12,13,14,15,16,21,26,17,18,19,20,39,40,41,42,43,27,28,29,47,48,49,50,22,51,52,53,54,23,24,25,30,31,32,33,34,35,36,37,38],"label":["Mat.Bramar","Anda.Ribera","Rachel.Pantanal","Linda.Lagos","Ruscella.Mies.Haber","Carla.Forluniau","Cornelia.Lais","Kanon.Herrero","Varja.Lagos","Stenig.Fusil","Marin.Onda","Axel.Calzas","Brand.Tempestad","Elsa.Orilla","Isande.Borrasca","Kare.Orilla","Felix.Balas","Lars.Azada","Lidelse.Dedos","Willem.Vasco-Pais","Bertrand.Ovan","Adra.Nubarron","Birgitta.Frente","Gustav.Cazar","Vira.Frente","Linnea.Bergen","Lucas.Alcazar","Isak.Baza","Nils.Calixto","Sven.Flecha","Emile.Arpa","Varro.Awelon","Dante.Coginian","Edvard.Vann","Hennie.Osvaldo","Isia.Vann","Minke.Mies","Sten.Sanjorge.Jr","Felix.Resumir","Hideki.Cocinaro","Inga.Ferro","Loreto.Bodrogi","Ingrid.Barranco","Ada.Campo-Corrente","Orhan.Strum","Adan.Morlun","Albina.Hafon","Benito.Hawelon","Cecilia.Morluniau","Claudio.Hawelon","Dylan.Scozzese","Henk.Mies","Irene.Nant","Valeria.Morlun"],"group":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Security","Security","Security","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Facilities","Engineering","Engineering","Engineering","Engineering","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Facilities","Facilities","Facilities","Security","Security","Security","Security","Executive","Security","Security","Security","Security","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities"],"Title":["Assistant to CEO","Assistant to CFO","Assistant to CIO","Assistant to COO","Assistant to Engineering Group Manager","Assistant to IT Group Manager","Assistant to Security Group Manager","Badging Office","Badging Office","Building Control","Drill Site Manager","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Drill Technician","Engineer","Engineer","Engineering Group Manager","Environmental Safety Advisor","Facilities Group Manager","Geologist","Geologist","Hydraulic Technician","Hydraulic Technician","IT Group Manager","IT Helpdesk","IT Technician","IT Technician","IT Technician","Janitor","Janitor","Lead Janitor","Perimeter Control","Perimeter Control","Perimeter Control","Perimeter Control","President/CEO","Security Group Manager","Site Control","Site Control","Site Control","SVP/CFO","SVP/CIO","SVP/COO","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver","Truck Driver"],"x":[0.06593068236838451,0.3689739194658246,-0.3606636721267302,-0.2580194093491361,-0.03959808603588466,0.3407256934579268,-0.3265318927484981,-0.8650028414138629,-0.8298574640862287,-0.9964004994381219,0.6622232636946859,0.1167992576537367,0.6517759158984839,0.5316001206886676,0.1208691642903479,0.5275846550253094,0.5153593453663718,0.3437440810829178,0.3544721490265901,-0.5171525831817565,0.6774415213672091,0.07226930105769402,0.3434106109924113,0.17303974373994,-0.01810732605834731,1,-0.06174589177400935,-0.8064952541267819,-0.932179360136709,-0.6422315818745408,0.6337521550547192,0.7518422988502647,0.1066166258123327,-0.1439121270412463,-0.1719825243328313,-1,-0.7095761459737117,-0.226804163104222,-0.7110377495109806,-0.5853756232779075,-0.5524730295006451,-0.813107459466112,0.001657108434744536,-0.3620219308466838,-0.6809558756664762,0.4047677023867613,0.3557941298542475,0.5224833801363922,0.7553951732109412,0.5369073296648261,0.6711437326994156,0.2091277240221132,0.5107568691000901,0.2670121346632661],"y":[0.0004777647897975523,-0.08998576139325309,-0.3284091265294561,-0.7152558839843095,0.04479191213994849,-0.3107883083737786,-0.5414835664205955,0.11952648673926,-0.09831077255478526,0.3087509641788935,-0.5365985480713773,-0.8161086957932362,-0.7621885541181682,-0.4708812731824571,-0.6283759910762975,-0.9161646938456042,-0.7062156189164635,-0.6359886803620598,-0.8469266641126083,0.9408060892277994,0.8355955600385441,-0.1432705733251367,-0.9996609999979499,-1,-0.8459607588357128,0.01709409381999949,-0.06886684577010049,-0.6808401308761345,-0.4580067907182849,-0.8320261324609228,0.2862588883268389,0.4236032800699736,0.6003705346758683,0.1055762875762882,0.003679625636406669,-0.001436893808080764,-0.2503102211156495,1,0.4861634294369761,0.06218326673815899,0.4072591222993904,0.3095647055201602,0.1556204599589359,0.7995190781309562,0.7968173980873867,0.8387724448400142,0.5453818253211637,0.4161231308777844,0.667619565021025,0.7046396887559694,0.5701341652806655,0.7171425308026163,0.940448969499583,0.8952567699487861]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,3,4,5,6,7,15,36,38,1,2,4,5,6,7,48,1,2,3,5,6,7,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,1,2,3,4,5,7,28,1,2,3,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,27,8,10,11,12,13,14,15,16,17,18,19,20,45,8,9,11,12,13,14,15,16,17,18,19,20,8,9,10,12,13,14,15,16,17,18,19,20,32,8,9,10,11,13,14,15,16,17,18,19,20,52,8,9,10,11,12,14,15,16,17,18,19,20,8,9,10,11,12,13,15,16,17,18,19,20,2,8,9,10,11,12,13,14,16,17,18,19,20,8,9,10,11,12,13,14,15,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,8,9,10,11,12,13,14,15,17,19,20,8,9,10,11,12,13,14,15,16,17,18,20,8,9,10,11,12,13,14,15,16,17,18,19,50,22,23,24,25,53,21,23,24,25,36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,5,21,22,23,25,21,22,23,24,46,27,28,29,30,31,32,33,34,35,36,37,38,8,28,29,30,31,32,33,34,35,36,37,38,40,6,26,27,29,30,31,32,33,34,35,36,37,38,1,26,27,28,30,31,32,33,34,35,36,37,38,40,51,52,26,27,28,29,31,32,33,34,35,36,37,38,3,27,28,29,30,32,33,34,35,36,37,38,11,26,27,28,29,30,31,33,34,35,36,37,38,23,26,27,28,29,30,31,32,34,35,36,37,38,27,28,29,30,31,32,33,35,36,37,38,26,27,28,29,30,31,32,33,34,36,37,38,2,22,26,27,28,29,30,31,32,33,34,35,37,38,53,26,27,28,29,30,31,32,33,34,35,36,38,27,28,29,30,31,32,34,35,36,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,40,42,43,40,41,43,44,40,41,42,42,45,46,47,48,49,50,51,52,53,54,44,46,47,48,49,50,51,52,53,54,44,45,47,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,48,49,50,51,52,53,54,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,3,45,46,47,48,52,54,5,20,48,49,53,54,29,44,45,46,47,48,49,50,52,53,54,7,12,29,44,45,46,47,48,49,50,51,53,5,21,36,44,45,47,48,49,50,51,52,54,5,44,45,46,47,48,49,50,51,52,53],"weight":[21,21,21,21,21,21,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,6,6,6,6,6,9,2,2,2,8,8,8,8,8,8,2,12,12,12,12,12,12,20,20,20,20,20,20,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,11,11,11,11,11,11,3,12,15,12,12,12,12,3,4,3,3,4,4,3,3,4,3,4,3,3,4,4,9,4,7,7,11,5,4,5,6,8,3,8,8,7,9,9,6,9,10,10,7,5,7,11,10,11,6,11,7,11,9,10,7,10,8,3,9,10,8,8,11,6,7,5,3,6,5,6,2,9,5,10,7,7,4,3,4,7,2,3,3,6,5,7,4,6,6,7,5,7,6,3,4,3,6,13,8,8,5,6,6,11,9,6,2,7,6,8,7,5,5,7,6,7,7,5,4,6,2,2,2,2,2,2,2,6,4,7,7,6,6,6,6,5,5,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,4,5,3,3,2,5,2,3,2,4,8,5,9,6,5,4,10,7,4,4,5,5,10,5,7,4,5,4,4,4,3,2,4,3,4,2,4,7,2,7,5,10,4,2,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,6,10,17,9,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,5,9,7,3,8,2,3,4,2,26,25,25,25,25,25,24,25,25,26,25,26,3,4,3,6,4,3,3,6,5,3,4,5,3,3,2,3,6,5,8,6,6,7,4,6,6,6,2,2,6,5,7,5,6,5,7,6,6,5,5,3,2,3,3,5,7,9,12,9,9,6,13,12,9,11,2,5,4,6,6,9,7,6,12,7,7,8,4,2,8,6,9,7,10,7,9,6,10,5,8,2,4,2,3,5,7,8,4,7,5,7,6,4,5,6,4,7,8,5,9,6,6,10,6,3,11,7,9,11,15,7,11,11,9,13,13,2,2,3,12,11,12,16,15,19,12,11,14,11,13,3,3,4,5,6,7,7,6,9,10,7,5,3,2,5,5,2,2,2,4,4,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,3,2,2,2,2,2,2,2,2,2,2,40,22,30,2,2,2,2,2,2,2,2,2,2,2,28,19,24,25,19,28,2,15,16,24,3,4,2,5,6,2,5,5,2,6,3,6,4,2,6,5,5,4,7,5,6,6,3,4,9,5,6,8,7,4,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,5,4,3,7,5,6,6,5,5,5,2,2,4,2,4,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,5,3,8,6,5,5,5,6,2,3,2,3,3,4,2,2,4,2,2,5,2,3,3,3,3,4,4,2,3,3,3,3,2,2,4,2,4,4,3,4,5,3,2,4,3,3,4,3,3,2,5,4,8,2,2,5,2,3,4,3,2,5,4,4,2,3,4]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":["Administration","Security","Engineering","Executive","Facilities","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Visit&nbsp;<a href="http://datastorm-open.github.io/visNetwork/options.html">Option</a>&nbsp;to find out more about visOption’s argument.</p>
</section>
</section>
<section id="building-circular-plots---extra" class="level1">
<h1>9.9 Building Circular Plots - Extra</h1>
<p>Generate random data using seed. There needs to be a character vector to represent categories, a numeric vector of x and y values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sectors =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(n), <span class="at">y =</span> <span class="fu">runif</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the circular layout will be initialized. the circle is split into sectors based on the data range on x-axes in each category. In the following code, dfx is split by sectors and the width of the sectors are automatically calculated based on data ranges in each category. By default, sectors are positioned starting from teter = 0 (in the polar coordinate system) and go along the circle clockwise. No track has been added so there will be no display yet.</p>
<p>A global parameter <em><code>track.height = 0.1</code></em> is set by the option function <code>circis.par()</code> so that all tracks which will eb added have a default height of 0.1. The circle used by <strong>circlize</strong> always have a radius of 1, so a height of 0.1 means 10% of the circle radius.</p>
<p>The allocation of sectors only need values on x direction (or on the circular direction), the values on y direction (radical direction) will be used in the step of creating tracks.</p>
<p>After the circular layout is initialized, graphics can be added to the plot in a track-by-track manner. Before drawing anything, we need to know that all tracks should be first created by&nbsp;<code>circos.trackPlotRegion()</code>&nbsp;or, for short,&nbsp;<code>circos.track()</code>, then the low-level functions can be added afterwards. Just think in the base R graphic engine, you need first call&nbsp;<code>plot()</code>&nbsp;then you can use functions such as&nbsp;<code>points()</code>&nbsp;and&nbsp;<code>lines()</code>&nbsp;to add graphics. Since x-ranges for cells in the track have already been defined in the initialization step, here we only need to specify the y-range for each cell. The y-ranges can be specified by&nbsp;<code>y</code>&nbsp;argument as a numeric vector (so that y-range will be automatically extracted and calculated in each cell) or&nbsp;<code>ylim</code>&nbsp;argument as a vector of length two. In principle, y-ranges should be same for all cells in a same track</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="dv">5</span>), </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next, axes are added by using <code>circos.axis()</code> inside <code>panel.fun</code>. <code>circos.track()</code> creates plotting region in a cell by cell manner and the <code>panel.fun</code> is actually executed immediately after the plotting region for a certain cell is created and adds graphics in the current cell. Without specifying any arguments, <code>circos.axis()</code> draws x-axes on the top of each cell.</p>
<p><code>circos.text</code> CELL_META provides “meta information” for the current cell. When specifying the position of text on the y-direction, an offset of <code>mm_y(5)</code> 5mm is added to the y position of the text. In <code>circos.text</code>, x and y values are measured in the data coordinate and there are some helper functions that convert absolute units to corresponding values in data coordinate.</p>
<p><code>circos.trackPoints()</code> add points in all cells simultaneously anc can be replaced by putting <code>circos.text()</code> in <code>panel.fun()</code>.</p>
<p><code>circos.trackHist()</code> creates a new track. <code>bin.size</code> is set explicitly to that the bin size for all histograms are the same and can be compared to each other.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="dv">5</span>), </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the third track, <code>panel.fun</code>, 10 data points are randomly picked in each cell and sorted by x-values and connected with lines. In the following code, when <code>sectors</code> x and y arguments are set in <code>circos.track()</code>, x values and y values are split by sectos and corresponding subset of x and y values are sent to <code>panel.fun</code> through the x and y arguments.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the next plot, the second track is updated in the cell in sector “d”. This is done by <code>circos.updatePlotRegion()</code> or the short version <code>circos.update</code> . The function erases grgaphics which have been added but cannot modify the xlim and ylim of the cell.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>New tracks will be created and heatmaps added by using <code>circos.rect()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> CELL_META<span class="sc">$</span>xlim</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    ylim <span class="ot">=</span> CELL_META<span class="sc">$</span>ylim</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">=</span> <span class="fu">seq</span>(xlim[<span class="dv">1</span>], xlim[<span class="dv">2</span>], <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>    n_breaks <span class="ot">=</span> <span class="fu">length</span>(breaks)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(breaks[<span class="sc">-</span>n_breaks], <span class="fu">rep</span>(ylim[<span class="dv">1</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>                breaks[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">rep</span>(ylim[<span class="dv">2</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">rand_color</span>(n_breaks), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In the most inside circle, links or ribbons are added using <code>circos.link</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>circos.clear</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    resetGlobalVariable()
    if (circos.par("__omar__")) {
        circos.par(`__omar__` = FALSE)
        par(mar = c(5.1, 4.1, 4.1, 2.1))
    }
    tmpdir = circos.par("__tempdir__")
    circos.par(RESET = TRUE)
    circos.par(`__tempdir__` = tmpdir)
    empty_env(circos.par("__tempenv__"))
    return(invisible(NULL))
}
&lt;bytecode: 0x0000018828da0c80&gt;
&lt;environment: namespace:circlize&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> CELL_META<span class="sc">$</span>xlim</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    ylim <span class="ot">=</span> CELL_META<span class="sc">$</span>ylim</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">=</span> <span class="fu">seq</span>(xlim[<span class="dv">1</span>], xlim[<span class="dv">2</span>], <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    n_breaks <span class="ot">=</span> <span class="fu">length</span>(breaks)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(breaks[<span class="sc">-</span>n_breaks], <span class="fu">rep</span>(ylim[<span class="dv">1</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                breaks[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">rep</span>(ylim[<span class="dv">2</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">rand_color</span>(n_breaks), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"a"</span>, <span class="dv">0</span>, <span class="st">"b"</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.4</span>)</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"c"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">"d"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">"blue"</span>, <span class="at">h =</span> <span class="fl">0.2</span>)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"e"</span>, <span class="dv">0</span>, <span class="st">"g"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Hands-On_Ex05_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To reset the graphic parameters, we can use <code>circos.clear()</code>.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb55" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hands-On_Ex05 - Modelling, Visualising and Analysing Network Data with R"</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Liaw Ying Ting, Celin"</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 13 May 2025</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9 Modelling, Visualising and Analysing Network Data with R</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.1 Overview</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>In the hands-on exercise, I will be learning how to model, analyse and visualize network data with R.</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>By the end of this hands-on exercise, I will be able to:</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create graph objects data frames, manipulate them using appropriate appropriate functions of *dpylr, lubricate and tidygraph*</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Build network graph visualisation using appropriate functions of *ggraph*</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>compute network geometrics using *tidygraph*</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>build advanced graph visualisation by incorporating the network geometrics</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>build interactive network visualisation using *visNetwork* package</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.2 Getting Started</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>9.2.1 Installing and Launching R Packages</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(igraph, tidygraph, ggraph, </span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>               visNetwork, lubridate, clock,</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>               tidyverse, graphlayouts, </span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>               concaveman, ggforce)</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.3 The Data</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>The data sets used in this hands-on exercise is from an oil exploration and extraction company. There are two data sets. One contains the nodes data and the other contains the edges (also known as link) data.</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.1 The Edges Data</span></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*GAStech_email_edge-v2.csv* consists of the names, department and title of 55 employees</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-1196216663.png)</span></span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.2 The Nodes Data</span></span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>GAStech_email_nodes.csv consists of the names, department and title of the 55 employees</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-688382718.png)</span></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.3 Importing network data from files</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>In this step, GAStech_email_node.csv and GAStech_email_edges-v2.csv will be imported into Rstudio environment by using &lt;code style="color: blue;"&gt;read_csv&lt;/code&gt; of **readr** package.</span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>GAStech_nodes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"GAStech_email_node.csv"</span>)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a>GAStech_edges <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"GAStech_email_edge-v2.csv"</span>)</span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.4 Reviewing Imported Data</span></span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>Next, the structure of the data frame will be examined using *glimpse()* of **dplyr.**</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(GAStech_edges)</span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Warning</span></span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>The output report of GAStech_edges above revelas that the *SentDate* is treated as "Character" data type instead of *date* data type. This is an error! Before we continue, it is important for us to change the data type of *SentDate* field back to "Date" data type.</span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.5 Wrangling Time</span></span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a>GAStech_edges <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SendDate =</span> <span class="fu">dmy</span>(SentDate)) <span class="sc">%&gt;%</span></span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">wday</span>(SentDate,</span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">FALSE</span>))</span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunk above</span></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>both</span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>both <span class="in">`dmy()`</span> and <span class="in">`wday()`</span> are functions of **lubridate** package. <span class="co">[</span><span class="ot">lubridate</span><span class="co">](https://lubridate.tidyverse.org/)</span> is an R package that makes it easier to work with dates and times.</span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dmy()`</span> transforms the <span class="in">`SentDate`</span> to Date data type.</span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`wday()`</span> returns the day of the week as a decimal number or an ordered factor if label is TRUE. The argument abbr is FALSE keeps the daya spells in full, i.e. Monday. The function will create a new column in the data.frame i.e. Weekday and the output of <span class="in">`wday()`</span> will save in this newly created field</span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the values in the *weekday* field are in ordinal scale</span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.6 Reviewing the revised date fields</span></span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a>Table below shows the data structure of the reformatted *GAStech_edges* data frame</span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(GAStech_edges)</span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.7 Wrangling Attributes</span></span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a>A close examination of *GAStech_edges* data.frame reveals that it consists of individual e-mail flow records. This is not very useful for visualisation.</span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a>In view of this, we will aggregate the individual by date, senders, receivers, main subject and day of the week.</span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a>GAStech_edges_aggregated <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MainSubject <span class="sc">==</span> <span class="st">"Work related"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, Weekday) <span class="sc">%&gt;%</span></span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb55-143"><a href="#cb55-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-144"><a href="#cb55-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-146"><a href="#cb55-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-147"><a href="#cb55-147" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-148"><a href="#cb55-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### Things to learn from the code chunk above:</span></span>
<span id="cb55-149"><a href="#cb55-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-150"><a href="#cb55-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>four functions from **dplyr** package are used. They are: *filter(), group(), summarise()* and *ungroup()*</span>
<span id="cb55-151"><a href="#cb55-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The output data.frame is called **GAStech_edges_aggregated**</span>
<span id="cb55-152"><a href="#cb55-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A new field called *Weight* has been added in GAStech_edges_aggregated</span>
<span id="cb55-153"><a href="#cb55-153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-154"><a href="#cb55-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-155"><a href="#cb55-155" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.3.8 Reviewing the revised edges file</span></span>
<span id="cb55-156"><a href="#cb55-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-157"><a href="#cb55-157" aria-hidden="true" tabindex="-1"></a>Table below shows the data structure of the reformatted *GAStech_edges* data frame</span>
<span id="cb55-158"><a href="#cb55-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-161"><a href="#cb55-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-162"><a href="#cb55-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb55-163"><a href="#cb55-163" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(GAStech_edges)</span>
<span id="cb55-164"><a href="#cb55-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-165"><a href="#cb55-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-166"><a href="#cb55-166" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.4 Creating network objects using tidygraph</span></span>
<span id="cb55-167"><a href="#cb55-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-168"><a href="#cb55-168" aria-hidden="true" tabindex="-1"></a>In this section, you will learn how to create a graph data model by using **tidygraph** package. It provides a tidy API for graph/network manipulation. While network data itself is not tidy, it can be envisioned as two tidy tables, one for node data and one for edge data. **Tidygraph** provides a way to switch between the two tables and provides **dplyr** verbs for manipulating them. Furthermore, it provides access to a lot of graph algorithms with return values that facilitate their use in a tidy workflow.</span>
<span id="cb55-169"><a href="#cb55-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-170"><a href="#cb55-170" aria-hidden="true" tabindex="-1"></a>The two articles below provide more information:</span>
<span id="cb55-171"><a href="#cb55-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-172"><a href="#cb55-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Introducing tidygraph</span><span class="co">](https://www.data-imaginist.com/2017/introducing-tidygraph/)</span></span>
<span id="cb55-173"><a href="#cb55-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-174"><a href="#cb55-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Tidygraph 1.1 - A Tidy hope</span><span class="co">](https://www.data-imaginist.com/posts/2018-02-12-tidygraph-1-1-a-tidy-hope/index.html)</span></span>
<span id="cb55-175"><a href="#cb55-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-176"><a href="#cb55-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.1 The tbl_graph object</span></span>
<span id="cb55-177"><a href="#cb55-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-178"><a href="#cb55-178" aria-hidden="true" tabindex="-1"></a>Two functions of **tidygraph** package can be used to create network objects, they are:</span>
<span id="cb55-179"><a href="#cb55-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-180"><a href="#cb55-180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">tbl_graph()</span><span class="co">](https://tidygraph.data-imaginist.com/reference/tbl_graph.html)</span> creates a **tbl_graph** net work object from nodes and edges data</span>
<span id="cb55-181"><a href="#cb55-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-182"><a href="#cb55-182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">as_tbl_graph()</span><span class="co">](https://tidygraph.data-imaginist.com/reference/tbl_graph.html)</span> converts network data and objects to a **tbl_graph** network. Below are network data and objects supported by <span class="in">`as_tbl_graph()`</span></span>
<span id="cb55-183"><a href="#cb55-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-184"><a href="#cb55-184" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>a node data.frame and an edge data.frame</span>
<span id="cb55-185"><a href="#cb55-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-186"><a href="#cb55-186" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>data.frame, lst, matrix from base</span>
<span id="cb55-187"><a href="#cb55-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-188"><a href="#cb55-188" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>igraph from igraph</span>
<span id="cb55-189"><a href="#cb55-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-190"><a href="#cb55-190" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>network from network</span>
<span id="cb55-191"><a href="#cb55-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-192"><a href="#cb55-192" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>dendogram and hclust from stats</span>
<span id="cb55-193"><a href="#cb55-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-194"><a href="#cb55-194" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Node from data.tree</span>
<span id="cb55-195"><a href="#cb55-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-196"><a href="#cb55-196" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>phylo and evonet from ape</span>
<span id="cb55-197"><a href="#cb55-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-198"><a href="#cb55-198" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>graphNEL, graphAM, graphBAM from graph (in Bioconductor)</span>
<span id="cb55-199"><a href="#cb55-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-200"><a href="#cb55-200" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.2 The dplyr verbs in tidygraph</span></span>
<span id="cb55-201"><a href="#cb55-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-202"><a href="#cb55-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*activate()* verb from **tidygraph** serves as a switch between tibbles for nodes and edges. All dpylr verbs applied to **tbl_graph** object are applied to the active tibble</span>
<span id="cb55-203"><a href="#cb55-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-204"><a href="#cb55-204" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-2816690708.png)</span></span>
<span id="cb55-205"><a href="#cb55-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-206"><a href="#cb55-206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the above the *.N()* function is used to gain access to the node data while manipulating the edge data. Similarly, *.E()* will give the edge data and *.G()* will give you the **tbl_graph** object itself</span>
<span id="cb55-207"><a href="#cb55-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-208"><a href="#cb55-208" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.3 Using `tbl_graph()` to build tidy graph data model</span></span>
<span id="cb55-209"><a href="#cb55-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-210"><a href="#cb55-210" aria-hidden="true" tabindex="-1"></a>In this section, <span class="in">`tbl_graph()`</span> of **tinygraph** package will be used to build a tidygraph's network graph data.frame.</span>
<span id="cb55-211"><a href="#cb55-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-212"><a href="#cb55-212" aria-hidden="true" tabindex="-1"></a>A reference guide of <span class="co">[</span><span class="ot">tbl_graph</span><span class="co">](https://tidygraph.data-imaginist.com/reference/tbl_graph.html)</span> can be found here.</span>
<span id="cb55-213"><a href="#cb55-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-216"><a href="#cb55-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-217"><a href="#cb55-217" aria-hidden="true" tabindex="-1"></a>GAStech_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> GAStech_nodes,</span>
<span id="cb55-218"><a href="#cb55-218" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> GAStech_edges_aggregated, </span>
<span id="cb55-219"><a href="#cb55-219" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-220"><a href="#cb55-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-221"><a href="#cb55-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-222"><a href="#cb55-222" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.4 Reviewing the output tidygraph's graph object</span></span>
<span id="cb55-223"><a href="#cb55-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-226"><a href="#cb55-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-227"><a href="#cb55-227" aria-hidden="true" tabindex="-1"></a>GAStech_graph</span>
<span id="cb55-228"><a href="#cb55-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-229"><a href="#cb55-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-230"><a href="#cb55-230" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.5 Reviewing the output tidygraph's graph object</span></span>
<span id="cb55-231"><a href="#cb55-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-232"><a href="#cb55-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The output above reveals that&nbsp;*GAStech_graph*&nbsp;is a tbl_graph object with 54 nodes and 4541 edges</span>
<span id="cb55-233"><a href="#cb55-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-234"><a href="#cb55-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The command also prints the first six rows of “Node Data” and the first three of “Edge Data”.</span>
<span id="cb55-235"><a href="#cb55-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-236"><a href="#cb55-236" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It states that the Node Data is **active**. The notion of an active tibble within a tbl_graph object makes it possible to manipulate the data in one tibble at a time.</span>
<span id="cb55-237"><a href="#cb55-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-238"><a href="#cb55-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.4.6 Changing the active object</span></span>
<span id="cb55-239"><a href="#cb55-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-240"><a href="#cb55-240" aria-hidden="true" tabindex="-1"></a>The nodes tibble data frame is activated by default, but you can change which tibble data frame is active with the&nbsp;*activate()*&nbsp;function. Thus, if we wanted to rearrange the rows in the edges tibble to list those with the highest “weight” first, we could use&nbsp;*activate()*&nbsp;and then&nbsp;*arrange()*.</span>
<span id="cb55-241"><a href="#cb55-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-244"><a href="#cb55-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-245"><a href="#cb55-245" aria-hidden="true" tabindex="-1"></a>GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb55-246"><a href="#cb55-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb55-247"><a href="#cb55-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Weight))</span>
<span id="cb55-248"><a href="#cb55-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-249"><a href="#cb55-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-250"><a href="#cb55-250" aria-hidden="true" tabindex="-1"></a>More information can be found in the reference guide of <span class="co">[</span><span class="ot">activate()</span><span class="co">](https://tidygraph.data-imaginist.com/reference/activate.html)</span>.</span>
<span id="cb55-251"><a href="#cb55-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-252"><a href="#cb55-252" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.5 Plotting Static Network Graphs with ggraph package</span></span>
<span id="cb55-253"><a href="#cb55-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-254"><a href="#cb55-254" aria-hidden="true" tabindex="-1"></a>Ggraph is an extension of ggplot2, making it easier to carry over basic ggplot skills to the design of network graphs.</span>
<span id="cb55-255"><a href="#cb55-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-256"><a href="#cb55-256" aria-hidden="true" tabindex="-1"></a>As in all network graphs, there are three main aspects to a ggraph's network graph, they are:</span>
<span id="cb55-257"><a href="#cb55-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-258"><a href="#cb55-258" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">nodes</span><span class="co">](https://cran.r-project.org/web/packages/ggraph/vignettes/Nodes.html)</span></span>
<span id="cb55-259"><a href="#cb55-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-260"><a href="#cb55-260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">edges</span><span class="co">](https://cran.r-project.org/web/packages/ggraph/vignettes/Edges.html)</span></span>
<span id="cb55-261"><a href="#cb55-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-262"><a href="#cb55-262" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">layouts</span><span class="co">](https://cran.r-project.org/web/packages/ggraph/vignettes/Layouts.html)</span></span>
<span id="cb55-263"><a href="#cb55-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-264"><a href="#cb55-264" aria-hidden="true" tabindex="-1"></a>For a comprehensive discussion of each of this aspect of graph, please refer to their respective vignettes provided.</span>
<span id="cb55-265"><a href="#cb55-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-266"><a href="#cb55-266" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.5.1 Plotting a basic network graph</span></span>
<span id="cb55-267"><a href="#cb55-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-268"><a href="#cb55-268" aria-hidden="true" tabindex="-1"></a>The code chunk below uses <span class="co">[</span><span class="ot">ggraph()</span><span class="co">](https://ggraph.data-imaginist.com/reference/ggraph.html)</span>, <span class="co">[</span><span class="ot">geom-edge_link()</span><span class="co">](https://ggraph.data-imaginist.com/reference/geom_edge_link.html)</span>, and <span class="co">[</span><span class="ot">geom_node_point</span><span class="co">](https://ggraph.data-imaginist.com/reference/geom_node_point.html)</span> to plot a network graph by using *GAStech_graph.*</span>
<span id="cb55-269"><a href="#cb55-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-272"><a href="#cb55-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-273"><a href="#cb55-273" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span></span>
<span id="cb55-274"><a href="#cb55-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb55-275"><a href="#cb55-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>()</span>
<span id="cb55-276"><a href="#cb55-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-277"><a href="#cb55-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-278"><a href="#cb55-278" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-279"><a href="#cb55-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunk above:</span></span>
<span id="cb55-280"><a href="#cb55-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-281"><a href="#cb55-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The basic plotting function is <span class="in">`ggraph()`</span>, which takes the data to be used for the graph and the type of layout desired. Both of the arguments for <span class="in">`ggraph`</span> are built around *igraph*. Therefore, `ggraph()` can use either an *igraph* object or a tbl_graph object</span>
<span id="cb55-282"><a href="#cb55-282" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-283"><a href="#cb55-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-284"><a href="#cb55-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.5.2 Changing the default network graph theme</span></span>
<span id="cb55-285"><a href="#cb55-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-286"><a href="#cb55-286" aria-hidden="true" tabindex="-1"></a>In this section, you will use <span class="co">[</span><span class="ot">theme_graph()</span><span class="co">](https://ggraph.data-imaginist.com/reference/theme_graph.html)</span> to remove the x and y axes.</span>
<span id="cb55-287"><a href="#cb55-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-290"><a href="#cb55-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-291"><a href="#cb55-291" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span> </span>
<span id="cb55-292"><a href="#cb55-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb55-293"><a href="#cb55-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>())</span>
<span id="cb55-294"><a href="#cb55-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-295"><a href="#cb55-295" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-296"><a href="#cb55-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-297"><a href="#cb55-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-298"><a href="#cb55-298" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-299"><a href="#cb55-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunk above:</span></span>
<span id="cb55-300"><a href="#cb55-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-301"><a href="#cb55-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggraph** introduces a special ggplot theme that provides better defaults for network graphs than the normal ggplot defaults. <span class="in">`theme_graph()`</span>, besides removing axes, grids and broder, changes the font to Arial Narrow (this can be overridden)</span>
<span id="cb55-302"><a href="#cb55-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-303"><a href="#cb55-303" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The ggraph theme can be set for a series of plots with the <span class="in">`set_graph_style()`</span> command run before the graphs are plotted or by using <span class="in">`theme_graph()`</span> in the individual plots</span>
<span id="cb55-304"><a href="#cb55-304" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-305"><a href="#cb55-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-306"><a href="#cb55-306" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.5.3 Changing the coloring of the plot</span></span>
<span id="cb55-307"><a href="#cb55-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-308"><a href="#cb55-308" aria-hidden="true" tabindex="-1"></a>The code <span class="in">`theme_graph()`</span> makes it easy to change the coloring of the plot.</span>
<span id="cb55-309"><a href="#cb55-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-312"><a href="#cb55-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-313"><a href="#cb55-313" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph) <span class="sc">+</span> </span>
<span id="cb55-314"><a href="#cb55-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">'grey50'</span>)) <span class="sc">+</span></span>
<span id="cb55-315"><a href="#cb55-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">'grey40'</span>))</span>
<span id="cb55-316"><a href="#cb55-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-317"><a href="#cb55-317" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>(<span class="at">background =</span> <span class="st">'grey10'</span>,</span>
<span id="cb55-318"><a href="#cb55-318" aria-hidden="true" tabindex="-1"></a>                <span class="at">text_colour =</span> <span class="st">'white'</span>)</span>
<span id="cb55-319"><a href="#cb55-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-320"><a href="#cb55-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-321"><a href="#cb55-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.5.4 Working with ggraph's layouts</span></span>
<span id="cb55-322"><a href="#cb55-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-323"><a href="#cb55-323" aria-hidden="true" tabindex="-1"></a>**ggraph** support many layout for standard use, they are: star, circle, nicely(default), dh, gem, graphopt, grid, mds, spahere, randomly, fr, kk, drl and lgl. Figures below and on the right show layouts supported by <span class="in">`ggraph`</span>.</span>
<span id="cb55-324"><a href="#cb55-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-327"><a href="#cb55-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-328"><a href="#cb55-328" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb55-329"><a href="#cb55-329" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"https://r4va.netlify.app/chap27/img/image4.jpg"</span>)</span>
<span id="cb55-330"><a href="#cb55-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-331"><a href="#cb55-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-332"><a href="#cb55-332" aria-hidden="true" tabindex="-1"></a>9.5.5 Fruchterman and Reingold Layout</span>
<span id="cb55-333"><a href="#cb55-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-334"><a href="#cb55-334" aria-hidden="true" tabindex="-1"></a>The code chunks below will be used to plot the network graph using Fruchterman and Reingold layout.</span>
<span id="cb55-335"><a href="#cb55-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-338"><a href="#cb55-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-339"><a href="#cb55-339" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-340"><a href="#cb55-340" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb55-341"><a href="#cb55-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb55-342"><a href="#cb55-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>())</span>
<span id="cb55-343"><a href="#cb55-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-344"><a href="#cb55-344" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-345"><a href="#cb55-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-346"><a href="#cb55-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-347"><a href="#cb55-347" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-348"><a href="#cb55-348" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunk above:</span></span>
<span id="cb55-349"><a href="#cb55-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-350"><a href="#cb55-350" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*layout* argument is used to define the layout to be used</span>
<span id="cb55-351"><a href="#cb55-351" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-352"><a href="#cb55-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-353"><a href="#cb55-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.5.6 Modifying network nodes</span></span>
<span id="cb55-354"><a href="#cb55-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-355"><a href="#cb55-355" aria-hidden="true" tabindex="-1"></a>Each node will be colours based on their respective departments</span>
<span id="cb55-356"><a href="#cb55-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-359"><a href="#cb55-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-360"><a href="#cb55-360" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-361"><a href="#cb55-361" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb55-362"><a href="#cb55-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb55-363"><a href="#cb55-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department, </span>
<span id="cb55-364"><a href="#cb55-364" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">3</span>))</span>
<span id="cb55-365"><a href="#cb55-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-366"><a href="#cb55-366" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-367"><a href="#cb55-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-368"><a href="#cb55-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-369"><a href="#cb55-369" aria-hidden="true" tabindex="-1"></a>9.5.7 Modifying Edges</span>
<span id="cb55-370"><a href="#cb55-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-371"><a href="#cb55-371" aria-hidden="true" tabindex="-1"></a>In the code chunk below, the thickness of the edges will be mapped with the *Weight* variable</span>
<span id="cb55-372"><a href="#cb55-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-375"><a href="#cb55-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-376"><a href="#cb55-376" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-377"><a href="#cb55-377" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span></span>
<span id="cb55-378"><a href="#cb55-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-379"><a href="#cb55-379" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-380"><a href="#cb55-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-381"><a href="#cb55-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb55-382"><a href="#cb55-382" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb55-383"><a href="#cb55-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-384"><a href="#cb55-384" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-385"><a href="#cb55-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-386"><a href="#cb55-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-387"><a href="#cb55-387" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-388"><a href="#cb55-388" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunks above:</span></span>
<span id="cb55-389"><a href="#cb55-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-390"><a href="#cb55-390" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*geom_edge_link* draws edges in the simplest way - as straight lines between the start and end nodes. But it can do more than that. In the example above, argument *width* is used to map the width of the line in proportion to the weight attribute and argument alpha is used to introduce opacity on the line</span>
<span id="cb55-391"><a href="#cb55-391" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-392"><a href="#cb55-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-393"><a href="#cb55-393" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.6 Creating Facet Graphs</span></span>
<span id="cb55-394"><a href="#cb55-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-395"><a href="#cb55-395" aria-hidden="true" tabindex="-1"></a>Another very useful feature of **ggraph** is faceting. In visualising network data, this technique can be used to reduce edge over-plotting in a very meaning way by spreading nodes and edges out based on their attributes. In this section, you will learn how to use faceting technique to visualise network data.</span>
<span id="cb55-396"><a href="#cb55-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-397"><a href="#cb55-397" aria-hidden="true" tabindex="-1"></a>There are three functions in ggraph to implement faceting, they are:</span>
<span id="cb55-398"><a href="#cb55-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-399"><a href="#cb55-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">*facet_nodes()*</span><span class="co">](https://ggraph.data-imaginist.com/reference/facet_nodes.html)</span> whereby edges are only draw in a panel if both terminal nodes are present here,</span>
<span id="cb55-400"><a href="#cb55-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-401"><a href="#cb55-401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">*facet_edges()*</span><span class="co">](https://ggraph.data-imaginist.com/reference/facet_edges.html)</span> whereby nodes are always drawn in al panels even if the node data contains an attribute named the same as the one used for the edge facetting, and</span>
<span id="cb55-402"><a href="#cb55-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-403"><a href="#cb55-403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">*facet_graph()*</span><span class="co">](https://ggraph.data-imaginist.com/reference/facet_graph.html)</span> faceting on two variables simultaneously.</span>
<span id="cb55-404"><a href="#cb55-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-405"><a href="#cb55-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.6.1 Working with *facet_edges()*</span></span>
<span id="cb55-406"><a href="#cb55-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-407"><a href="#cb55-407" aria-hidden="true" tabindex="-1"></a>In the code chunk below,&nbsp;<span class="co">[</span><span class="ot">*facet_edges()*</span><span class="co">](https://ggraph.data-imaginist.com/reference/facet_edges.html)</span>&nbsp;is used.</span>
<span id="cb55-408"><a href="#cb55-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-411"><a href="#cb55-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-412"><a href="#cb55-412" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb55-413"><a href="#cb55-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-414"><a href="#cb55-414" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-415"><a href="#cb55-415" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb55-416"><a href="#cb55-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-417"><a href="#cb55-417" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-418"><a href="#cb55-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-419"><a href="#cb55-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb55-420"><a href="#cb55-420" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb55-421"><a href="#cb55-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-422"><a href="#cb55-422" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday)</span>
<span id="cb55-423"><a href="#cb55-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-424"><a href="#cb55-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-425"><a href="#cb55-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.6.2 Working with *facet_edges()*</span></span>
<span id="cb55-426"><a href="#cb55-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-427"><a href="#cb55-427" aria-hidden="true" tabindex="-1"></a>The code chunk below uses&nbsp;*theme()*&nbsp;to change the position of the legend.</span>
<span id="cb55-428"><a href="#cb55-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-431"><a href="#cb55-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-432"><a href="#cb55-432" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb55-433"><a href="#cb55-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-434"><a href="#cb55-434" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-435"><a href="#cb55-435" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb55-436"><a href="#cb55-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-437"><a href="#cb55-437" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-438"><a href="#cb55-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-439"><a href="#cb55-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb55-440"><a href="#cb55-440" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb55-441"><a href="#cb55-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb55-442"><a href="#cb55-442" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-443"><a href="#cb55-443" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday)</span>
<span id="cb55-444"><a href="#cb55-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-445"><a href="#cb55-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-446"><a href="#cb55-446" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.6.3 A Framed facet graph</span></span>
<span id="cb55-447"><a href="#cb55-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-450"><a href="#cb55-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-451"><a href="#cb55-451" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>() </span>
<span id="cb55-452"><a href="#cb55-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-453"><a href="#cb55-453" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-454"><a href="#cb55-454" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb55-455"><a href="#cb55-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-456"><a href="#cb55-456" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-457"><a href="#cb55-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-458"><a href="#cb55-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb55-459"><a href="#cb55-459" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb55-460"><a href="#cb55-460" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-461"><a href="#cb55-461" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_edges</span>(<span class="sc">~</span>Weekday) <span class="sc">+</span></span>
<span id="cb55-462"><a href="#cb55-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">th_foreground</span>(<span class="at">foreground =</span> <span class="st">"grey80"</span>,  </span>
<span id="cb55-463"><a href="#cb55-463" aria-hidden="true" tabindex="-1"></a>                <span class="at">border =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-464"><a href="#cb55-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb55-465"><a href="#cb55-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-466"><a href="#cb55-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-467"><a href="#cb55-467" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.6.4 Working with *facet_nodes()*</span></span>
<span id="cb55-468"><a href="#cb55-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-469"><a href="#cb55-469" aria-hidden="true" tabindex="-1"></a>In the code chunk below,&nbsp;<span class="co">[</span><span class="ot">*facet_nodes()*</span><span class="co">](https://ggraph.data-imaginist.com/reference/facet_nodes.html)</span>&nbsp;is used.</span>
<span id="cb55-470"><a href="#cb55-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-473"><a href="#cb55-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-474"><a href="#cb55-474" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb55-475"><a href="#cb55-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-476"><a href="#cb55-476" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(GAStech_graph, </span>
<span id="cb55-477"><a href="#cb55-477" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span> </span>
<span id="cb55-478"><a href="#cb55-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-479"><a href="#cb55-479" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-480"><a href="#cb55-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-481"><a href="#cb55-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department), </span>
<span id="cb55-482"><a href="#cb55-482" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb55-483"><a href="#cb55-483" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-484"><a href="#cb55-484" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">facet_nodes</span>(<span class="sc">~</span>Department)<span class="sc">+</span></span>
<span id="cb55-485"><a href="#cb55-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">th_foreground</span>(<span class="at">foreground =</span> <span class="st">"grey80"</span>,  </span>
<span id="cb55-486"><a href="#cb55-486" aria-hidden="true" tabindex="-1"></a>                <span class="at">border =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-487"><a href="#cb55-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb55-488"><a href="#cb55-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-489"><a href="#cb55-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-490"><a href="#cb55-490" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.7 Network Metrics Analysis</span></span>
<span id="cb55-491"><a href="#cb55-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-492"><a href="#cb55-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.7.1 Computing centrality indices</span></span>
<span id="cb55-493"><a href="#cb55-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-494"><a href="#cb55-494" aria-hidden="true" tabindex="-1"></a>Centrality measures are a collection of statistical indices use to describe the relative important of the actors are to a network. There are four well-known centrality measures, namely: degree, betweenness, closeness and eigenvector. It is beyond the scope of this hands-on exercise to cover the principles and mathematics of these measure here. Students are encouraged to refer to&nbsp;*Chapter 7: Actor Prominence*&nbsp;of&nbsp;**A User’s Guide to Network Analysis in R**&nbsp;to gain better understanding of theses network measures.</span>
<span id="cb55-495"><a href="#cb55-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-498"><a href="#cb55-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-499"><a href="#cb55-499" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb55-500"><a href="#cb55-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-501"><a href="#cb55-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb55-502"><a href="#cb55-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-503"><a href="#cb55-503" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-504"><a href="#cb55-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-505"><a href="#cb55-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department,</span>
<span id="cb55-506"><a href="#cb55-506" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span>betweenness_centrality))</span>
<span id="cb55-507"><a href="#cb55-507" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-508"><a href="#cb55-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-509"><a href="#cb55-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-510"><a href="#cb55-510" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-511"><a href="#cb55-511" aria-hidden="true" tabindex="-1"></a><span class="fu">## Things to learn from the code chunk above:</span></span>
<span id="cb55-512"><a href="#cb55-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-513"><a href="#cb55-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*mutate()* of **dplyr** is used to perform the computation</span>
<span id="cb55-514"><a href="#cb55-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-515"><a href="#cb55-515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the algorithm used, on the other hand, is the *centrality_betweenness()* of **tidygraph**.</span>
<span id="cb55-516"><a href="#cb55-516" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-517"><a href="#cb55-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-518"><a href="#cb55-518" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.7.2 Visualising network metrics</span></span>
<span id="cb55-519"><a href="#cb55-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-520"><a href="#cb55-520" aria-hidden="true" tabindex="-1"></a>It is important to note that from&nbsp;**ggraph v2.0**&nbsp;onward tidygraph algorithms such as centrality measures can be accessed directly in ggraph calls. This means that it is no longer necessary to precompute and store derived node and edge centrality measures on the graph in order to use them in a plot.</span>
<span id="cb55-521"><a href="#cb55-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-524"><a href="#cb55-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-525"><a href="#cb55-525" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb55-526"><a href="#cb55-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb55-527"><a href="#cb55-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-528"><a href="#cb55-528" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-529"><a href="#cb55-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-530"><a href="#cb55-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Department, </span>
<span id="cb55-531"><a href="#cb55-531" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fu">centrality_betweenness</span>()))</span>
<span id="cb55-532"><a href="#cb55-532" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-533"><a href="#cb55-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-534"><a href="#cb55-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-535"><a href="#cb55-535" aria-hidden="true" tabindex="-1"></a>9.7.3 Visualising Community</span>
<span id="cb55-536"><a href="#cb55-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-537"><a href="#cb55-537" aria-hidden="true" tabindex="-1"></a>tidygraph package inherits many of the community detection algorithms imbedded into igraph and makes them available to us, including&nbsp;*Edge-betweenness (group_edge_betweenness)*,&nbsp;*Leading eigenvector (group_leading_eigen)*,&nbsp;*Fast-greedy (group_fast_greedy)*,&nbsp;*Louvain (group_louvain)*,&nbsp;*Walktrap (group_walktrap)*,&nbsp;*Label propagation (group_label_prop)*,&nbsp;*InfoMAP (group_infomap)*,&nbsp;*Spinglass (group_spinglass)*, and&nbsp;*Optimal (group_optimal)*. Some community algorithms are designed to take into account direction or weight, while others ignore it. Use this&nbsp;<span class="co">[</span><span class="ot">link</span><span class="co">](https://tidygraph.data-imaginist.com/reference/group_graph.html)</span>&nbsp;to find out more about community detection functions provided by tidygraph,</span>
<span id="cb55-538"><a href="#cb55-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-539"><a href="#cb55-539" aria-hidden="true" tabindex="-1"></a>In the code chunk below&nbsp;*group_edge_betweenness()*&nbsp;is used.</span>
<span id="cb55-540"><a href="#cb55-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-543"><a href="#cb55-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-544"><a href="#cb55-544" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb55-545"><a href="#cb55-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(</span>
<span id="cb55-546"><a href="#cb55-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_edge_betweenness</span>(</span>
<span id="cb55-547"><a href="#cb55-547" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> Weight, </span>
<span id="cb55-548"><a href="#cb55-548" aria-hidden="true" tabindex="-1"></a>      <span class="at">directed =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb55-549"><a href="#cb55-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb55-550"><a href="#cb55-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb55-551"><a href="#cb55-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb55-552"><a href="#cb55-552" aria-hidden="true" tabindex="-1"></a>      <span class="at">width=</span>Weight), </span>
<span id="cb55-553"><a href="#cb55-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-554"><a href="#cb55-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(</span>
<span id="cb55-555"><a href="#cb55-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-556"><a href="#cb55-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(</span>
<span id="cb55-557"><a href="#cb55-557" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> community))  </span>
<span id="cb55-558"><a href="#cb55-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-559"><a href="#cb55-559" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-560"><a href="#cb55-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-561"><a href="#cb55-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-562"><a href="#cb55-562" aria-hidden="true" tabindex="-1"></a>In order to support effective visual investigation, the community network above has been revised by using&nbsp;<span class="co">[</span><span class="ot">`geom_mark_hull()`</span><span class="co">](https://ggforce.data-imaginist.com/reference/geom_mark_hull.html)</span>&nbsp;of&nbsp;<span class="co">[</span><span class="ot">ggforce</span><span class="co">](https://ggforce.data-imaginist.com/)</span>&nbsp;package.</span>
<span id="cb55-563"><a href="#cb55-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-564"><a href="#cb55-564" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb55-565"><a href="#cb55-565" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb55-566"><a href="#cb55-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-567"><a href="#cb55-567" aria-hidden="true" tabindex="-1"></a>Please be reminded that you must to install and include <span class="co">[</span><span class="ot">**ggforce**</span><span class="co">](https://ggforce.data-imaginist.com/)</span> and <span class="co">[</span><span class="ot">**concaveman**</span><span class="co">](https://www.rdocumentation.org/packages/concaveman/versions/1.1.0/topics/concaveman)</span> packages before running the code chunk below.</span>
<span id="cb55-568"><a href="#cb55-568" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb55-569"><a href="#cb55-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-572"><a href="#cb55-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-573"><a href="#cb55-573" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb55-574"><a href="#cb55-574" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(concaveman)</span>
<span id="cb55-575"><a href="#cb55-575" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb55-576"><a href="#cb55-576" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb55-577"><a href="#cb55-577" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-578"><a href="#cb55-578" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb55-579"><a href="#cb55-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-580"><a href="#cb55-580" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> GAStech_graph <span class="sc">%&gt;%</span></span>
<span id="cb55-581"><a href="#cb55-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb55-582"><a href="#cb55-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(</span>
<span id="cb55-583"><a href="#cb55-583" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_optimal</span>(<span class="at">weights =</span> Weight)),</span>
<span id="cb55-584"><a href="#cb55-584" aria-hidden="true" tabindex="-1"></a>         <span class="at">betweenness_measure =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-585"><a href="#cb55-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb55-586"><a href="#cb55-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_hull</span>(</span>
<span id="cb55-587"><a href="#cb55-587" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y, </span>
<span id="cb55-588"><a href="#cb55-588" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> community, </span>
<span id="cb55-589"><a href="#cb55-589" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> community),  </span>
<span id="cb55-590"><a href="#cb55-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,  </span>
<span id="cb55-591"><a href="#cb55-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>),  <span class="co"># Expand</span></span>
<span id="cb55-592"><a href="#cb55-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">"cm"</span>)  <span class="co"># Smoothness</span></span>
<span id="cb55-593"><a href="#cb55-593" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb55-594"><a href="#cb55-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>Weight), </span>
<span id="cb55-595"><a href="#cb55-595" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb55-596"><a href="#cb55-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-597"><a href="#cb55-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Department,</span>
<span id="cb55-598"><a href="#cb55-598" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> betweenness_measure),</span>
<span id="cb55-599"><a href="#cb55-599" aria-hidden="true" tabindex="-1"></a>                      <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb55-600"><a href="#cb55-600" aria-hidden="true" tabindex="-1"></a>                      <span class="at">shape =</span> <span class="dv">21</span>)</span>
<span id="cb55-601"><a href="#cb55-601" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-602"><a href="#cb55-602" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">theme_graph</span>()</span>
<span id="cb55-603"><a href="#cb55-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-604"><a href="#cb55-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-605"><a href="#cb55-605" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.8 Building Interactive Network Graph with visNetwork</span></span>
<span id="cb55-606"><a href="#cb55-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-607"><a href="#cb55-607" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">visNetwork()</span><span class="co">](http://datastorm-open.github.io/visNetwork/)</span> is a R package for network visualization, using <span class="co">[</span><span class="ot">vis.js</span><span class="co">](http://visjs.org/)</span> javascript library.</span>
<span id="cb55-608"><a href="#cb55-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-609"><a href="#cb55-609" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*visNetwork()* function uses a nodes list and edges list to create an interactive graph.</span>
<span id="cb55-610"><a href="#cb55-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-611"><a href="#cb55-611" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The nodes list must include an “id” column, and the edge list must have “from” and “to” columns.</span>
<span id="cb55-612"><a href="#cb55-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-613"><a href="#cb55-613" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The function also plots the labels for the nodes, using the names of the actors from the “label” column in the node list.</span>
<span id="cb55-614"><a href="#cb55-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-615"><a href="#cb55-615" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The resulting graph is fun to play around with.</span>
<span id="cb55-616"><a href="#cb55-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-617"><a href="#cb55-617" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>You can move the nodes and the graph will use an algorithm to keep the nodes properly spaced.</span>
<span id="cb55-618"><a href="#cb55-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-619"><a href="#cb55-619" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>You can also zoom in and out on the plot and move it around to re-center it.</span>
<span id="cb55-620"><a href="#cb55-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-621"><a href="#cb55-621" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.1 Data Preparation</span></span>
<span id="cb55-622"><a href="#cb55-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-623"><a href="#cb55-623" aria-hidden="true" tabindex="-1"></a>Before we can plot the interactive network graph, we need to prepare the data model by using the code chunk below:</span>
<span id="cb55-624"><a href="#cb55-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-627"><a href="#cb55-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-628"><a href="#cb55-628" aria-hidden="true" tabindex="-1"></a>GAStech_edges_aggregated <span class="ot">&lt;-</span> GAStech_edges <span class="sc">%&gt;%</span></span>
<span id="cb55-629"><a href="#cb55-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GAStech_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourceLabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-630"><a href="#cb55-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb55-631"><a href="#cb55-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GAStech_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetLabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-632"><a href="#cb55-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb55-633"><a href="#cb55-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MainSubject <span class="sc">==</span> <span class="st">"Work related"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-634"><a href="#cb55-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb55-635"><a href="#cb55-635" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-636"><a href="#cb55-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb55-637"><a href="#cb55-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-638"><a href="#cb55-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-639"><a href="#cb55-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-640"><a href="#cb55-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-641"><a href="#cb55-641" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.2 Plotting the first interactive network graph</span></span>
<span id="cb55-642"><a href="#cb55-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-643"><a href="#cb55-643" aria-hidden="true" tabindex="-1"></a>The code chunk below will be used to plot an interactive network graph by using the data prepared.</span>
<span id="cb55-644"><a href="#cb55-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-647"><a href="#cb55-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-648"><a href="#cb55-648" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes, </span>
<span id="cb55-649"><a href="#cb55-649" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated)</span>
<span id="cb55-650"><a href="#cb55-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-651"><a href="#cb55-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-652"><a href="#cb55-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.3 Working with layout</span></span>
<span id="cb55-653"><a href="#cb55-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-654"><a href="#cb55-654" aria-hidden="true" tabindex="-1"></a>In the code chunk below, Fruchterman and Reingold layout is used.</span>
<span id="cb55-655"><a href="#cb55-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-658"><a href="#cb55-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-659"><a href="#cb55-659" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb55-660"><a href="#cb55-660" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb55-661"><a href="#cb55-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) </span>
<span id="cb55-662"><a href="#cb55-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-663"><a href="#cb55-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-664"><a href="#cb55-664" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.4 Working with visual attributes - Nodes</span></span>
<span id="cb55-665"><a href="#cb55-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-666"><a href="#cb55-666" aria-hidden="true" tabindex="-1"></a>visNetwork() looks for a field called “group” in the nodes object and colour the nodes according to the values of the group field.</span>
<span id="cb55-667"><a href="#cb55-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-668"><a href="#cb55-668" aria-hidden="true" tabindex="-1"></a>The code chunk below rename Department field to group</span>
<span id="cb55-669"><a href="#cb55-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-672"><a href="#cb55-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-673"><a href="#cb55-673" aria-hidden="true" tabindex="-1"></a>GAStech_nodes <span class="ot">&lt;-</span> GAStech_nodes <span class="sc">%&gt;%</span></span>
<span id="cb55-674"><a href="#cb55-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> Department) </span>
<span id="cb55-675"><a href="#cb55-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-676"><a href="#cb55-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-679"><a href="#cb55-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-680"><a href="#cb55-680" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb55-681"><a href="#cb55-681" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb55-682"><a href="#cb55-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-683"><a href="#cb55-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-684"><a href="#cb55-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span>
<span id="cb55-685"><a href="#cb55-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-686"><a href="#cb55-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-687"><a href="#cb55-687" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.5 Working with visual Attributes - Edges</span></span>
<span id="cb55-688"><a href="#cb55-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-689"><a href="#cb55-689" aria-hidden="true" tabindex="-1"></a>In the code run below *visEdges()* is used to symbolise the edges.\</span>
<span id="cb55-690"><a href="#cb55-690" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The argument *arrows* is used to define where to place the arrow.\</span>
<span id="cb55-691"><a href="#cb55-691" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The *smooth* argument is used to plot the edges using a smooth curve.</span>
<span id="cb55-692"><a href="#cb55-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-695"><a href="#cb55-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-696"><a href="#cb55-696" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb55-697"><a href="#cb55-697" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb55-698"><a href="#cb55-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-699"><a href="#cb55-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb55-700"><a href="#cb55-700" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, </span>
<span id="cb55-701"><a href="#cb55-701" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"curvedCW"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-702"><a href="#cb55-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-703"><a href="#cb55-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span>
<span id="cb55-704"><a href="#cb55-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-705"><a href="#cb55-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-706"><a href="#cb55-706" aria-hidden="true" tabindex="-1"></a>Visit&nbsp;<span class="co">[</span><span class="ot">Option</span><span class="co">](http://datastorm-open.github.io/visNetwork/edges.html)</span>&nbsp;to find out more about visEdges’s argument.</span>
<span id="cb55-707"><a href="#cb55-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-708"><a href="#cb55-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9.8.6 Interactivity</span></span>
<span id="cb55-709"><a href="#cb55-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-710"><a href="#cb55-710" aria-hidden="true" tabindex="-1"></a>In the code chunk below, *visOptions()* is used to incorporate interactivity features in the data visualisation.</span>
<span id="cb55-711"><a href="#cb55-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-712"><a href="#cb55-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The argument *highlightNearest* highlights nearest when clicking a node.</span>
<span id="cb55-713"><a href="#cb55-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-714"><a href="#cb55-714" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The argument *nodesIdSelection* adds an id node selection creating an HTML select element.</span>
<span id="cb55-715"><a href="#cb55-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-718"><a href="#cb55-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-719"><a href="#cb55-719" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(GAStech_nodes,</span>
<span id="cb55-720"><a href="#cb55-720" aria-hidden="true" tabindex="-1"></a>           GAStech_edges_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb55-721"><a href="#cb55-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-722"><a href="#cb55-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-723"><a href="#cb55-723" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-724"><a href="#cb55-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-725"><a href="#cb55-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span>
<span id="cb55-726"><a href="#cb55-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-727"><a href="#cb55-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-728"><a href="#cb55-728" aria-hidden="true" tabindex="-1"></a>Visit&nbsp;<span class="co">[</span><span class="ot">Option</span><span class="co">](http://datastorm-open.github.io/visNetwork/options.html)</span>&nbsp;to find out more about visOption’s argument.</span>
<span id="cb55-729"><a href="#cb55-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-730"><a href="#cb55-730" aria-hidden="true" tabindex="-1"></a><span class="fu"># 9.9 Building Circular Plots - Extra </span></span>
<span id="cb55-731"><a href="#cb55-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-732"><a href="#cb55-732" aria-hidden="true" tabindex="-1"></a>Generate random data using seed. There needs to be a character vector to represent categories, a numeric vector of x and y values.</span>
<span id="cb55-733"><a href="#cb55-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-736"><a href="#cb55-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-737"><a href="#cb55-737" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb55-738"><a href="#cb55-738" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb55-739"><a href="#cb55-739" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sectors =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-740"><a href="#cb55-740" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(n), <span class="at">y =</span> <span class="fu">runif</span>(n))</span>
<span id="cb55-741"><a href="#cb55-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-742"><a href="#cb55-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-743"><a href="#cb55-743" aria-hidden="true" tabindex="-1"></a>Next, the circular layout will be initialized. the circle is split into sectors based on the data range on x-axes in each category. In the following code, dfx is split by sectors and the width of the sectors are automatically calculated based on data ranges in each category. By default, sectors are positioned starting from teter = 0 (in the polar coordinate system) and go along the circle clockwise. No track has been added so there will be no display yet.</span>
<span id="cb55-744"><a href="#cb55-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-745"><a href="#cb55-745" aria-hidden="true" tabindex="-1"></a>A global parameter *`track.height = 0.1`* is set by the option function `circis.par()` so that all tracks which will eb added have a default height of 0.1. The circle used by **circlize** always have a radius of 1, so a height of 0.1 means 10% of the circle radius.</span>
<span id="cb55-746"><a href="#cb55-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-747"><a href="#cb55-747" aria-hidden="true" tabindex="-1"></a>The allocation of sectors only need values on x direction (or on the circular direction), the values on y direction (radical direction) will be used in the step of creating tracks.</span>
<span id="cb55-748"><a href="#cb55-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-749"><a href="#cb55-749" aria-hidden="true" tabindex="-1"></a>After the circular layout is initialized, graphics can be added to the plot in a track-by-track manner. Before drawing anything, we need to know that all tracks should be first created by&nbsp;<span class="in">`circos.trackPlotRegion()`</span>&nbsp;or, for short,&nbsp;<span class="in">`circos.track()`</span>, then the low-level functions can be added afterwards. Just think in the base R graphic engine, you need first call&nbsp;<span class="in">`plot()`</span>&nbsp;then you can use functions such as&nbsp;<span class="in">`points()`</span>&nbsp;and&nbsp;<span class="in">`lines()`</span>&nbsp;to add graphics. Since x-ranges for cells in the track have already been defined in the initialization step, here we only need to specify the y-range for each cell. The y-ranges can be specified by&nbsp;<span class="in">`y`</span>&nbsp;argument as a numeric vector (so that y-range will be automatically extracted and calculated in each cell) or&nbsp;<span class="in">`ylim`</span>&nbsp;argument as a vector of length two. In principle, y-ranges should be same for all cells in a same track</span>
<span id="cb55-750"><a href="#cb55-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-753"><a href="#cb55-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-754"><a href="#cb55-754" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-755"><a href="#cb55-755" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-756"><a href="#cb55-756" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-757"><a href="#cb55-757" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-758"><a href="#cb55-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-759"><a href="#cb55-759" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-760"><a href="#cb55-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-761"><a href="#cb55-761" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-762"><a href="#cb55-762" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="dv">5</span>), </span>
<span id="cb55-763"><a href="#cb55-763" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-764"><a href="#cb55-764" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-765"><a href="#cb55-765" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-766"><a href="#cb55-766" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-767"><a href="#cb55-767" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-768"><a href="#cb55-768" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-769"><a href="#cb55-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-770"><a href="#cb55-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-771"><a href="#cb55-771" aria-hidden="true" tabindex="-1"></a>Next, axes are added by using <span class="in">`circos.axis()`</span> inside <span class="in">`panel.fun`</span>. <span class="in">`circos.track()`</span> creates plotting region in a cell by cell manner and the <span class="in">`panel.fun`</span> is actually executed immediately after the plotting region for a certain cell is created and adds graphics in the current cell. Without specifying any arguments, <span class="in">`circos.axis()`</span> draws x-axes on the top of each cell.</span>
<span id="cb55-772"><a href="#cb55-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-773"><a href="#cb55-773" aria-hidden="true" tabindex="-1"></a><span class="in">`circos.text`</span> CELL_META provides "meta information" for the current cell. When specifying the position of text on the y-direction, an offset of <span class="in">`mm_y(5)`</span> 5mm is added to the y position of the text. In <span class="in">`circos.text`</span>, x and y values are measured in the data coordinate and there are some helper functions that convert absolute units to corresponding values in data coordinate.</span>
<span id="cb55-774"><a href="#cb55-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-775"><a href="#cb55-775" aria-hidden="true" tabindex="-1"></a><span class="in">`circos.trackPoints()`</span> add points in all cells simultaneously anc can be replaced by putting <span class="in">`circos.text()`</span> in <span class="in">`panel.fun()`</span>.</span>
<span id="cb55-776"><a href="#cb55-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-777"><a href="#cb55-777" aria-hidden="true" tabindex="-1"></a><span class="in">`circos.trackHist()`</span> creates a new track. <span class="in">`bin.size`</span> is set explicitly to that the bin size for all histograms are the same and can be compared to each other.</span>
<span id="cb55-778"><a href="#cb55-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-781"><a href="#cb55-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-782"><a href="#cb55-782" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-783"><a href="#cb55-783" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-784"><a href="#cb55-784" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-785"><a href="#cb55-785" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-786"><a href="#cb55-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-787"><a href="#cb55-787" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-788"><a href="#cb55-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-789"><a href="#cb55-789" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-790"><a href="#cb55-790" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="dv">5</span>), </span>
<span id="cb55-791"><a href="#cb55-791" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-792"><a href="#cb55-792" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-793"><a href="#cb55-793" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-794"><a href="#cb55-794" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-795"><a href="#cb55-795" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-796"><a href="#cb55-796" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-797"><a href="#cb55-797" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb55-798"><a href="#cb55-798" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb55-799"><a href="#cb55-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-800"><a href="#cb55-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-801"><a href="#cb55-801" aria-hidden="true" tabindex="-1"></a>In the third track, <span class="in">`panel.fun`</span>, 10 data points are randomly picked in each cell and sorted by x-values and connected with lines. In the following code, when <span class="in">`sectors`</span> x and y arguments are set in <span class="in">`circos.track()`</span>, x values and y values are split by sectos and corresponding subset of x and y values are sent to <span class="in">`panel.fun`</span> through the x and y arguments.</span>
<span id="cb55-802"><a href="#cb55-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-805"><a href="#cb55-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-806"><a href="#cb55-806" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-807"><a href="#cb55-807" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-808"><a href="#cb55-808" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-809"><a href="#cb55-809" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-810"><a href="#cb55-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-811"><a href="#cb55-811" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-812"><a href="#cb55-812" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-813"><a href="#cb55-813" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-814"><a href="#cb55-814" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb55-815"><a href="#cb55-815" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-816"><a href="#cb55-816" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-817"><a href="#cb55-817" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-818"><a href="#cb55-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-819"><a href="#cb55-819" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-820"><a href="#cb55-820" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-821"><a href="#cb55-821" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-822"><a href="#cb55-822" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb55-823"><a href="#cb55-823" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb55-824"><a href="#cb55-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-825"><a href="#cb55-825" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-826"><a href="#cb55-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-827"><a href="#cb55-827" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb55-828"><a href="#cb55-828" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb55-829"><a href="#cb55-829" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb55-830"><a href="#cb55-830" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb55-831"><a href="#cb55-831" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb55-832"><a href="#cb55-832" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-833"><a href="#cb55-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-834"><a href="#cb55-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-835"><a href="#cb55-835" aria-hidden="true" tabindex="-1"></a>In the next plot, the second track is updated in the cell in sector "d". This is done by <span class="in">`circos.updatePlotRegion()`</span> or the short version <span class="in">`circos.update`</span> . The function erases grgaphics which have been added but cannot modify the xlim and ylim of the cell.</span>
<span id="cb55-836"><a href="#cb55-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-839"><a href="#cb55-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-840"><a href="#cb55-840" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-841"><a href="#cb55-841" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-842"><a href="#cb55-842" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-843"><a href="#cb55-843" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-844"><a href="#cb55-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-845"><a href="#cb55-845" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-846"><a href="#cb55-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-847"><a href="#cb55-847" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-848"><a href="#cb55-848" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb55-849"><a href="#cb55-849" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-850"><a href="#cb55-850" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-851"><a href="#cb55-851" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-852"><a href="#cb55-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-853"><a href="#cb55-853" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-854"><a href="#cb55-854" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-855"><a href="#cb55-855" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-856"><a href="#cb55-856" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb55-857"><a href="#cb55-857" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb55-858"><a href="#cb55-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-859"><a href="#cb55-859" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-860"><a href="#cb55-860" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-861"><a href="#cb55-861" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb55-862"><a href="#cb55-862" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb55-863"><a href="#cb55-863" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb55-864"><a href="#cb55-864" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb55-865"><a href="#cb55-865" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb55-866"><a href="#cb55-866" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-867"><a href="#cb55-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-868"><a href="#cb55-868" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb55-869"><a href="#cb55-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb55-870"><a href="#cb55-870" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-871"><a href="#cb55-871" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-872"><a href="#cb55-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-873"><a href="#cb55-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-874"><a href="#cb55-874" aria-hidden="true" tabindex="-1"></a>New tracks will be created and heatmaps added by using <span class="in">`circos.rect()`</span>.</span>
<span id="cb55-875"><a href="#cb55-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-878"><a href="#cb55-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-879"><a href="#cb55-879" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-880"><a href="#cb55-880" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-881"><a href="#cb55-881" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-882"><a href="#cb55-882" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-883"><a href="#cb55-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-884"><a href="#cb55-884" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-885"><a href="#cb55-885" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-886"><a href="#cb55-886" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-887"><a href="#cb55-887" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb55-888"><a href="#cb55-888" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-889"><a href="#cb55-889" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-890"><a href="#cb55-890" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-891"><a href="#cb55-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-892"><a href="#cb55-892" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-893"><a href="#cb55-893" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-894"><a href="#cb55-894" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-895"><a href="#cb55-895" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb55-896"><a href="#cb55-896" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb55-897"><a href="#cb55-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-898"><a href="#cb55-898" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-899"><a href="#cb55-899" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-900"><a href="#cb55-900" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb55-901"><a href="#cb55-901" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb55-902"><a href="#cb55-902" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb55-903"><a href="#cb55-903" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb55-904"><a href="#cb55-904" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb55-905"><a href="#cb55-905" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-906"><a href="#cb55-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-907"><a href="#cb55-907" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb55-908"><a href="#cb55-908" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb55-909"><a href="#cb55-909" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-910"><a href="#cb55-910" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-911"><a href="#cb55-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-912"><a href="#cb55-912" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-913"><a href="#cb55-913" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> CELL_META<span class="sc">$</span>xlim</span>
<span id="cb55-914"><a href="#cb55-914" aria-hidden="true" tabindex="-1"></a>    ylim <span class="ot">=</span> CELL_META<span class="sc">$</span>ylim</span>
<span id="cb55-915"><a href="#cb55-915" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">=</span> <span class="fu">seq</span>(xlim[<span class="dv">1</span>], xlim[<span class="dv">2</span>], <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb55-916"><a href="#cb55-916" aria-hidden="true" tabindex="-1"></a>    n_breaks <span class="ot">=</span> <span class="fu">length</span>(breaks)</span>
<span id="cb55-917"><a href="#cb55-917" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(breaks[<span class="sc">-</span>n_breaks], <span class="fu">rep</span>(ylim[<span class="dv">1</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb55-918"><a href="#cb55-918" aria-hidden="true" tabindex="-1"></a>                breaks[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">rep</span>(ylim[<span class="dv">2</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb55-919"><a href="#cb55-919" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">rand_color</span>(n_breaks), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb55-920"><a href="#cb55-920" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-921"><a href="#cb55-921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-922"><a href="#cb55-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-923"><a href="#cb55-923" aria-hidden="true" tabindex="-1"></a>In the most inside circle, links or ribbons are added using <span class="in">`circos.link`</span>.</span>
<span id="cb55-924"><a href="#cb55-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-927"><a href="#cb55-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-928"><a href="#cb55-928" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb55-929"><a href="#cb55-929" aria-hidden="true" tabindex="-1"></a>circos.clear</span>
<span id="cb55-930"><a href="#cb55-930" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="st">"track.height"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb55-931"><a href="#cb55-931" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initialize</span>(<span class="at">factors =</span> df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x)</span>
<span id="cb55-932"><a href="#cb55-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-933"><a href="#cb55-933" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-934"><a href="#cb55-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-935"><a href="#cb55-935" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, </span>
<span id="cb55-936"><a href="#cb55-936" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>cell.ylim[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mm_y</span>(<span class="fl">5.5</span>), </span>
<span id="cb55-937"><a href="#cb55-937" aria-hidden="true" tabindex="-1"></a>            CELL_META<span class="sc">$</span>sector.index)</span>
<span id="cb55-938"><a href="#cb55-938" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.axis</span>(<span class="at">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb55-939"><a href="#cb55-939" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-940"><a href="#cb55-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-941"><a href="#cb55-941" aria-hidden="true" tabindex="-1"></a>col <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#FF0000"</span>, <span class="st">"#00FF00"</span>), <span class="dv">4</span>)</span>
<span id="cb55-942"><a href="#cb55-942" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackPoints</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">col =</span> col, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb55-943"><a href="#cb55-943" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="st">"text"</span>, <span class="at">sector.index =</span> <span class="st">"a"</span>, <span class="at">track.index =</span> <span class="dv">1</span>)</span>
<span id="cb55-944"><a href="#cb55-944" aria-hidden="true" tabindex="-1"></a>bgcol <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#EFEFEF"</span>, <span class="st">"#CCCCCC"</span>), <span class="dv">4</span>)</span>
<span id="cb55-945"><a href="#cb55-945" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.trackHist</span>(df<span class="sc">$</span>sectors, df<span class="sc">$</span>x, <span class="at">bin.size =</span> <span class="fl">0.2</span>, <span class="at">bg.col =</span> bgcol, <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb55-946"><a href="#cb55-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-947"><a href="#cb55-947" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(df<span class="sc">$</span>sectors, <span class="at">x =</span> df<span class="sc">$</span>x, <span class="at">y =</span> df<span class="sc">$</span>y,</span>
<span id="cb55-948"><a href="#cb55-948" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-949"><a href="#cb55-949" aria-hidden="true" tabindex="-1"></a>        ind <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">length</span>(x), <span class="dv">10</span>)</span>
<span id="cb55-950"><a href="#cb55-950" aria-hidden="true" tabindex="-1"></a>        x2 <span class="ot">=</span> x[ind]</span>
<span id="cb55-951"><a href="#cb55-951" aria-hidden="true" tabindex="-1"></a>        y2 <span class="ot">=</span> y[ind]</span>
<span id="cb55-952"><a href="#cb55-952" aria-hidden="true" tabindex="-1"></a>        od <span class="ot">=</span> <span class="fu">order</span>(x2)</span>
<span id="cb55-953"><a href="#cb55-953" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.lines</span>(x2[od], y2[od])</span>
<span id="cb55-954"><a href="#cb55-954" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-955"><a href="#cb55-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-956"><a href="#cb55-956" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.update</span>(<span class="at">sector.index =</span> <span class="st">"d"</span>, <span class="at">track.index =</span> <span class="dv">2</span>, </span>
<span id="cb55-957"><a href="#cb55-957" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.col =</span> <span class="st">"#FF8080"</span>, <span class="at">bg.border =</span> <span class="st">"black"</span>)</span>
<span id="cb55-958"><a href="#cb55-958" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.points</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-959"><a href="#cb55-959" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.text</span>(CELL_META<span class="sc">$</span>xcenter, CELL_META<span class="sc">$</span>ycenter, <span class="st">"updated"</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb55-960"><a href="#cb55-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-961"><a href="#cb55-961" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.track</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-962"><a href="#cb55-962" aria-hidden="true" tabindex="-1"></a>    xlim <span class="ot">=</span> CELL_META<span class="sc">$</span>xlim</span>
<span id="cb55-963"><a href="#cb55-963" aria-hidden="true" tabindex="-1"></a>    ylim <span class="ot">=</span> CELL_META<span class="sc">$</span>ylim</span>
<span id="cb55-964"><a href="#cb55-964" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">=</span> <span class="fu">seq</span>(xlim[<span class="dv">1</span>], xlim[<span class="dv">2</span>], <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb55-965"><a href="#cb55-965" aria-hidden="true" tabindex="-1"></a>    n_breaks <span class="ot">=</span> <span class="fu">length</span>(breaks)</span>
<span id="cb55-966"><a href="#cb55-966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circos.rect</span>(breaks[<span class="sc">-</span>n_breaks], <span class="fu">rep</span>(ylim[<span class="dv">1</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb55-967"><a href="#cb55-967" aria-hidden="true" tabindex="-1"></a>                breaks[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">rep</span>(ylim[<span class="dv">2</span>], n_breaks <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb55-968"><a href="#cb55-968" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">rand_color</span>(n_breaks), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb55-969"><a href="#cb55-969" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-970"><a href="#cb55-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-971"><a href="#cb55-971" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"a"</span>, <span class="dv">0</span>, <span class="st">"b"</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.4</span>)</span>
<span id="cb55-972"><a href="#cb55-972" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"c"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">"d"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb55-973"><a href="#cb55-973" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">"blue"</span>, <span class="at">h =</span> <span class="fl">0.2</span>)</span>
<span id="cb55-974"><a href="#cb55-974" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.link</span>(<span class="st">"e"</span>, <span class="dv">0</span>, <span class="st">"g"</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb55-975"><a href="#cb55-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb55-976"><a href="#cb55-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-977"><a href="#cb55-977" aria-hidden="true" tabindex="-1"></a>To reset the graphic parameters, we can use <span class="in">`circos.clear()`</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>