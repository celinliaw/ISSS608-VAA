<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liaw Ying Ting, Celin">
<meta name="dcterms.date" content="2025-05-27">

<title>Take-Home_Ex02 – Celin’s ISSS608 Site</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Assets/orange_cat_favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2f6844b3748638c5738d4cf93630e566.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Celin’s ISSS608 Site</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part1.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part3.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part4.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex01/In-Class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex02/In-Class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex03/In-Class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex04/In-Class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex05/In-Class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex06/In-Class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex07/In-Class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex08/In-Class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex09/In-Class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex10/In-Class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01_Part2.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview---mini-challenge-3" id="toc-overview---mini-challenge-3" class="nav-link active" data-scroll-target="#overview---mini-challenge-3">Overview - Mini Challenge 3</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#task-and-question" id="toc-task-and-question" class="nav-link" data-scroll-target="#task-and-question">Task and Question</a></li>
  <li><a href="#mc3-kickstarter" id="toc-mc3-kickstarter" class="nav-link" data-scroll-target="#mc3-kickstarter">MC3 Kickstarter</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#import-knowledge-graph-data" id="toc-import-knowledge-graph-data" class="nav-link" data-scroll-target="#import-knowledge-graph-data">Import knowledge Graph Data</a></li>
  <li><a href="#inspecting-knowledge-graph-structure" id="toc-inspecting-knowledge-graph-structure" class="nav-link" data-scroll-target="#inspecting-knowledge-graph-structure">Inspecting Knowledge graph structure</a></li>
  <li><a href="#extracting-the-edges-and-nodes-tables" id="toc-extracting-the-edges-and-nodes-tables" class="nav-link" data-scroll-target="#extracting-the-edges-and-nodes-tables">Extracting the edges and nodes tables</a></li>
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">Initial EDA</a></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">Data Cleaning and Wrangling</a></li>
  <li><a href="#cleaning-and-wrangling-edges" id="toc-cleaning-and-wrangling-edges" class="nav-link" data-scroll-target="#cleaning-and-wrangling-edges">Cleaning and wrangling edges</a></li>
  </ul></li>
  <li><a href="#building-the-tidygraph-object" id="toc-building-the-tidygraph-object" class="nav-link" data-scroll-target="#building-the-tidygraph-object">Building the tidygraph object</a></li>
  <li><a href="#visualising-the-knowledge-graph" id="toc-visualising-the-knowledge-graph" class="nav-link" data-scroll-target="#visualising-the-knowledge-graph">Visualising the knowledge graph</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a>
  <ul class="collapse">
  <li><a href="#q2-part-a" id="toc-q2-part-a" class="nav-link" data-scroll-target="#q2-part-a">Q2 Part A</a></li>
  <li><a href="#q2-part-b" id="toc-q2-part-b" class="nav-link" data-scroll-target="#q2-part-b">Q2 Part B</a></li>
  </ul></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a>
  <ul class="collapse">
  <li><a href="#q3-part-a" id="toc-q3-part-a" class="nav-link" data-scroll-target="#q3-part-a">Q3 Part A</a></li>
  <li><a href="#q3-part-b" id="toc-q3-part-b" class="nav-link" data-scroll-target="#q3-part-b">Q3 Part B</a></li>
  <li><a href="#q3-part-c" id="toc-q3-part-c" class="nav-link" data-scroll-target="#q3-part-c">Q3 Part C</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-Home_Ex02</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liaw Ying Ting, Celin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 27, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 1, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview---mini-challenge-3" class="level1">
<h1>Overview - Mini Challenge 3</h1>
<p>For this take-home exercise 2, Mini-Challenge 3 will be chosen and the visualisation will be done on this topic. The background of the mini challenge and the questions will be listed below. For this mini challenge, I will only be displaying and addressing <strong>Questions 2 and 3</strong> below.</p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</p>
<p>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</p>
</section>
<section id="task-and-question" class="level1">
<h1>Task and Question</h1>
<p>Clepper diligently recorded all intercepted radio communications over the last two weeks. With the help of his intern, they have analyzed their content to identify important events and relationships between key players. The result is a knowledge graph describing the last two weeks on Oceanus. Clepper and his intern have spent a large amount of time generating this knowledge graph, and they would now like some assistance using it to answer the following questions.</p>
<ol type="1">
<li><p><strong>Clepper found that messages frequently came in at around the same time each day.</strong></p>
<ul>
<li><p>Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.</p></li>
<li><p>How do these patterns shift over the two weeks of observations?</p></li>
<li><p>Focus on a specific entity and use this information to determine who has influence over them.</p></li>
</ul></li>
<li><p><strong>Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.</strong></p>
<ul>
<li><p>Use visual analytics to help Clepper understand and explore the interactions and relationships between vessels and people in the knowledge graph.</p></li>
<li><p>Are there groups that are more closely associated? If so, what are the topic areas that are predominant for each group?</p>
<ul>
<li>For example, these groupings could be related to: Environmentalism (known associates of Green Guardians), Sailor Shift, and fishing/leisure vessels.</li>
</ul></li>
</ul></li>
<li><p><strong>It was noted by Clepper’s intern that some people and vessels are using pseudonyms to communicate.</strong></p>
<ul>
<li><p>Expanding upon your prior visual analytics, determine who is using pseudonyms to communicate, and what these pseudonyms are.</p>
<p>Some that Clepper has already identified include: “Boss”, and “The Lookout”, but there appear to be many more.</p>
<p>To complicate the matter, pseudonyms may be used by multiple people or vessels.</p></li>
<li><p>Describe how your visualizations make it easier for Clepper to identify common entities in the knowledge graph.</p></li>
<li><p>How does your understanding of activities change given your understanding of pseudonyms?</p></li>
</ul></li>
<li><p><strong>Clepper suspects that Nadia Conti, who was formerly entangled in an illegal fishing scheme, may have continued illicit activity within Oceanus.</strong></p>
<ul>
<li><p>Through visual analytics, provide evidence that Nadia is, or is not, doing something illegal.</p></li>
<li><p>Summarize Nadia’s actions visually. Are Clepper’s suspicions justified?</p></li>
</ul></li>
</ol>
<p><strong>Reflection Questions</strong></p>
<ul>
<li><p>Given the task to develop visualizations for knowledge graphs, did you find that the challenge pushed you to develop new techniques for visual representation?</p></li>
<li><p>Did you participate in last year’s challenge? If so, did your experience last year help prepare you for this year’s challenge?</p></li>
<li><p>What was the most difficult part of working on this year’s data and what could have made it more accessible?</p></li>
</ul>
</section>
<section id="mc3-kickstarter" class="level1">
<h1>MC3 Kickstarter</h1>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>In the code chunk below, <code>p_load()</code> of pacman package is used to load the R packages into R environment.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               tidygraph, ggraph,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               SmartEDA, lubridate,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               dplyr, igraph,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-knowledge-graph-data" class="level2">
<h2 class="anchored" data-anchor-id="import-knowledge-graph-data">Import knowledge Graph Data</h2>
<p>For this exercise, <em>mc3.json</em> file will be used. In the code chunk below, <code>fromJSON()</code> of jsonlite package is used to import <em>mc3.json</em> file into R and save the output object.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inspecting-knowledge-graph-structure" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-knowledge-graph-structure">Inspecting Knowledge graph structure</h2>
<p>In the code chunk below, <code>glimpse()</code> is used to reveal the structure of the <em>mc3</em> knowledge graph.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ directed  : logi TRUE
 $ multigraph: logi FALSE
 $ graph     :List of 4
  ..$ mode        : chr "static"
  ..$ edge_default: Named list()
  ..$ node_default: Named list()
  ..$ name        : chr "VAST_MC3_Knowledge_Graph"
 $ nodes     :'data.frame': 1159 obs. of  31 variables:
  ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  ..$ findings         : chr [1:1159] NA NA NA NA ...
  ..$ content          : chr [1:1159] NA NA NA NA ...
  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  ..$ results          : chr [1:1159] NA NA NA NA ...
  ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  ..$ destination      : chr [1:1159] NA NA NA NA ...
  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  ..$ outcome          : chr [1:1159] NA NA NA NA ...
  ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  ..$ thing_collected  :'data.frame':   1159 obs. of  2 variables:
  .. ..$ type: chr [1:1159] NA NA NA NA ...
  .. ..$ name: chr [1:1159] NA NA NA NA ...
  ..$ reference        : chr [1:1159] NA NA NA NA ...
  ..$ date             : chr [1:1159] NA NA NA NA ...
  ..$ time             : chr [1:1159] NA NA NA NA ...
  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  ..$ start_date       : chr [1:1159] NA NA NA NA ...
  ..$ end_date         : chr [1:1159] NA NA NA NA ...
  ..$ report_type      : chr [1:1159] NA NA NA NA ...
  ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  ..$ operational_role : chr [1:1159] NA NA NA NA ...
 $ edges     :'data.frame': 3226 obs. of  5 variables:
  ..$ id         : chr [1:3226] "2" "3" "5" "3013" ...
  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  ..$ source     : chr [1:3226] "Sam" "Sam" "Sam" "Sam" ...
  ..$ target     : chr [1:3226] "Relationship_Suspicious_217" "Event_Communication_370" "Event_Assessment_600" "Relationship_Colleagues_430" ...
  ..$ type       : chr [1:3226] NA "sent" NA NA ...</code></pre>
</div>
</div>
</section>
<section id="extracting-the-edges-and-nodes-tables" class="level2">
<h2 class="anchored" data-anchor-id="extracting-the-edges-and-nodes-tables">Extracting the edges and nodes tables</h2>
<p>Next, <code>as_tibble()</code> of tibble package is used to extract the nodes and links tibble data frames from <em>mc3</em> tibble dataframe into two separate tibble dataframes called <em>mc3_nodes</em> and <em>mc3_edges</em> respectively.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">Initial EDA</h2>
<p>In the code chunk below, <code>ExpCatViz()</code> of SmartEDA package is used to reveal the frequency distribution of all categorical fields in <em>mc3_nodes</em> tibble dataframe</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[13]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[14]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On the other hand, code chunk below uses <code>ExpCATViz()</code> of SmartEDA package to reveal the frequency distribution of all categorical fields in <em>mc3_edges</em> tibble dataframe</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_edges,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-cleaning-and-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-wrangling">Data Cleaning and Wrangling</h2>
<p>The code chunk below performs the following data cleaning tasks:</p>
<ul>
<li><p>convert values in id field into character data type</p></li>
<li><p>exclude records with <code>id</code> value</p></li>
<li><p>exclude records with similar id values</p></li>
<li><p>exclude <code>thing_collected</code> field</p></li>
<li><p>save the cleaned tibble dataframe into a new tibble datatable called <code>mc_nodes_cleaned</code></p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-and-wrangling-edges" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-and-wrangling-edges">Cleaning and wrangling edges</h2>
<p>Next, the code chunk will be used to:</p>
<ul>
<li><p>rename source and target fields to form_id and to_id respectively</p></li>
<li><p>convert values in from_id and to_id fields to character data type</p></li>
<li><p>exclude values in from_id and to_id which is not found in the id field of mc3_nodes_cleaned</p></li>
<li><p>exclude records whereby from_id and/or to_id values are missing</p></li>
<li><p>save the cleaned tibble dataframe and call it mc3_edges_cleaned</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, code chunk below will be used to create mapping of character id in <code>mc3_nodes_cleaned</code> to row index.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to join and convert <code>from_id</code> and <code>to_id</code> to integer indices. At the same time, we will drop rows with unmatched nodes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below is used to subset nodes to only those referenced by edges</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will then use th code chunk below to rebuild lookup from old index to new index</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below will be used to update edge indices to match new node table</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc3_edges_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,226
Columns: 4
$ from        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3…
$ to          &lt;int&gt; 1138, 357, 747, 895, 876, 888, 896, 145, 404, 876, 888, 92…
$ is_inferred &lt;lgl&gt; TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, T…
$ type        &lt;chr&gt; NA, "sent", NA, NA, NA, NA, NA, "sent", "sent", NA, NA, NA…</code></pre>
</div>
</div>
</section>
</section>
<section id="building-the-tidygraph-object" class="level1">
<h1>Building the tidygraph object</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'tbl_graph', 'igraph'  hidden list of 10
 $ : num 1159
 $ : logi TRUE
 $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...
 $ : num [1:3226] 1137 356 746 894 875 ...
 $ : NULL
 $ : NULL
 $ : NULL
 $ : NULL
 $ :List of 4
  ..$ : num [1:3] 1 0 1
  ..$ : Named list()
  ..$ :List of 31
  .. ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  .. ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  .. ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ findings         : chr [1:1159] NA NA NA NA ...
  .. ..$ content          : chr [1:1159] NA NA NA NA ...
  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ results          : chr [1:1159] NA NA NA NA ...
  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ destination      : chr [1:1159] NA NA NA NA ...
  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...
  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ reference        : chr [1:1159] NA NA NA NA ...
  .. ..$ date             : chr [1:1159] NA NA NA NA ...
  .. ..$ time             : chr [1:1159] NA NA NA NA ...
  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...
  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...
  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...
  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...
  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ :List of 2
  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  .. ..$ type       : chr [1:3226] NA "sent" NA NA ...
 $ :&lt;environment: 0x000001f9f2b629a0&gt; 
 - attr(*, "active")= chr "nodes"</code></pre>
</div>
</div>
</section>
<section id="visualising-the-knowledge-graph" class="level1">
<h1>Visualising the knowledge graph</h1>
<p>Several of the ggraph layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, ggraph functions are used to create the whole graph</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Data Cleaning</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">People/Vessel Vs Relationship Subtypes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">People vs Relationship Subtype</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>For nodes, the code <code>filter()</code> will be used to filter out only <em>Person and Vessel</em> from <em>Entity</em>, and <em>Communication</em> from <em>Event</em> and their <em>relationship.</em></p>
<p>After this filter, the nodes only contain:</p>
<ul>
<li><p>entity nodes whose sub_type is Person or Vessel</p></li>
<li><p>Event nodes whose sub_type is Communication</p></li>
<li><p>Any node whose type is Relationship.</p></li>
</ul>
<p><code>mutate()</code> adds a new column called idx to the filtered data frame</p>
<p><code>select()</code> extracts 2 columns from <em>selected_nodes</em> and give them a new id and rename to <em>id_map</em></p>
<p>For Edges, <code>filter()</code> keeps only those where both endpoints are in the <em>old</em> column of <em>id_map.</em></p>
<p><code>left_join()</code> matches each row’s <em>to</em> value against <em>id_map$old</em> and brings in <em>id_map$new</em> for that <em>to</em> node and renames it <em>to_new</em>. Same thing for the <em>from</em> column.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>selected_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Entity"</span>     <span class="sc">&amp;</span> sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">|</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Event"</span>      <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span>)      <span class="sc">|</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Relationship"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idx =</span> <span class="fu">row_number</span>())</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping old_index → new idx</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>id_map <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">old =</span> new_index, <span class="at">new =</span> idx)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. filter edges so both ends are in selected_nodes</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>selected_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> id_map<span class="sc">$</span>old, to <span class="sc">%in%</span> id_map<span class="sc">$</span>old) <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. re-index the endpoints</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span>   <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new   =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Step 1: we proceed to <code>filter()</code> only the edges that we want, specifically <em>sent, received and evidence_for</em>. The labels for the edges show “sent”, “received” and “evidence_for” using <code>transmute()</code>.</p>
<p>Step 2: We then build the node table and colour by sub_type which is called <em>group</em>. The label for the names/vessels will be placed under the node using <em>label.</em></p>
<p>Step 3: Draw a Visnetwork graph.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)       <span class="co"># for pivot_longer()</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Build sender/receiver pairs and their relationship nodes</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>send_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> from, <span class="at">comm =</span> to) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sender, comm)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>recv_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(receiver, comm)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>rel_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"evidence_for"</span>, <span class="st">"is_inferred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rel =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rel, comm)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Join to get each (sender, receiver, rel) for every communication event</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>triplets <span class="ot">&lt;-</span> send_pairs <span class="sc">%&gt;%</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(recv_pairs, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(rel_edges, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">person1 =</span> <span class="fu">pmin</span>(sender, receiver),</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">person2 =</span> <span class="fu">pmax</span>(sender, receiver)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(person1, person2, rel, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(person1, person2, rel)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Collect unique node‐IDs used (persons/vessels and relationship nodes)</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>node_ids_used <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(triplets<span class="sc">$</span>person1, triplets<span class="sc">$</span>person2, triplets<span class="sc">$</span>rel))</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Build a lookup of node info for those IDs,</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co">#    but filter to only Person/Vessel entity subtypes and Relationship nodes</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>nodes_sub <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(new_index <span class="sc">%in%</span> node_ids_used) <span class="sc">%&gt;%</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>) <span class="sc">|</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"Relationship"</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(new_index, label, sub_type, type)</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 4a. Define pleasing, non‐grey colors for entity subtypes</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>entity_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>),</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">color    =</span> <span class="fu">c</span>(<span class="st">"#2c7fb8"</span>, <span class="st">"#e6550d"</span>)  <span class="co"># blue for Person, orange for Vessel</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 4b. Identify all relationship subtypes and assign distinct, visually pleasing colors</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>rel_subtypes <span class="ot">&lt;-</span> nodes_sub <span class="sc">%&gt;%</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Relationship"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sub_type)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>n_rels <span class="ot">&lt;-</span> <span class="fu">length</span>(rel_subtypes)</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>  base_palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">min</span>(n_rels, <span class="dv">8</span>), <span class="st">"Set2"</span>)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="fu">length</span>(base_palette)) {</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>    rel_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(base_palette)(n_rels)</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    rel_colors <span class="ot">&lt;-</span> base_palette[<span class="dv">1</span><span class="sc">:</span>n_rels]</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>  rel_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub_type =</span> rel_subtypes,</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> rel_colors</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>  rel_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sub_type =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="co"># 4c. Combine entity and relationship color mappings</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(entity_color_map, rel_color_map)</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a><span class="co"># 4d. Build nodes_vis with assigned colors (no grey)</span></span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> nodes_sub <span class="sc">%&gt;%</span></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(color_map, <span class="at">by =</span> <span class="st">"sub_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">id       =</span> new_index,</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">label    =</span> label,</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub_type =</span> sub_type,</span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> color</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Build the visNetwork 'edges' data frame</span></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a><span class="co"># 5a. Edges between the two people/vessels (no label)</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>edges_comm_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person1,</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> person2,</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">""</span>,     <span class="co"># no “comm” text</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">2</span>,</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a><span class="co"># 5b. For each triplet, connect both persons to the relationship node (no label)</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>edges_rel_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="fu">c</span>(person1, person2),</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="cn">NULL</span>,</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"person"</span></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person,</span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> rel,</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">""</span>,    <span class="co"># no text here</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">1</span>,</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a><span class="co"># 5c. Combine both sets of edges</span></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(edges_comm_vis, edges_rel_vis)</span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Draw the visNetwork with a dropdown filter by sub_type.</span></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a><span class="co">#    Legend shows only subtypes in the graph, in oval shape, larger, and using our custom colors.</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis) <span class="sc">%&gt;%</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidth         =</span> <span class="dv">1</span>,</span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidthSelected =</span> <span class="dv">2</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),  <span class="co"># dark edge color</span></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="st">"sub_type"</span></span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> color_map<span class="sc">$</span>sub_type,</span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> color_map<span class="sc">$</span>color,</span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">size  =</span> <span class="fu">rep</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(color_map))</span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-b316f80421c5be0435d7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b316f80421c5be0435d7">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,24,25,26,27,28,29,30,31,32,33,34,35,36,37,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"sub_type":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"color":["#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#e6550d","#C592C5","#C592C5","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"]},"edges":{"from":[1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,3,3,3,4,4,4,5,5,5,5,5,5,3,3,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,3,3,7,7,7,7,3,3,3,7,7,7,7,7,7,7,7,8,8,8,8,8,7,7,7,8,8,8,8,8,8,8,7,3,3,3,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,13,13,13,1,1,1,1,13,12,12,1,12,13,12,13,13,12,12,13,13,1,13,12,12,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,12,15,15,15,15,15,15,15,15,15,12,12,15,15,16,16,16,15,16,16,14,14,14,14,14,15,16,17,17,15,15,15,18,18,18,18,18,18,18,18,18,7,7,7,7,18,7,7,24,24,24,24,24,24,24,24,24,24,4,4,4,24,24,24,24,24,4,4,4,3,3,3,24,24,24,24,24,7,7,25,25,26,26,24,26,27,27,27,27,25,25,25,27,27,27,7,7,17,17,17,6,6,17,17,24,4,4,27,27,27,27,27,27,6,6,24,27,27,27,6,24,24,27,27,27,26,28,26,26,27,25,25,28,28,28,28,28,28,24,28,28,28,28,28,28,28,25,25,25,28,28,28,28,28,28,28,28,28,28,27,27,27,28,28,28,28,28,29,29,29,29,29,29,29,27,27,29,29,29,28,28,29,29,29,29,29,28,28,28,31,31,5,5,5,29,29,31,31,31,31,31,31,31,29,27,29,29,29,27,27,27,29,28,28,28,29,29,27,27,3,3,3,27,27,27,27,27,27,27,27,27,27,28,30,28,28,28,27,27,27,27,27,27,24,24,27,24,24,27,27,24,24,24,24,24,24,27,27,3,3,3,3,27,7,7,7,7,1,2,1,2,1,2,1,2,3,3,5,3,24,3,5,3,5,3,4,3,4,3,4,3,4,3,4,3,4,5,5,3,5,4,5,5,17,5,31,5,31,3,5,5,6,6,6,6,27,6,27,6,27,7,27,7,7,7,36,7,36,7,36,7,36,7,7,7,24,7,24,7,27,7,7,3,7,3,7,7,7,7,7,7,27,7,27,7,27,7,7,3,7,7,7,7,17,7,17,7,27,7,36,8,8,8,8,8,17,8,17,7,8,7,8,8,8,8,8,8,8,8,8,8,17,3,8,3,8,8,8,8,8,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,12,13,12,15,12,13,12,13,12,15,12,15,12,15,12,15,12,15,12,15,12,12,12,12,13,32,1,13,12,13,12,13,13,13,29,13,14,17,14,17,14,17,14,16,14,16,15,17,15,17,15,17,15,17,15,17,15,17,15,17,15,17,15,17,12,15,15,17,15,17,15,24,15,24,15,27,15,36,12,15,15,16,16,17,15,16,16,17,16,17,14,16,14,16,14,16,14,16,15,17,15,17,15,17,15,17,18,27,18,36,18,36,18,36,18,36,18,36,7,18,7,18,7,18,7,18,7,18,6,17,36,36,5,5,5,6,27,5,5,27,28,28,28,28,32,5,31,31,31,5,5,5,28,28,29,30,31,31,28,28,29,35,27,27,28,32,32,28,28,28,28,31,29,29,30,36,36,17,15,24,24,24,27,24,24,36,24,7,8,8,3,3,24,24,36,24,27,24,27,24,26,24,26,24,24,36,24,36,24,36,24,36,4,24,24,27,24,27,4,24,3,24,3,24,3,24,24,27,24,27,24,24,27,24,36,24,36,24,24,7,24,26,27,26,28,26,27,27,27,25,27,25,27,7,27,17,27,6,27,17,27,17,27,27,27,27,4,27,27,32,27,36,6,27,24,27,27,36,27,36,27,36,6,27,24,27,24,27,27,27,36,27,32,27,26,28,26,28,25,28,28,28,29,28,29,28,32,28,29,28,32,28,32,28,28,28,31,28,31,28,30,28,31,28,34,28,27,28,28,31,28,28,28,29,32,29,32,29,31,29,27,29,29,30,29,28,30,30,29,31,29,31,31,31,31,31,5,31,5,31,29,31,31,31,31,31,31,32,29,32,29,32,27,32,27,32,32,28,32,29,32,27,32,3,32,3,32,27,32,27,32,27,33,27,33,27,33,28,34,27,34,35,35,36,36,27,36,27,36,36,36,27,36,36,24,36,36,24,36,27,36,24,36,24,36,24,36,24,36,27,36,27,36,36,3,36,3,36,36,36,37,27,37,7,37,7,37,28,36,36,28,27,27,32,32,32,33,31,27,27,26,30,26,24,35,35,30,24],"to":[2,2,2,2,5,24,25,5,5,4,4,4,4,4,4,4,5,4,4,4,5,5,5,5,5,17,17,31,31,31,31,5,5,27,27,27,7,7,27,27,7,36,36,36,36,7,24,24,24,27,27,27,7,7,7,7,27,27,27,27,7,7,7,7,7,17,17,17,27,36,36,8,8,17,17,17,8,8,8,15,8,8,8,8,8,17,8,8,8,8,8,8,36,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,15,15,15,13,13,15,15,15,15,15,15,15,15,15,15,13,12,12,12,15,15,15,13,13,32,32,32,13,13,13,13,32,13,13,13,13,29,13,29,29,13,13,28,28,13,32,13,13,17,17,17,17,17,16,16,17,17,17,17,17,17,17,17,17,17,15,17,17,24,24,24,27,27,36,36,15,15,16,16,17,17,17,16,17,17,16,16,16,16,16,17,17,27,27,17,17,17,27,36,36,36,36,36,36,36,36,18,18,18,18,36,18,18,27,27,27,26,26,36,36,36,36,36,24,24,24,27,28,27,27,36,24,24,24,24,24,24,27,27,27,36,36,24,24,28,36,27,28,26,27,36,36,36,36,27,27,27,33,33,28,27,27,27,27,27,27,27,27,27,27,27,27,32,32,32,36,36,36,27,27,27,36,36,36,27,27,27,36,33,32,28,34,28,28,28,28,28,29,29,29,32,32,32,28,29,29,32,32,28,31,31,28,28,28,31,31,30,30,30,31,31,34,30,29,28,28,28,28,31,31,31,31,32,32,32,32,32,31,32,29,29,31,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,888,888,1138,1138,895,895,876,876,924,941,941,893,893,1067,1067,897,897,1157,1157,895,895,892,892,1144,1144,1060,1060,896,896,1014,996,1142,1142,1148,1148,1063,1063,1007,1007,956,956,1149,1149,971,1016,952,927,952,952,1006,1006,932,932,905,905,1088,1088,922,922,1004,1004,1122,1122,923,923,925,1088,1088,1088,951,951,1088,1088,945,945,900,900,1106,1106,1054,1088,1113,1136,1068,1068,963,963,964,964,1120,900,1120,1120,1153,1153,1088,1088,932,932,899,899,905,905,1091,1091,925,925,913,913,885,885,932,932,905,905,1046,1114,1107,1107,932,932,905,905,1114,1114,932,932,905,905,1115,1115,1114,1114,889,889,1127,1127,1130,1130,1129,1129,1131,1131,1133,1133,1098,1098,1152,1152,908,908,980,980,981,981,1128,1128,1093,1093,1132,1132,1094,1094,1134,1134,983,983,985,985,1042,1042,958,958,959,959,1151,1151,1010,1010,875,875,901,901,977,977,901,901,884,884,932,932,977,977,1039,1039,1117,1117,951,951,954,954,1147,1147,910,910,932,932,984,984,1139,1139,987,1057,1057,929,1061,1061,1154,1154,1074,1074,1154,1154,903,903,877,877,887,887,884,884,977,977,1095,1095,1096,1096,921,921,913,913,878,878,928,928,1068,1068,932,932,1041,1041,937,937,1104,1104,894,894,1109,1109,887,887,1006,1006,878,878,878,878,887,887,990,990,1074,1074,902,902,878,878,1104,1104,1137,1137,1099,1099,1100,1100,1024,1024,882,882,909,909,938,938,939,939,1116,1116,898,898,899,899,994,994,904,904,1083,1083,909,1032,972,1124,1013,1001,1006,1006,1006,1027,1028,932,1006,961,946,1009,988,1059,956,1062,1006,1015,970,1010,1002,1123,1017,1020,979,1035,992,1006,1018,1003,1003,932,1031,936,1006,1051,1080,993,986,1022,1087,993,1078,916,1113,1101,928,1101,1102,1034,1101,1064,1065,1117,1117,1118,1117,951,900,928,1121,900,1088,933,933,1064,1064,1033,1033,928,928,1037,934,934,1101,1101,1047,1047,935,935,1040,1040,1045,1045,937,937,1048,1048,890,890,891,891,892,892,1105,1105,942,942,991,1111,1111,1117,1117,1113,1113,1068,1072,968,968,907,907,907,907,931,880,1088,1089,1090,1090,881,881,925,925,932,932,1030,1030,1156,1156,1006,1006,932,1050,925,1045,1045,932,932,1054,1054,1054,1054,932,932,943,943,1045,1045,951,951,1049,1049,1110,1110,1050,1050,1112,1069,1069,1077,1077,999,917,917,918,918,1053,1053,929,1075,1075,929,929,1043,1043,1141,1141,986,986,1080,1080,1043,1043,1052,1052,1055,1055,1073,1073,989,989,961,961,1119,1079,1079,961,961,1011,1012,961,1018,1018,1025,1025,1023,1023,1145,1036,1036,1076,1076,1023,1056,1056,1066,1022,1022,1035,1035,955,955,1006,1006,989,989,957,957,998,998,1081,1081,974,974,1082,1082,1136,1136,1038,1038,920,920,1136,1136,1097,1140,1140,1140,1140,1140,1140,1146,1146,1006,1006,1008,1008,953,953,1070,1070,950,950,962,962,1058,1058,961,961,919,1155,879,944,883,883,944,944,912,914,1044,1044,900,1044,1044,1044,940,940,1049,1049,1050,1050,1049,1049,1150,1150,1071,1071,1068,1068,965,965,973,1125,1125,973,973,1126,997,966,1084,1084,906,906,1086,1086,1015,915,1135,961,930,1009,953,969,1009,1021,956,1054,920,1005,1092,907,951,948,949,960,933],"label":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"width":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","borderWidth":1,"borderWidthSelected":2},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":{"color":"#333333","highlight":"#FF0000"},"font":{"align":"middle"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"sub_type","main":"Select by sub_type","values":["AccessPermission","Colleagues","Coordinates","Friends","Jurisdiction","Operates","Person","Reports","Suspicious","Unfriendly","Vessel"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Person","Vessel","AccessPermission","Colleagues","Coordinates","Friends","Jurisdiction","Operates","Reports","Suspicious","Unfriendly"],"shape":["ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse"],"color":["#2c7fb8","#e6550d","#66C2A5","#E9936A","#A89BB0","#C592C5","#C6B18B","#C7D846","#F8D348","#DEC197","#B3B3B3"],"size":[20,20,20,20,20,20,20,20,20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Exclude all “Vessel” nodes and any edges involving them</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>nodes_vis2 <span class="ot">&lt;-</span> nodes_vis <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">!=</span> <span class="st">"Vessel"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>edges_vis2 <span class="ot">&lt;-</span> edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes_vis2<span class="sc">$</span>id, to <span class="sc">%in%</span> nodes_vis2<span class="sc">$</span>id)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Build a reduced legend data.frame for the remaining subtypes</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>legend_map2 <span class="ot">&lt;-</span> color_map <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">unique</span>(nodes_vis2<span class="sc">$</span>sub_type))</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Draw the new visNetwork without Vessel nodes</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis2, edges_vis2) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidth         =</span> <span class="dv">1</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidthSelected =</span> <span class="dv">2</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="st">"sub_type"</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> legend_map2<span class="sc">$</span>sub_type,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"ellipse"</span>,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> legend_map2<span class="sc">$</span>color,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">size  =</span> <span class="fu">rep</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(legend_map2))</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-ba0d097b346deca10955" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ba0d097b346deca10955">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1020,1021,1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"sub_type":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"color":["#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#2c7fb8","#C592C5","#C592C5","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#E9936A","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#66C2A5","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#F8D348","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#C6B18B","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#A89BB0","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#C7D846","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#DEC197","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"]},"edges":{"from":[1,1,1,1,3,3,3,3,3,3,3,3,3,3,4,3,3,3,3,3,4,4,4,5,5,3,3,7,7,7,7,7,7,3,3,3,3,3,7,7,7,7,7,8,8,8,8,8,7,7,7,8,8,8,8,8,8,8,7,3,3,3,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,1,1,1,1,12,12,1,12,12,12,12,1,12,12,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,12,15,15,12,12,15,15,16,16,16,15,16,16,14,14,14,14,14,15,16,15,15,15,7,7,7,7,7,7,1,2,1,2,1,2,1,2,3,3,5,3,3,5,3,5,3,4,3,4,3,4,3,4,3,4,3,4,5,5,3,5,4,5,5,17,5,5,3,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,3,7,3,7,7,7,7,7,7,7,7,7,7,3,7,7,7,7,17,7,17,7,7,8,8,8,8,8,17,8,17,7,8,7,8,8,8,8,8,8,8,8,8,8,17,3,8,3,8,8,8,8,8,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,10,11,12,13,12,15,12,13,12,13,12,15,12,15,12,15,12,15,12,15,12,15,12,12,12,12,13,1,13,12,13,12,13,13,13,13,14,17,14,17,14,17,14,16,14,16,15,17,15,17,15,17,15,17,15,17,15,17,15,17,15,17,15,17,12,15,15,17,15,17,15,15,15,15,12,15,15,16,16,17,15,16,16,17,16,17,14,16,14,16,14,16,14,16,15,17,15,17,15,17,15,17,18,18,18,18,18,18,7,18,7,18,7,18,7,18,7,18,6,17,5,5,5,6,5,5,5,5,5,5,17,15,7,8,8,3,3,4,4,3,3,3,7,7,17,6,17,17,4,6,6,5,5,3,3,3,3,7,7],"to":[2,2,2,2,5,5,5,4,4,4,4,4,4,4,5,4,4,4,5,5,5,5,5,17,17,5,5,7,7,7,7,7,7,7,7,7,7,7,7,7,17,17,17,8,8,17,17,17,8,8,8,15,8,8,8,8,8,17,8,8,8,8,8,8,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,13,15,15,15,13,13,15,15,15,15,15,15,15,15,15,15,13,12,12,12,15,15,15,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,17,17,17,17,17,16,16,17,17,17,17,17,17,17,17,17,17,15,17,17,15,15,16,16,17,17,17,16,17,17,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,888,888,1138,1138,895,895,876,876,924,941,941,893,1067,1067,897,897,1157,1157,895,895,892,892,1144,1144,1060,1060,896,896,1014,996,1142,1142,1148,1148,1063,1063,1007,956,1149,1149,971,1016,952,927,952,1006,932,905,1088,1088,922,1004,1122,923,925,1088,1088,951,1088,945,945,900,900,1106,1106,1054,1088,1113,1136,1068,963,964,1120,900,1120,1120,1153,1153,1088,1088,932,932,899,905,1091,1091,925,925,913,913,885,885,932,932,905,905,1046,1114,1107,1107,932,932,905,905,1114,1114,932,932,905,905,1115,1115,1114,1114,889,889,1127,1127,1130,1130,1129,1129,1131,1131,1133,1133,1098,1098,1152,1152,908,908,980,980,981,981,1128,1128,1093,1093,1132,1132,1094,1094,1134,1134,983,983,985,985,1042,1042,958,958,959,959,1151,1151,1010,1010,875,875,901,901,977,977,901,901,884,884,932,932,977,977,1039,1039,1117,1117,951,951,954,954,1147,1147,910,932,932,984,984,1139,1139,987,1057,929,1061,1061,1154,1154,1074,1074,1154,1154,903,903,877,877,887,887,884,884,977,977,1095,1095,1096,1096,921,921,913,913,878,878,928,928,1068,1068,932,932,1041,937,1104,894,1109,1109,887,887,1006,1006,878,878,878,878,887,887,990,990,1074,1074,902,902,878,878,1104,1104,1137,1137,1099,1099,1100,1100,1024,882,909,938,939,1116,898,898,899,899,994,994,904,904,1083,1083,909,1032,1013,1001,1006,1006,1027,1028,1059,1015,970,1010,1101,928,1118,1117,951,900,928,1040,1048,890,891,892,968,925,932,1030,1156,1006,1045,1054,1049,989,957,1146,1006,1125,973,906,1086],"label":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"width":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","borderWidth":1,"borderWidthSelected":2},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":{"color":"#333333","highlight":"#FF0000"},"font":{"align":"middle"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"sub_type","main":"Select by sub_type","values":["AccessPermission","Colleagues","Coordinates","Friends","Jurisdiction","Operates","Person","Reports","Suspicious","Unfriendly"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Person","AccessPermission","Colleagues","Coordinates","Friends","Jurisdiction","Operates","Reports","Suspicious","Unfriendly"],"shape":["ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse","ellipse"],"color":["#2c7fb8","#66C2A5","#E9936A","#A89BB0","#C592C5","#C6B18B","#C7D846","#F8D348","#DEC197","#B3B3B3"],"size":[20,20,20,20,20,20,20,20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<section id="q2-part-a" class="level3">
<h3 class="anchored" data-anchor-id="q2-part-a">Q2 Part A</h3>
<p>By selecting the different sub-groups from the drop-down below, we can conclude the following information.</p>
<p><strong>Colleagues:</strong></p>
<ul>
<li><p>Boss, Mrs Money and The Middleman</p></li>
<li><p>Boss, The Accountant and The Middleman</p></li>
<li><p>The Lookout, The Intern and Mrs Money</p></li>
<li><p>Mrs Money and The Intern</p></li>
<li><p>Boss and Mrs Money</p></li>
<li><p>Boss and Rodriguez</p></li>
<li><p>Small Fry and Davis</p></li>
<li><p>Nadia Conti and Davis</p></li>
<li><p>Nadia Conti and Elise</p></li>
<li><p>Nadia Conti and Liam Thorne</p></li>
<li><p>Sam and Kelly</p></li>
</ul>
<p><strong>Friends:</strong></p>
<ul>
<li><p>Sam and Kelly</p></li>
<li><p>The Intern and The Lookout</p></li>
</ul>
<p><strong>Unfriendly:</strong></p>
<ul>
<li>Elise and Nadia Conti</li>
</ul>
<p><strong>Suspicious:</strong></p>
<ul>
<li>Boss, Mrs Money, The Intern, The Lookout, The Accountant</li>
<li>Sam, Kelly, Liam Thorne, Elise, Nadia Conti, Davis</li>
</ul>
<p>From the above results, it can be seen that either Sam or Kelly holds the status of The Intern and The Lookout as they are the only ones with the relationship of friends in the conclusion above.</p>
<p>Boss seems to be the one with the most information and power as Mrs Money, The Accountant and The Middlman transmit information to The Boss only</p>
</section>
<section id="q2-part-b" class="level2">
<h2 class="anchored" data-anchor-id="q2-part-b">Q2 Part B</h2>
<p>Based on the question 2b, I have categorised them into the 3 different Entity Subgroups: Person, Organisation and Vessel</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Group by organisation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Group by Person</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Group by Vessels</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>comm_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_index =</span> new_index, content)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build a mapping from communication events to entities (Organization subtype)</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>send_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">entity_index =</span> from, <span class="at">event_index =</span> to)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>recv_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">event_index =</span> from, <span class="at">entity_index =</span> to)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>event_to_entity <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(send_map, recv_map)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join event_to_entity with comm_nodes, then keep only Organization entities</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>comm_by_entity <span class="ot">&lt;-</span> event_to_entity <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_nodes, <span class="at">by =</span> <span class="st">"event_index"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    mc3_nodes_final <span class="sc">%&gt;%</span> </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">entity_index =</span> new_index, sub_type, label),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"entity_index"</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Organization"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">organization =</span> label, content)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Collapse all texts per organization</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>org_texts <span class="ot">&lt;-</span> comm_by_entity <span class="sc">%&gt;%</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(organization) <span class="sc">%&gt;%</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">text =</span> <span class="fu">paste</span>(content, <span class="at">collapse =</span> <span class="st">" "</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Tokenize, remove stop‐words, and compute word frequencies per organization</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>tidy_org_words <span class="ot">&lt;-</span> org_texts <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(organization, word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Plot one word cloud per organization</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>org_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(tidy_org_words<span class="sc">$</span>organization)</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>n_orgs   <span class="ot">&lt;-</span> <span class="fu">length</span>(org_list)</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>n_cols   <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>n_rows   <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n_orgs <span class="sc">/</span> n_cols)</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(n_rows, n_cols), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (org <span class="cf">in</span> org_list) {</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  freq_tbl <span class="ot">&lt;-</span> tidy_org_words <span class="sc">%&gt;%</span> <span class="fu">filter</span>(organization <span class="sc">==</span> org)</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(freq_tbl) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> org)</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">setNames</span>(freq_tbl<span class="sc">$</span>n, freq_tbl<span class="sc">$</span>word)</span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wordcloud</span>(</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">words        =</span> <span class="fu">names</span>(v),</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq         =</span> <span class="fu">as.numeric</span>(v),</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.words    =</span> <span class="dv">20</span>,</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale        =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">random.order =</span> <span class="cn">FALSE</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">main =</span> org, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>For Organisation: It can be seen that Team Glitters does not have any pre-dominant topic area.</p>
<p>Oceanus City Council, Sailor Shift Team and Green Guardians seems to have common words like nemo, city, reef ,equipment and vessel, showing that they are more concerned about the environment.</p>
<p>V. Miesel Shipping however, is more concerned about regulations as the most commonly used words are permit, operations and documentation.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Assuming you already have mc3_nodes_final and mc3_edges_final loaded)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>comm_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_index =</span> new_index, content)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build a mapping from communication events to entities</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>send_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">entity_index =</span> from, <span class="at">event_index =</span> to)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>recv_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">event_index =</span> from, <span class="at">entity_index =</span> to)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>event_to_entity <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(send_map, recv_map)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join event_to_entity with comm_nodes, then keep only Person entities</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>comm_by_person <span class="ot">&lt;-</span> event_to_entity <span class="sc">%&gt;%</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_nodes, <span class="at">by =</span> <span class="st">"event_index"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    mc3_nodes_final <span class="sc">%&gt;%</span> </span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">entity_index =</span> new_index, sub_type, label),</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"entity_index"</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">person =</span> label, content)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Collapse all texts per person</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>person_texts <span class="ot">&lt;-</span> comm_by_person <span class="sc">%&gt;%</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(person) <span class="sc">%&gt;%</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">text =</span> <span class="fu">paste</span>(content, <span class="at">collapse =</span> <span class="st">" "</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Tokenize, remove stop‐words, and compute word frequencies per person</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>tidy_person_words <span class="ot">&lt;-</span> person_texts <span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(person, word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Plot one word cloud per person</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>person_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(tidy_person_words<span class="sc">$</span>person)</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>n_persons   <span class="ot">&lt;-</span> <span class="fu">length</span>(person_list)</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>n_cols      <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>n_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n_persons <span class="sc">/</span> n_cols)</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(n_rows, n_cols), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> person_list) {</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>  freq_tbl <span class="ot">&lt;-</span> tidy_person_words <span class="sc">%&gt;%</span> <span class="fu">filter</span>(person <span class="sc">==</span> p)</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(freq_tbl) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> p)</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">setNames</span>(freq_tbl<span class="sc">$</span>n, freq_tbl<span class="sc">$</span>word)</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wordcloud</span>(</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">words        =</span> <span class="fu">names</span>(v),</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq         =</span> <span class="fu">as.numeric</span>(v),</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.words    =</span> <span class="dv">10</span>,</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale        =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">random.order =</span> <span class="cn">FALSE</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">main =</span> p, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
<p><strong>For Person Subgroups:</strong></p>
<p><strong>Top 3 Commonly Used Words:</strong></p>
<p>Mrs Money: Meeting, Nemo Reef, Intern</p>
<p>The Intern: Nemo Reef, Lookout, Money</p>
<p>The Lookout: Nemo Reef, Intern, tomorrow</p>
<p>Boss: Nemo Reef, meeting, middleman</p>
<p>The Middleman: Nemo reef, boss, meeting</p>
<p>The Accountant: meeting, middleman, boss</p>
<p><strong>It can be seen that these 6 people are in contact with each other as their most commonly used terms concern each other and usually revolves around Nemo Reef.</strong></p>
<p>Liam Thorne: Nemo Reef, council, report</p>
<p>Nadia Conti: Nemo Reef, documentation, meeting</p>
<p>Rodriguez: Nemo reef, davis, remora</p>
<p>Samantha Blake: Nemo Reef, tomorrow, city council</p>
<p>Elise: Nemo Reef, tomorrow, meeting</p>
<p><strong>It can also be seen that these group of people have common schedules like meeting, tomorrow and City Council, and they are also concerned about Nemo Reef.</strong></p>
<p>Clepper Jensen: Miranda, equipment, environmental</p>
<p>Miranda Jordan: Miranda, equipment, clepper Jensen</p>
<p>Davis: Mako, security, equipment</p>
<p>Sam: birdwatching, lookout, reef</p>
<p>Mako: try, team, remora</p>
<p>Kelly: sam, kelly</p>
<p><strong>These group of people here have different focus and do not have commonailities with the groups above.</strong></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>comm_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_index =</span> new_index, content)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build a mapping from communication events to entities (sender/receiver)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>send_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">entity_index =</span> from, <span class="at">event_index =</span> to)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>recv_map <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">event_index =</span> from, <span class="at">entity_index =</span> to)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>event_to_entity <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(send_map, recv_map)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join event_to_entity with comm_nodes, then keep only Vessel entities</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>comm_by_vessel <span class="ot">&lt;-</span> event_to_entity <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_nodes, <span class="at">by =</span> <span class="st">"event_index"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">entity_index =</span> new_index, sub_type, label),</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"entity_index"</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>) <span class="sc">%&gt;%</span>      <span class="co"># &lt;— change here</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">vessel =</span> label, content)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Collapse all texts per vessel</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>vessel_texts <span class="ot">&lt;-</span> comm_by_vessel <span class="sc">%&gt;%</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">text =</span> <span class="fu">paste</span>(content, <span class="at">collapse =</span> <span class="st">" "</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Tokenize, remove stop‐words, and compute word frequencies per vessel</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>tidy_vessel_words <span class="ot">&lt;-</span> vessel_texts <span class="sc">%&gt;%</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(vessel, word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Plot one word cloud per vessel</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>vessel_list <span class="ot">&lt;-</span> <span class="fu">unique</span>(tidy_vessel_words<span class="sc">$</span>vessel)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>n_vess   <span class="ot">&lt;-</span> <span class="fu">length</span>(vessel_list)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>n_cols   <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>n_rows   <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n_vess <span class="sc">/</span> n_cols)</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(n_rows, n_cols), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ves <span class="cf">in</span> vessel_list) {</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  freq_tbl <span class="ot">&lt;-</span> tidy_vessel_words <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vessel <span class="sc">==</span> ves)</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(freq_tbl) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> ves)</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">setNames</span>(freq_tbl<span class="sc">$</span>n, freq_tbl<span class="sc">$</span>word)</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wordcloud</span>(</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">words        =</span> <span class="fu">names</span>(v),</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq         =</span> <span class="fu">as.numeric</span>(v),</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.words    =</span> <span class="dv">20</span>,</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale        =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">random.order =</span> <span class="cn">FALSE</span></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="at">main =</span> ves, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="question-3" class="level1">
<h1>Question 3</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Daily Network Graph of Communication</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Communication between People and Vessels</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>daily_comms <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Event"</span>, sub_type<span class="sc">==</span><span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as_date</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(idx, date)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>all_dates <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(daily_comms<span class="sc">$</span>date)) <span class="sc">%&gt;%</span> <span class="fu">discard</span>(is.na)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">map</span>(all_dates, <span class="cf">function</span>(d) {</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  comm_idx <span class="ot">&lt;-</span> daily_comms <span class="sc">%&gt;%</span> <span class="fu">filter</span>(date<span class="sc">==</span>d) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(idx)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  es <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"sent"</span>, to <span class="sc">%in%</span> comm_idx) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">comm=</span>to, <span class="at">sender=</span>from)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  er <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"received"</span>, from <span class="sc">%in%</span> comm_idx) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">comm=</span>from, <span class="at">receiver=</span>to)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  dp <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(es, er, <span class="at">by=</span><span class="st">"comm"</span>) <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">from=</span>sender, <span class="at">to=</span>receiver, <span class="at">type=</span><span class="st">"sent"</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(dp)<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  nodes_d <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(idx <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(dp<span class="sc">$</span>from, dp<span class="sc">$</span>to)), sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  dp <span class="ot">&lt;-</span> dp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes_d<span class="sc">$</span>idx, to <span class="sc">%in%</span> nodes_d<span class="sc">$</span>idx)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(dp)<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  nm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">old=</span>nodes_d<span class="sc">$</span>idx, <span class="at">new=</span><span class="fu">seq_len</span>(<span class="fu">nrow</span>(nodes_d)))</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  edges2 <span class="ot">&lt;-</span> dp <span class="sc">%&gt;%</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nm, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"from"</span><span class="ot">=</span><span class="st">"old"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">from=</span>new) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>new) <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(nm, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"to"</span><span class="ot">=</span><span class="st">"old"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">to=</span>new) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>new)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  nodes2 <span class="ot">&lt;-</span> nodes_d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">idx2=</span><span class="fu">seq_len</span>(<span class="fu">nrow</span>(nodes_d)))</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes=</span>nodes2, <span class="at">edges=</span>edges2, <span class="at">directed=</span><span class="cn">TRUE</span>)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  lay <span class="ot">&lt;-</span> <span class="fu">create_layout</span>(g, <span class="at">layout=</span><span class="st">"fr"</span>, <span class="at">niter=</span><span class="dv">500</span>, <span class="at">area=</span><span class="fu">vcount</span>(g)<span class="sc">^</span><span class="dv">2</span>, <span class="at">repulse=</span><span class="fu">vcount</span>(g)<span class="sc">^</span><span class="fl">1.2</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(lay) <span class="sc">+</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">color=</span>type),</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="dv">4</span>,<span class="st">"mm"</span>), <span class="at">type=</span><span class="st">"closed"</span>),</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">width=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>sub_type), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">ifelse</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Vessel"</span>), label, <span class="st">""</span>)),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">repel=</span><span class="cn">TRUE</span>, <span class="at">point.padding=</span><span class="fu">unit</span>(<span class="fl">0.5</span>,<span class="st">"lines"</span>),</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">box.padding=</span><span class="fu">unit</span>(<span class="fl">0.5</span>,<span class="st">"lines"</span>), <span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_edge_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">sent=</span><span class="st">"#7570B3"</span>)) <span class="sc">+</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Person=</span><span class="st">"#1b9e77"</span>, <span class="at">Vessel=</span><span class="st">"#d95f02"</span>)) <span class="sc">+</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">as.character</span>(d)) <span class="sc">+</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">hjust=</span><span class="fl">0.5</span>), <span class="at">legend.position=</span><span class="st">"right"</span>)</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(plots, <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides=</span><span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title=</span><span class="st">"MC3 Communications by Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/mc3_daily_networks_direct_trimmed-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p><strong>Additional visualisations are done below to further investigate the communication between the pseudonyms and real names.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Keep only Person/Vessel nodes, assigning colors by sub_type</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> idx,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build direct sender→receiver pairs from communication events</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> to, <span class="at">sender =</span> from)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>er <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> from, <span class="at">receiver =</span> to)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join on the communication node to get from→to, then count occurrences</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(es, er, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> dp <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(from, to, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes<span class="sc">$</span>id, to <span class="sc">%in%</span> nodes<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">width =</span> count, <span class="at">label =</span> <span class="fu">as.character</span>(count))</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Draw a visNetwork: node colors by type, edge width and label by count</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes, edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>, <span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#AAAAAA"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-560a2c4adb7b237140e1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-560a2c4adb7b237140e1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Sailor Shift","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","Mariner's Dream"],"color":["#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#1b9e77","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02","#d95f02"],"x":[0.1924793051219909,0.2822629193793227,-0.3034718727231097,-0.1837473261421605,0.001094827309007007,-0.9972540624976652,-0.5840849992426778,-0.3370963602896473,0.8228402102240098,0.993498014620205,1,0.1467432361824526,-0.02513368156745854,0.1376339393609802,-0.1076054698394799,0.08726445932481774,-0.1987680649058816,-0.7303551484948692,-0.470333358053448,-0.5416472010223841,-0.7134686763180048,-0.5949010122516023,-0.4830976174704871,-0.3322353753722217,-0.5339582692229281,-0.1384541561980578,-0.3505258530758323,-1,-0.739935981088804,0.8180931198730268,-0.4687817525556189,-0.9371254381076185,-0.5086699220463475],"y":[0.5834086814249531,0.7969097464458801,-0.4718871178304395,-0.3320024616364774,-0.3976062345987612,-0.216302213595403,-0.662640446610129,-0.8383597644172296,0.4390250557945974,-0.1340174109469313,-0.3211282019282053,-0.1550311293376386,0.182867148032916,-1,-0.5402887278366177,-0.7639507217641158,-0.7000756146745967,-0.8332401723659679,-0.3860036287286153,-0.2386928581272741,-0.1645343728016035,-0.3656879822426864,-0.02271310043788743,0.1223089562816331,0.2806709471820721,-0.04074743319197471,-0.04629094403016487,-0.430504327740048,0.121664814874435,-0.9686130698737427,-0.6181133024580889,-0.7014015521929627,1]},"edges":{"from":[1,2,3,3,3,4,4,5,5,5,5,6,7,7,7,7,7,7,8,8,8,8,8,8,10,11,12,12,12,13,13,13,13,13,14,14,15,15,15,15,15,15,16,16,16,16,17,17,17,18,18,18,19,19,19,19,19,19,19,20,20,20,21,21,21,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,25,26,26,26,26,26,27,27,27,27,27,28,29,29,29,31,31,31,31,31,32,32],"to":[2,1,5,19,20,3,5,3,4,17,26,22,3,7,17,19,22,31,3,7,8,15,17,31,11,10,12,13,15,1,12,23,24,27,16,17,12,16,17,19,22,31,5,14,15,17,15,16,22,7,22,31,3,4,7,21,22,23,31,22,23,31,19,22,23,4,6,7,17,19,20,21,23,27,28,31,19,20,21,22,23,24,25,26,27,29,22,23,25,26,27,23,5,23,24,26,27,3,22,23,24,25,22,22,23,25,3,7,8,19,22,7,22],"count":[1,2,2,2,1,3,1,2,1,1,1,3,5,6,1,1,5,4,1,3,4,1,3,1,20,18,1,8,15,8,12,1,5,4,1,2,5,3,6,2,1,1,2,3,3,4,4,3,1,2,1,4,1,3,2,1,7,1,9,1,1,2,2,2,2,1,4,1,2,3,1,1,2,4,2,5,1,3,3,2,3,3,3,4,3,2,1,1,2,3,4,1,2,2,5,2,2,1,5,1,5,1,6,1,3,1,1,1,1,6,9,2,1],"width":[1,2,2,2,1,3,1,2,1,1,1,3,5,6,1,1,5,4,1,3,4,1,3,1,20,18,1,8,15,8,12,1,5,4,1,2,5,3,6,2,1,1,2,3,3,4,4,3,1,2,1,4,1,3,2,1,7,1,9,1,1,2,2,2,2,1,4,1,2,3,1,1,2,4,2,5,1,3,3,2,3,3,3,4,3,2,1,1,2,3,4,1,2,2,5,2,2,1,5,1,5,1,6,1,3,1,1,1,1,6,9,2,1],"label":["1","2","2","2","1","3","1","2","1","1","1","3","5","6","1","1","5","4","1","3","4","1","3","1","20","18","1","8","15","8","12","1","5","4","1","2","5","3","6","2","1","1","2","3","3","4","4","3","1","2","1","4","1","3","2","1","7","1","9","1","1","2","2","2","2","1","4","1","2","3","1","1","2","4","2","5","1","3","3","2","3","3","3","4","3","2","1","1","2","3","4","1","2","2","5","2","2","1","5","1","5","1","6","1","3","1","1","1","1","6","9","2","1"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to","color":{"color":"#AAAAAA","highlight":"#FF0000"},"font":{"align":"middle"}},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<section id="q3-part-a" class="level2">
<h2 class="anchored" data-anchor-id="q3-part-a">Q3 Part A</h2>
<p>The pseudonyms used are:</p>
<ul>
<li><p>Boss</p></li>
<li><p>The Intern</p></li>
<li><p>Mrs Money</p></li>
<li><p>The Lookout</p></li>
<li><p>The Accountant</p></li>
<li><p>The Middleman</p></li>
</ul>
</section>
<section id="q3-part-b" class="level2">
<h2 class="anchored" data-anchor-id="q3-part-b">Q3 Part B</h2>
<p>My visualisations help to break down the communication on a daily basis and to draw the connections between the different people based on their communication groups.</p>
<p>From the figures above, it can be seen that the Boss is mostly always on the receiving end of the communication, with the exception of Mako(Vessel). The ones who are in direct contact with Boss are Mrs Money, The Middleman, Rodriguez, Davis, Liam Thorne, The Accountant and Mako (Vessel).</p>
<p>Mrs Money, however, receives information mainly from The Intern.</p>
<p>The Lookout and The Intern, however, usually communicates in both directions, with The Intern usually on the receiving end of information.</p>
<p>The Accountant only got communicated with Boss on 11 October and he is often communicating with The Middleman.</p>
<p>The Lookout also sends informations to Sam.</p>
<p><strong>There is a clear hierachy when sending information:</strong></p>
<p>Lookout -&gt; Intern -&gt; Mrs Money/The Accountant/The Middleman -&gt; Boss</p>
<p>Lookout -&gt; Sam</p>
</section>
<section id="q3-part-c" class="level2">
<h2 class="anchored" data-anchor-id="q3-part-c">Q3 Part C</h2>
<p>These visualisations have confirmed my understanding that Boss is likely the leader of the group and the Vessel that is in contact with boss is likely Mako for illegal activities. The illegal activities should be taking place around Nemo Reef or meetings are held around Nemo Reef. The ones of higher positions are probably Mrs Money, The Middleman and The Accountant who reports directly to Boss.</p>
<p>Rodriguez, Liam Thorne and Davis seem to be involved directly with The Boss as well.</p>
<p>Strangely, Nadia Conti seems to be at the receiving end of the communciation from Elise, Davis and Rodriguez and only replies to Liam Thorne. Nadia Conti is also in contact with several vessels.</p>
<p>The Intern and The Lookout seems to be of the same position in the syndicate, but The Intern is the only one who communicates with Mrs Money.</p>
<p>The Lookout seems to be reporting to Sam as well, as the communication is always in 1 direction.</p>
<p><strong>From all the previous analysis, I would like to conclude that Rodriguez and Davis are likely involved in the illegal activities as they are in direct contact with Boss. Sam is also likely involved as The Lookout reports to him frequently.</strong></p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb45" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-Home_Ex02"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Liaw Ying Ting, Celin"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 27 May 2025</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview - Mini Challenge 3</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>For this take-home exercise 2, Mini-Challenge 3 will be chosen and the visualisation will be done on this topic. The background of the mini challenge and the questions will be listed below. For this mini challenge, I will only be displaying and addressing **Questions 2 and 3** below.</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Background</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Task and Question</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>Clepper diligently recorded all intercepted radio communications over the last two weeks. With the help of his intern, they have analyzed their content to identify important events and relationships between key players. The result is a knowledge graph describing the last two weeks on Oceanus. Clepper and his intern have spent a large amount of time generating this knowledge graph, and they would now like some assistance using it to answer the following questions.</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Clepper found that messages frequently came in at around the same time each day.**</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>How do these patterns shift over the two weeks of observations?</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Focus on a specific entity and use this information to determine who has influence over them.</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.**</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use visual analytics to help Clepper understand and explore the interactions and relationships between vessels and people in the knowledge graph.</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Are there groups that are more closely associated? If so, what are the topic areas that are predominant for each group?</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>For example, these groupings could be related to: Environmentalism (known associates of Green Guardians), Sailor Shift, and fishing/leisure vessels.</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**It was noted by Clepper’s intern that some people and vessels are using pseudonyms to communicate.**</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Expanding upon your prior visual analytics, determine who is using pseudonyms to communicate, and what these pseudonyms are.</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>        Some that Clepper has already identified include: “Boss”, and “The Lookout”, but there appear to be many more.</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>        To complicate the matter, pseudonyms may be used by multiple people or vessels.</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Describe how your visualizations make it easier for Clepper to identify common entities in the knowledge graph.</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>How does your understanding of activities change given your understanding of pseudonyms?</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Clepper suspects that Nadia Conti, who was formerly entangled in an illegal fishing scheme, may have continued illicit activity within Oceanus.**</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Through visual analytics, provide evidence that Nadia is, or is not, doing something illegal.</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Summarize Nadia’s actions visually. Are Clepper’s suspicions justified?</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>**Reflection Questions**</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given the task to develop visualizations for knowledge graphs, did you find that the challenge pushed you to develop new techniques for visual representation?</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Did you participate in last year’s challenge? If so, did your experience last year help prepare you for this year’s challenge?</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What was the most difficult part of working on this year’s data and what could have made it more accessible?</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="fu"># MC3 Kickstarter</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting Started</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`p_load()`</span> of pacman package is used to load the R packages into R environment.</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite,</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>               tidygraph, ggraph,</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>               SmartEDA, lubridate,</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>               dplyr, igraph,</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>               grid)</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import knowledge Graph Data</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>For this exercise, *mc3.json* file will be used. In the code chunk below, `fromJSON()` of jsonlite package is used to import *mc3.json* file into R and save the output object.</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspecting Knowledge graph structure</span></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`glimpse()`</span> is used to reveal the structure of the *mc3* knowledge graph.</span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Extracting the edges and nodes tables</span></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a>Next, <span class="in">`as_tibble()`</span> of tibble package is used to extract the nodes and links tibble data frames from *mc3* tibble dataframe into two separate tibble dataframes called *mc3_nodes* and *mc3_edges* respectively.</span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Initial EDA</span></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`ExpCatViz()`</span> of SmartEDA package is used to reveal the frequency distribution of all categorical fields in *mc3_nodes* tibble dataframe</span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes,</span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a>On the other hand, code chunk below uses <span class="in">`ExpCATViz()`</span> of SmartEDA package to reveal the frequency distribution of all categorical fields in *mc3_edges* tibble dataframe</span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_edges,</span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Cleaning and Wrangling</span></span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a>The code chunk below performs the following data cleaning tasks:</span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert values in id field into character data type</span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records with <span class="in">`id`</span> value</span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records with similar id values</span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude <span class="in">`thing_collected`</span> field</span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>save the cleaned tibble dataframe into a new tibble datatable called <span class="in">`mc_nodes_cleaned`</span></span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning and wrangling edges</span></span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a>Next, the code chunk will be used to:</span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>rename source and target fields to form_id and to_id respectively</span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert values in from_id and to_id fields to character data type</span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude values in from_id and to_id which is not found in the id field of mc3_nodes_cleaned</span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records whereby from_id and/or to_id values are missing</span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>save the cleaned tibble dataframe and call it mc3_edges_cleaned</span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb45-186"><a href="#cb45-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb45-187"><a href="#cb45-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id),</span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a>Next, code chunk below will be used to create mapping of character id in <span class="in">`mc3_nodes_cleaned`</span> to row index.</span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span>
<span id="cb45-203"><a href="#cb45-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-204"><a href="#cb45-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a>Next, the code chunk below will be used to join and convert <span class="in">`from_id`</span> and <span class="in">`to_id`</span> to integer indices. At the same time, we will drop rows with unmatched nodes.</span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb45-212"><a href="#cb45-212" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-213"><a href="#cb45-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a>Next, the code chunk below is used to subset nodes to only those referenced by edges</span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb45-229"><a href="#cb45-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-230"><a href="#cb45-230" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb45-233"><a href="#cb45-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-234"><a href="#cb45-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a>We will then use th code chunk below to rebuild lookup from old index to new index</span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span>
<span id="cb45-244"><a href="#cb45-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-245"><a href="#cb45-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a>Lastly, the code chunk below will be used to update edge indices to match new node table</span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span>
<span id="cb45-260"><a href="#cb45-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-261"><a href="#cb45-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-264"><a href="#cb45-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-265"><a href="#cb45-265" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc3_edges_final)</span>
<span id="cb45-266"><a href="#cb45-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-267"><a href="#cb45-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-268"><a href="#cb45-268" aria-hidden="true" tabindex="-1"></a><span class="fu"># Building the tidygraph object</span></span>
<span id="cb45-269"><a href="#cb45-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-272"><a href="#cb45-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-273"><a href="#cb45-273" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb45-274"><a href="#cb45-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb45-275"><a href="#cb45-275" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb45-276"><a href="#cb45-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb45-277"><a href="#cb45-277" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-278"><a href="#cb45-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-279"><a href="#cb45-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-282"><a href="#cb45-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-283"><a href="#cb45-283" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span>
<span id="cb45-284"><a href="#cb45-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-285"><a href="#cb45-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-286"><a href="#cb45-286" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualising the knowledge graph</span></span>
<span id="cb45-287"><a href="#cb45-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-288"><a href="#cb45-288" aria-hidden="true" tabindex="-1"></a>Several of the ggraph layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.</span>
<span id="cb45-289"><a href="#cb45-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-292"><a href="#cb45-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-293"><a href="#cb45-293" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb45-294"><a href="#cb45-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-295"><a href="#cb45-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-296"><a href="#cb45-296" aria-hidden="true" tabindex="-1"></a>In the code chunk below, ggraph functions are used to create the whole graph</span>
<span id="cb45-297"><a href="#cb45-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-300"><a href="#cb45-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-301"><a href="#cb45-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb45-302"><a href="#cb45-302" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb45-303"><a href="#cb45-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb45-304"><a href="#cb45-304" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb45-305"><a href="#cb45-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb45-306"><a href="#cb45-306" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb45-307"><a href="#cb45-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb45-308"><a href="#cb45-308" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb45-309"><a href="#cb45-309" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span></span>
<span id="cb45-310"><a href="#cb45-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb45-311"><a href="#cb45-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-312"><a href="#cb45-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-313"><a href="#cb45-313" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 2</span></span>
<span id="cb45-314"><a href="#cb45-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-315"><a href="#cb45-315" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-316"><a href="#cb45-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Cleaning</span></span>
<span id="cb45-317"><a href="#cb45-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-318"><a href="#cb45-318" aria-hidden="true" tabindex="-1"></a>For nodes, the code <span class="in">`filter()`</span> will be used to filter out only *Person and Vessel* from *Entity*, and *Communication* from *Event* and their *relationship.*</span>
<span id="cb45-319"><a href="#cb45-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-320"><a href="#cb45-320" aria-hidden="true" tabindex="-1"></a>After this filter, the nodes only contain:</span>
<span id="cb45-321"><a href="#cb45-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-322"><a href="#cb45-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>entity nodes whose sub_type is Person or Vessel</span>
<span id="cb45-323"><a href="#cb45-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-324"><a href="#cb45-324" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Event nodes whose sub_type is Communication</span>
<span id="cb45-325"><a href="#cb45-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-326"><a href="#cb45-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Any node whose type is Relationship.</span>
<span id="cb45-327"><a href="#cb45-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-328"><a href="#cb45-328" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> adds a new column called idx to the filtered data frame</span>
<span id="cb45-329"><a href="#cb45-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-330"><a href="#cb45-330" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span> extracts 2 columns from *selected_nodes* and give them a new id and rename to *id_map*</span>
<span id="cb45-331"><a href="#cb45-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-332"><a href="#cb45-332" aria-hidden="true" tabindex="-1"></a>For Edges, <span class="in">`filter()`</span> keeps only those where both endpoints are in the *old* column of *id_map.*</span>
<span id="cb45-333"><a href="#cb45-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-334"><a href="#cb45-334" aria-hidden="true" tabindex="-1"></a><span class="in">`left_join()`</span> matches each row's *to* value against *id_map\$old* and brings in *id_map\$new* for that *to* node and renames it *to_new*. Same thing for the *from* column.</span>
<span id="cb45-335"><a href="#cb45-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-338"><a href="#cb45-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-339"><a href="#cb45-339" aria-hidden="true" tabindex="-1"></a>selected_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb45-340"><a href="#cb45-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb45-341"><a href="#cb45-341" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Entity"</span>     <span class="sc">&amp;</span> sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">|</span></span>
<span id="cb45-342"><a href="#cb45-342" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Event"</span>      <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span>)      <span class="sc">|</span></span>
<span id="cb45-343"><a href="#cb45-343" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Relationship"</span>)</span>
<span id="cb45-344"><a href="#cb45-344" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-345"><a href="#cb45-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idx =</span> <span class="fu">row_number</span>())</span>
<span id="cb45-346"><a href="#cb45-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-347"><a href="#cb45-347" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping old_index → new idx</span></span>
<span id="cb45-348"><a href="#cb45-348" aria-hidden="true" tabindex="-1"></a>id_map <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb45-349"><a href="#cb45-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">old =</span> new_index, <span class="at">new =</span> idx)</span>
<span id="cb45-350"><a href="#cb45-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-351"><a href="#cb45-351" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. filter edges so both ends are in selected_nodes</span></span>
<span id="cb45-352"><a href="#cb45-352" aria-hidden="true" tabindex="-1"></a>selected_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb45-353"><a href="#cb45-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> id_map<span class="sc">$</span>old, to <span class="sc">%in%</span> id_map<span class="sc">$</span>old) <span class="sc">%&gt;%</span></span>
<span id="cb45-354"><a href="#cb45-354" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-355"><a href="#cb45-355" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. re-index the endpoints</span></span>
<span id="cb45-356"><a href="#cb45-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-357"><a href="#cb45-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb45-358"><a href="#cb45-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span>   <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-359"><a href="#cb45-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new   =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb45-360"><a href="#cb45-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, type)</span>
<span id="cb45-361"><a href="#cb45-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-362"><a href="#cb45-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-363"><a href="#cb45-363" aria-hidden="true" tabindex="-1"></a><span class="fu">### People/Vessel Vs Relationship Subtypes</span></span>
<span id="cb45-364"><a href="#cb45-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-365"><a href="#cb45-365" aria-hidden="true" tabindex="-1"></a>Step 1: we proceed to <span class="in">`filter()`</span> only the edges that we want, specifically *sent, received and evidence_for*. The labels for the edges show "sent", "received" and "evidence_for" using <span class="in">`transmute()`</span>.</span>
<span id="cb45-366"><a href="#cb45-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-367"><a href="#cb45-367" aria-hidden="true" tabindex="-1"></a>Step 2: We then build the node table and colour by sub_type which is called *group*. The label for the names/vessels will be placed under the node using *label.*</span>
<span id="cb45-368"><a href="#cb45-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-369"><a href="#cb45-369" aria-hidden="true" tabindex="-1"></a>Step 3: Draw a Visnetwork graph.</span>
<span id="cb45-370"><a href="#cb45-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-373"><a href="#cb45-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-374"><a href="#cb45-374" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-375"><a href="#cb45-375" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)       <span class="co"># for pivot_longer()</span></span>
<span id="cb45-376"><a href="#cb45-376" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb45-377"><a href="#cb45-377" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb45-378"><a href="#cb45-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-379"><a href="#cb45-379" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Build sender/receiver pairs and their relationship nodes</span></span>
<span id="cb45-380"><a href="#cb45-380" aria-hidden="true" tabindex="-1"></a>send_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb45-381"><a href="#cb45-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-382"><a href="#cb45-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> from, <span class="at">comm =</span> to) <span class="sc">%&gt;%</span></span>
<span id="cb45-383"><a href="#cb45-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sender, comm)</span>
<span id="cb45-384"><a href="#cb45-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-385"><a href="#cb45-385" aria-hidden="true" tabindex="-1"></a>recv_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb45-386"><a href="#cb45-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-387"><a href="#cb45-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb45-388"><a href="#cb45-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(receiver, comm)</span>
<span id="cb45-389"><a href="#cb45-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-390"><a href="#cb45-390" aria-hidden="true" tabindex="-1"></a>rel_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb45-391"><a href="#cb45-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"evidence_for"</span>, <span class="st">"is_inferred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-392"><a href="#cb45-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rel =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb45-393"><a href="#cb45-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rel, comm)</span>
<span id="cb45-394"><a href="#cb45-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-395"><a href="#cb45-395" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Join to get each (sender, receiver, rel) for every communication event</span></span>
<span id="cb45-396"><a href="#cb45-396" aria-hidden="true" tabindex="-1"></a>triplets <span class="ot">&lt;-</span> send_pairs <span class="sc">%&gt;%</span></span>
<span id="cb45-397"><a href="#cb45-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(recv_pairs, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-398"><a href="#cb45-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(rel_edges, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-399"><a href="#cb45-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-400"><a href="#cb45-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">person1 =</span> <span class="fu">pmin</span>(sender, receiver),</span>
<span id="cb45-401"><a href="#cb45-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">person2 =</span> <span class="fu">pmax</span>(sender, receiver)</span>
<span id="cb45-402"><a href="#cb45-402" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-403"><a href="#cb45-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(person1, person2, rel, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-404"><a href="#cb45-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(person1, person2, rel)</span>
<span id="cb45-405"><a href="#cb45-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-406"><a href="#cb45-406" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Collect unique node‐IDs used (persons/vessels and relationship nodes)</span></span>
<span id="cb45-407"><a href="#cb45-407" aria-hidden="true" tabindex="-1"></a>node_ids_used <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(triplets<span class="sc">$</span>person1, triplets<span class="sc">$</span>person2, triplets<span class="sc">$</span>rel))</span>
<span id="cb45-408"><a href="#cb45-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-409"><a href="#cb45-409" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Build a lookup of node info for those IDs,</span></span>
<span id="cb45-410"><a href="#cb45-410" aria-hidden="true" tabindex="-1"></a><span class="co">#    but filter to only Person/Vessel entity subtypes and Relationship nodes</span></span>
<span id="cb45-411"><a href="#cb45-411" aria-hidden="true" tabindex="-1"></a>nodes_sub <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb45-412"><a href="#cb45-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(new_index <span class="sc">%in%</span> node_ids_used) <span class="sc">%&gt;%</span></span>
<span id="cb45-413"><a href="#cb45-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb45-414"><a href="#cb45-414" aria-hidden="true" tabindex="-1"></a>    sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>) <span class="sc">|</span></span>
<span id="cb45-415"><a href="#cb45-415" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"Relationship"</span></span>
<span id="cb45-416"><a href="#cb45-416" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-417"><a href="#cb45-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(new_index, label, sub_type, type)</span>
<span id="cb45-418"><a href="#cb45-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-419"><a href="#cb45-419" aria-hidden="true" tabindex="-1"></a><span class="co"># 4a. Define pleasing, non‐grey colors for entity subtypes</span></span>
<span id="cb45-420"><a href="#cb45-420" aria-hidden="true" tabindex="-1"></a>entity_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-421"><a href="#cb45-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>),</span>
<span id="cb45-422"><a href="#cb45-422" aria-hidden="true" tabindex="-1"></a>  <span class="at">color    =</span> <span class="fu">c</span>(<span class="st">"#2c7fb8"</span>, <span class="st">"#e6550d"</span>)  <span class="co"># blue for Person, orange for Vessel</span></span>
<span id="cb45-423"><a href="#cb45-423" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-424"><a href="#cb45-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-425"><a href="#cb45-425" aria-hidden="true" tabindex="-1"></a><span class="co"># 4b. Identify all relationship subtypes and assign distinct, visually pleasing colors</span></span>
<span id="cb45-426"><a href="#cb45-426" aria-hidden="true" tabindex="-1"></a>rel_subtypes <span class="ot">&lt;-</span> nodes_sub <span class="sc">%&gt;%</span></span>
<span id="cb45-427"><a href="#cb45-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Relationship"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-428"><a href="#cb45-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb45-429"><a href="#cb45-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb45-430"><a href="#cb45-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sub_type)</span>
<span id="cb45-431"><a href="#cb45-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-432"><a href="#cb45-432" aria-hidden="true" tabindex="-1"></a>n_rels <span class="ot">&lt;-</span> <span class="fu">length</span>(rel_subtypes)</span>
<span id="cb45-433"><a href="#cb45-433" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb45-434"><a href="#cb45-434" aria-hidden="true" tabindex="-1"></a>  base_palette <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">min</span>(n_rels, <span class="dv">8</span>), <span class="st">"Set2"</span>)</span>
<span id="cb45-435"><a href="#cb45-435" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="fu">length</span>(base_palette)) {</span>
<span id="cb45-436"><a href="#cb45-436" aria-hidden="true" tabindex="-1"></a>    rel_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(base_palette)(n_rels)</span>
<span id="cb45-437"><a href="#cb45-437" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb45-438"><a href="#cb45-438" aria-hidden="true" tabindex="-1"></a>    rel_colors <span class="ot">&lt;-</span> base_palette[<span class="dv">1</span><span class="sc">:</span>n_rels]</span>
<span id="cb45-439"><a href="#cb45-439" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-440"><a href="#cb45-440" aria-hidden="true" tabindex="-1"></a>  rel_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-441"><a href="#cb45-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub_type =</span> rel_subtypes,</span>
<span id="cb45-442"><a href="#cb45-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> rel_colors</span>
<span id="cb45-443"><a href="#cb45-443" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-444"><a href="#cb45-444" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb45-445"><a href="#cb45-445" aria-hidden="true" tabindex="-1"></a>  rel_color_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sub_type =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb45-446"><a href="#cb45-446" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-447"><a href="#cb45-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-448"><a href="#cb45-448" aria-hidden="true" tabindex="-1"></a><span class="co"># 4c. Combine entity and relationship color mappings</span></span>
<span id="cb45-449"><a href="#cb45-449" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(entity_color_map, rel_color_map)</span>
<span id="cb45-450"><a href="#cb45-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-451"><a href="#cb45-451" aria-hidden="true" tabindex="-1"></a><span class="co"># 4d. Build nodes_vis with assigned colors (no grey)</span></span>
<span id="cb45-452"><a href="#cb45-452" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> nodes_sub <span class="sc">%&gt;%</span></span>
<span id="cb45-453"><a href="#cb45-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(color_map, <span class="at">by =</span> <span class="st">"sub_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-454"><a href="#cb45-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb45-455"><a href="#cb45-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">id       =</span> new_index,</span>
<span id="cb45-456"><a href="#cb45-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">label    =</span> label,</span>
<span id="cb45-457"><a href="#cb45-457" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub_type =</span> sub_type,</span>
<span id="cb45-458"><a href="#cb45-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">color    =</span> color</span>
<span id="cb45-459"><a href="#cb45-459" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-460"><a href="#cb45-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-461"><a href="#cb45-461" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Build the visNetwork 'edges' data frame</span></span>
<span id="cb45-462"><a href="#cb45-462" aria-hidden="true" tabindex="-1"></a><span class="co"># 5a. Edges between the two people/vessels (no label)</span></span>
<span id="cb45-463"><a href="#cb45-463" aria-hidden="true" tabindex="-1"></a>edges_comm_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb45-464"><a href="#cb45-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb45-465"><a href="#cb45-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person1,</span>
<span id="cb45-466"><a href="#cb45-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> person2,</span>
<span id="cb45-467"><a href="#cb45-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">""</span>,     <span class="co"># no “comm” text</span></span>
<span id="cb45-468"><a href="#cb45-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">2</span>,</span>
<span id="cb45-469"><a href="#cb45-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb45-470"><a href="#cb45-470" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-471"><a href="#cb45-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-472"><a href="#cb45-472" aria-hidden="true" tabindex="-1"></a><span class="co"># 5b. For each triplet, connect both persons to the relationship node (no label)</span></span>
<span id="cb45-473"><a href="#cb45-473" aria-hidden="true" tabindex="-1"></a>edges_rel_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb45-474"><a href="#cb45-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb45-475"><a href="#cb45-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="fu">c</span>(person1, person2),</span>
<span id="cb45-476"><a href="#cb45-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="cn">NULL</span>,</span>
<span id="cb45-477"><a href="#cb45-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"person"</span></span>
<span id="cb45-478"><a href="#cb45-478" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-479"><a href="#cb45-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb45-480"><a href="#cb45-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person,</span>
<span id="cb45-481"><a href="#cb45-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> rel,</span>
<span id="cb45-482"><a href="#cb45-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">""</span>,    <span class="co"># no text here</span></span>
<span id="cb45-483"><a href="#cb45-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">1</span>,</span>
<span id="cb45-484"><a href="#cb45-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb45-485"><a href="#cb45-485" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-486"><a href="#cb45-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-487"><a href="#cb45-487" aria-hidden="true" tabindex="-1"></a><span class="co"># 5c. Combine both sets of edges</span></span>
<span id="cb45-488"><a href="#cb45-488" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(edges_comm_vis, edges_rel_vis)</span>
<span id="cb45-489"><a href="#cb45-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-490"><a href="#cb45-490" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Draw the visNetwork with a dropdown filter by sub_type.</span></span>
<span id="cb45-491"><a href="#cb45-491" aria-hidden="true" tabindex="-1"></a><span class="co">#    Legend shows only subtypes in the graph, in oval shape, larger, and using our custom colors.</span></span>
<span id="cb45-492"><a href="#cb45-492" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis) <span class="sc">%&gt;%</span></span>
<span id="cb45-493"><a href="#cb45-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb45-494"><a href="#cb45-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidth         =</span> <span class="dv">1</span>,</span>
<span id="cb45-495"><a href="#cb45-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidthSelected =</span> <span class="dv">2</span></span>
<span id="cb45-496"><a href="#cb45-496" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-497"><a href="#cb45-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb45-498"><a href="#cb45-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb45-499"><a href="#cb45-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),  <span class="co"># dark edge color</span></span>
<span id="cb45-500"><a href="#cb45-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb45-501"><a href="#cb45-501" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-502"><a href="#cb45-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb45-503"><a href="#cb45-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-504"><a href="#cb45-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-505"><a href="#cb45-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="st">"sub_type"</span></span>
<span id="cb45-506"><a href="#cb45-506" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-507"><a href="#cb45-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb45-508"><a href="#cb45-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-509"><a href="#cb45-509" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> color_map<span class="sc">$</span>sub_type,</span>
<span id="cb45-510"><a href="#cb45-510" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb45-511"><a href="#cb45-511" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> color_map<span class="sc">$</span>color,</span>
<span id="cb45-512"><a href="#cb45-512" aria-hidden="true" tabindex="-1"></a>      <span class="at">size  =</span> <span class="fu">rep</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(color_map))</span>
<span id="cb45-513"><a href="#cb45-513" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-514"><a href="#cb45-514" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb45-515"><a href="#cb45-515" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-516"><a href="#cb45-516" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-517"><a href="#cb45-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-518"><a href="#cb45-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-519"><a href="#cb45-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-520"><a href="#cb45-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### People vs Relationship Subtype</span></span>
<span id="cb45-521"><a href="#cb45-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-524"><a href="#cb45-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-525"><a href="#cb45-525" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Exclude all “Vessel” nodes and any edges involving them</span></span>
<span id="cb45-526"><a href="#cb45-526" aria-hidden="true" tabindex="-1"></a>nodes_vis2 <span class="ot">&lt;-</span> nodes_vis <span class="sc">%&gt;%</span></span>
<span id="cb45-527"><a href="#cb45-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">!=</span> <span class="st">"Vessel"</span>)</span>
<span id="cb45-528"><a href="#cb45-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-529"><a href="#cb45-529" aria-hidden="true" tabindex="-1"></a>edges_vis2 <span class="ot">&lt;-</span> edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb45-530"><a href="#cb45-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes_vis2<span class="sc">$</span>id, to <span class="sc">%in%</span> nodes_vis2<span class="sc">$</span>id)</span>
<span id="cb45-531"><a href="#cb45-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-532"><a href="#cb45-532" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Build a reduced legend data.frame for the remaining subtypes</span></span>
<span id="cb45-533"><a href="#cb45-533" aria-hidden="true" tabindex="-1"></a>legend_map2 <span class="ot">&lt;-</span> color_map <span class="sc">%&gt;%</span></span>
<span id="cb45-534"><a href="#cb45-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">unique</span>(nodes_vis2<span class="sc">$</span>sub_type))</span>
<span id="cb45-535"><a href="#cb45-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-536"><a href="#cb45-536" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Draw the new visNetwork without Vessel nodes</span></span>
<span id="cb45-537"><a href="#cb45-537" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis2, edges_vis2) <span class="sc">%&gt;%</span></span>
<span id="cb45-538"><a href="#cb45-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb45-539"><a href="#cb45-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidth         =</span> <span class="dv">1</span>,</span>
<span id="cb45-540"><a href="#cb45-540" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidthSelected =</span> <span class="dv">2</span></span>
<span id="cb45-541"><a href="#cb45-541" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-542"><a href="#cb45-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb45-543"><a href="#cb45-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb45-544"><a href="#cb45-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#333333"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb45-545"><a href="#cb45-545" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb45-546"><a href="#cb45-546" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-547"><a href="#cb45-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb45-548"><a href="#cb45-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-549"><a href="#cb45-549" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-550"><a href="#cb45-550" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="st">"sub_type"</span></span>
<span id="cb45-551"><a href="#cb45-551" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-552"><a href="#cb45-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb45-553"><a href="#cb45-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-554"><a href="#cb45-554" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> legend_map2<span class="sc">$</span>sub_type,</span>
<span id="cb45-555"><a href="#cb45-555" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"ellipse"</span>,</span>
<span id="cb45-556"><a href="#cb45-556" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> legend_map2<span class="sc">$</span>color,</span>
<span id="cb45-557"><a href="#cb45-557" aria-hidden="true" tabindex="-1"></a>      <span class="at">size  =</span> <span class="fu">rep</span>(<span class="dv">20</span>, <span class="fu">nrow</span>(legend_map2))</span>
<span id="cb45-558"><a href="#cb45-558" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-559"><a href="#cb45-559" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb45-560"><a href="#cb45-560" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-561"><a href="#cb45-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-562"><a href="#cb45-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-563"><a href="#cb45-563" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-564"><a href="#cb45-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-565"><a href="#cb45-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Q2 Part A</span></span>
<span id="cb45-566"><a href="#cb45-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-567"><a href="#cb45-567" aria-hidden="true" tabindex="-1"></a>By selecting the different sub-groups from the drop-down below, we can conclude the following information.</span>
<span id="cb45-568"><a href="#cb45-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-569"><a href="#cb45-569" aria-hidden="true" tabindex="-1"></a>**Colleagues:**</span>
<span id="cb45-570"><a href="#cb45-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-571"><a href="#cb45-571" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss, Mrs Money and The Middleman</span>
<span id="cb45-572"><a href="#cb45-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-573"><a href="#cb45-573" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss, The Accountant and The Middleman</span>
<span id="cb45-574"><a href="#cb45-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-575"><a href="#cb45-575" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Lookout, The Intern and Mrs Money</span>
<span id="cb45-576"><a href="#cb45-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-577"><a href="#cb45-577" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mrs Money and The Intern</span>
<span id="cb45-578"><a href="#cb45-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-579"><a href="#cb45-579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss and Mrs Money</span>
<span id="cb45-580"><a href="#cb45-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-581"><a href="#cb45-581" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss and Rodriguez</span>
<span id="cb45-582"><a href="#cb45-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-583"><a href="#cb45-583" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Small Fry and Davis</span>
<span id="cb45-584"><a href="#cb45-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-585"><a href="#cb45-585" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nadia Conti and Davis</span>
<span id="cb45-586"><a href="#cb45-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-587"><a href="#cb45-587" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nadia Conti and Elise</span>
<span id="cb45-588"><a href="#cb45-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-589"><a href="#cb45-589" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nadia Conti and Liam Thorne</span>
<span id="cb45-590"><a href="#cb45-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-591"><a href="#cb45-591" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sam and Kelly</span>
<span id="cb45-592"><a href="#cb45-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-593"><a href="#cb45-593" aria-hidden="true" tabindex="-1"></a>**Friends:**</span>
<span id="cb45-594"><a href="#cb45-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-595"><a href="#cb45-595" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sam and Kelly</span>
<span id="cb45-596"><a href="#cb45-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-597"><a href="#cb45-597" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Intern and The Lookout</span>
<span id="cb45-598"><a href="#cb45-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-599"><a href="#cb45-599" aria-hidden="true" tabindex="-1"></a>**Unfriendly:**</span>
<span id="cb45-600"><a href="#cb45-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-601"><a href="#cb45-601" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Elise and Nadia Conti</span>
<span id="cb45-602"><a href="#cb45-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-603"><a href="#cb45-603" aria-hidden="true" tabindex="-1"></a>**Suspicious:**</span>
<span id="cb45-604"><a href="#cb45-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-605"><a href="#cb45-605" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss, Mrs Money, The Intern, The Lookout, The Accountant</span>
<span id="cb45-606"><a href="#cb45-606" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sam, Kelly, Liam Thorne, Elise, Nadia Conti, Davis</span>
<span id="cb45-607"><a href="#cb45-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-608"><a href="#cb45-608" aria-hidden="true" tabindex="-1"></a>From the above results, it can be seen that either Sam or Kelly holds the status of The Intern and The Lookout as they are the only ones with the relationship of friends in the conclusion above.</span>
<span id="cb45-609"><a href="#cb45-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-610"><a href="#cb45-610" aria-hidden="true" tabindex="-1"></a>Boss seems to be the one with the most information and power as Mrs Money, The Accountant and The Middlman transmit information to The Boss only</span>
<span id="cb45-611"><a href="#cb45-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-612"><a href="#cb45-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2 Part B</span></span>
<span id="cb45-613"><a href="#cb45-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-614"><a href="#cb45-614" aria-hidden="true" tabindex="-1"></a>Based on the question 2b, I have categorised them into the 3 different Entity Subgroups: Person, Organisation and Vessel</span>
<span id="cb45-615"><a href="#cb45-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-616"><a href="#cb45-616" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-617"><a href="#cb45-617" aria-hidden="true" tabindex="-1"></a><span class="fu">### Group by organisation</span></span>
<span id="cb45-618"><a href="#cb45-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-619"><a href="#cb45-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, fig.width=10, fig.height=5}</span></span>
<span id="cb45-620"><a href="#cb45-620" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb45-621"><a href="#cb45-621" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidytext)</span></span>
<span id="cb45-622"><a href="#cb45-622" aria-hidden="true" tabindex="-1"></a><span class="in">library(wordcloud)</span></span>
<span id="cb45-623"><a href="#cb45-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-624"><a href="#cb45-624" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb45-625"><a href="#cb45-625" aria-hidden="true" tabindex="-1"></a><span class="in">comm_nodes &lt;- mc3_nodes_final %&gt;%</span></span>
<span id="cb45-626"><a href="#cb45-626" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Event", sub_type == "Communication") %&gt;%</span></span>
<span id="cb45-627"><a href="#cb45-627" aria-hidden="true" tabindex="-1"></a><span class="in">  select(event_index = new_index, content)</span></span>
<span id="cb45-628"><a href="#cb45-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-629"><a href="#cb45-629" aria-hidden="true" tabindex="-1"></a><span class="in"># 2. Build a mapping from communication events to entities (Organization subtype)</span></span>
<span id="cb45-630"><a href="#cb45-630" aria-hidden="true" tabindex="-1"></a><span class="in">send_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-631"><a href="#cb45-631" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "sent") %&gt;%</span></span>
<span id="cb45-632"><a href="#cb45-632" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(entity_index = from, event_index = to)</span></span>
<span id="cb45-633"><a href="#cb45-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-634"><a href="#cb45-634" aria-hidden="true" tabindex="-1"></a><span class="in">recv_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-635"><a href="#cb45-635" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "received") %&gt;%</span></span>
<span id="cb45-636"><a href="#cb45-636" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(event_index = from, entity_index = to)</span></span>
<span id="cb45-637"><a href="#cb45-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-638"><a href="#cb45-638" aria-hidden="true" tabindex="-1"></a><span class="in">event_to_entity &lt;- bind_rows(send_map, recv_map)</span></span>
<span id="cb45-639"><a href="#cb45-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-640"><a href="#cb45-640" aria-hidden="true" tabindex="-1"></a><span class="in"># 3. Join event_to_entity with comm_nodes, then keep only Organization entities</span></span>
<span id="cb45-641"><a href="#cb45-641" aria-hidden="true" tabindex="-1"></a><span class="in">comm_by_entity &lt;- event_to_entity %&gt;%</span></span>
<span id="cb45-642"><a href="#cb45-642" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(comm_nodes, by = "event_index") %&gt;%</span></span>
<span id="cb45-643"><a href="#cb45-643" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(</span></span>
<span id="cb45-644"><a href="#cb45-644" aria-hidden="true" tabindex="-1"></a><span class="in">    mc3_nodes_final %&gt;% </span></span>
<span id="cb45-645"><a href="#cb45-645" aria-hidden="true" tabindex="-1"></a><span class="in">      select(entity_index = new_index, sub_type, label),</span></span>
<span id="cb45-646"><a href="#cb45-646" aria-hidden="true" tabindex="-1"></a><span class="in">    by = "entity_index"</span></span>
<span id="cb45-647"><a href="#cb45-647" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb45-648"><a href="#cb45-648" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(sub_type == "Organization") %&gt;%</span></span>
<span id="cb45-649"><a href="#cb45-649" aria-hidden="true" tabindex="-1"></a><span class="in">  select(organization = label, content)</span></span>
<span id="cb45-650"><a href="#cb45-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-651"><a href="#cb45-651" aria-hidden="true" tabindex="-1"></a><span class="in"># 4. Collapse all texts per organization</span></span>
<span id="cb45-652"><a href="#cb45-652" aria-hidden="true" tabindex="-1"></a><span class="in">org_texts &lt;- comm_by_entity %&gt;%</span></span>
<span id="cb45-653"><a href="#cb45-653" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(organization) %&gt;%</span></span>
<span id="cb45-654"><a href="#cb45-654" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(text = paste(content, collapse = " "), .groups = "drop")</span></span>
<span id="cb45-655"><a href="#cb45-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-656"><a href="#cb45-656" aria-hidden="true" tabindex="-1"></a><span class="in"># 5. Tokenize, remove stop‐words, and compute word frequencies per organization</span></span>
<span id="cb45-657"><a href="#cb45-657" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_org_words &lt;- org_texts %&gt;%</span></span>
<span id="cb45-658"><a href="#cb45-658" aria-hidden="true" tabindex="-1"></a><span class="in">  unnest_tokens(word, text) %&gt;%</span></span>
<span id="cb45-659"><a href="#cb45-659" aria-hidden="true" tabindex="-1"></a><span class="in">  anti_join(stop_words, by = "word") %&gt;%</span></span>
<span id="cb45-660"><a href="#cb45-660" aria-hidden="true" tabindex="-1"></a><span class="in">  count(organization, word, sort = TRUE)</span></span>
<span id="cb45-661"><a href="#cb45-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-662"><a href="#cb45-662" aria-hidden="true" tabindex="-1"></a><span class="in"># 6. Plot one word cloud per organization</span></span>
<span id="cb45-663"><a href="#cb45-663" aria-hidden="true" tabindex="-1"></a><span class="in">org_list &lt;- unique(tidy_org_words$organization)</span></span>
<span id="cb45-664"><a href="#cb45-664" aria-hidden="true" tabindex="-1"></a><span class="in">n_orgs   &lt;- length(org_list)</span></span>
<span id="cb45-665"><a href="#cb45-665" aria-hidden="true" tabindex="-1"></a><span class="in">n_cols   &lt;- 3</span></span>
<span id="cb45-666"><a href="#cb45-666" aria-hidden="true" tabindex="-1"></a><span class="in">n_rows   &lt;- ceiling(n_orgs / n_cols)</span></span>
<span id="cb45-667"><a href="#cb45-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-668"><a href="#cb45-668" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(n_rows, n_cols), mar = c(0, 0, 0, 0))</span></span>
<span id="cb45-669"><a href="#cb45-669" aria-hidden="true" tabindex="-1"></a><span class="in">for (org in org_list) {</span></span>
<span id="cb45-670"><a href="#cb45-670" aria-hidden="true" tabindex="-1"></a><span class="in">  freq_tbl &lt;- tidy_org_words %&gt;% filter(organization == org)</span></span>
<span id="cb45-671"><a href="#cb45-671" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(freq_tbl) == 0) {</span></span>
<span id="cb45-672"><a href="#cb45-672" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.new()</span></span>
<span id="cb45-673"><a href="#cb45-673" aria-hidden="true" tabindex="-1"></a><span class="in">    title(main = org)</span></span>
<span id="cb45-674"><a href="#cb45-674" aria-hidden="true" tabindex="-1"></a><span class="in">    next</span></span>
<span id="cb45-675"><a href="#cb45-675" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb45-676"><a href="#cb45-676" aria-hidden="true" tabindex="-1"></a><span class="in">  v &lt;- setNames(freq_tbl$n, freq_tbl$word)</span></span>
<span id="cb45-677"><a href="#cb45-677" aria-hidden="true" tabindex="-1"></a><span class="in">  wordcloud(</span></span>
<span id="cb45-678"><a href="#cb45-678" aria-hidden="true" tabindex="-1"></a><span class="in">    words        = names(v),</span></span>
<span id="cb45-679"><a href="#cb45-679" aria-hidden="true" tabindex="-1"></a><span class="in">    freq         = as.numeric(v),</span></span>
<span id="cb45-680"><a href="#cb45-680" aria-hidden="true" tabindex="-1"></a><span class="in">    max.words    = 20,</span></span>
<span id="cb45-681"><a href="#cb45-681" aria-hidden="true" tabindex="-1"></a><span class="in">    scale        = c(3, 0.5),</span></span>
<span id="cb45-682"><a href="#cb45-682" aria-hidden="true" tabindex="-1"></a><span class="in">    random.order = FALSE</span></span>
<span id="cb45-683"><a href="#cb45-683" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb45-684"><a href="#cb45-684" aria-hidden="true" tabindex="-1"></a><span class="in">  title(main = org, line = -1)</span></span>
<span id="cb45-685"><a href="#cb45-685" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb45-686"><a href="#cb45-686" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1))</span></span>
<span id="cb45-687"><a href="#cb45-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-688"><a href="#cb45-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-689"><a href="#cb45-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-690"><a href="#cb45-690" aria-hidden="true" tabindex="-1"></a>For Organisation: It can be seen that Team Glitters does not have any pre-dominant topic area.</span>
<span id="cb45-691"><a href="#cb45-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-692"><a href="#cb45-692" aria-hidden="true" tabindex="-1"></a>Oceanus City Council, Sailor Shift Team and Green Guardians seems to have common words like nemo, city, reef ,equipment and vessel, showing that they are more concerned about the environment.</span>
<span id="cb45-693"><a href="#cb45-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-694"><a href="#cb45-694" aria-hidden="true" tabindex="-1"></a>V. Miesel Shipping however, is more concerned about regulations as the most commonly used words are permit, operations and documentation.</span>
<span id="cb45-695"><a href="#cb45-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-696"><a href="#cb45-696" aria-hidden="true" tabindex="-1"></a><span class="fu">### Group by Person</span></span>
<span id="cb45-697"><a href="#cb45-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-698"><a href="#cb45-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, fig.width=14, fig.height=14}</span></span>
<span id="cb45-699"><a href="#cb45-699" aria-hidden="true" tabindex="-1"></a><span class="in"># (Assuming you already have mc3_nodes_final and mc3_edges_final loaded)</span></span>
<span id="cb45-700"><a href="#cb45-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-701"><a href="#cb45-701" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb45-702"><a href="#cb45-702" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidytext)</span></span>
<span id="cb45-703"><a href="#cb45-703" aria-hidden="true" tabindex="-1"></a><span class="in">library(wordcloud)</span></span>
<span id="cb45-704"><a href="#cb45-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-705"><a href="#cb45-705" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb45-706"><a href="#cb45-706" aria-hidden="true" tabindex="-1"></a><span class="in">comm_nodes &lt;- mc3_nodes_final %&gt;%</span></span>
<span id="cb45-707"><a href="#cb45-707" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Event", sub_type == "Communication") %&gt;%</span></span>
<span id="cb45-708"><a href="#cb45-708" aria-hidden="true" tabindex="-1"></a><span class="in">  select(event_index = new_index, content)</span></span>
<span id="cb45-709"><a href="#cb45-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-710"><a href="#cb45-710" aria-hidden="true" tabindex="-1"></a><span class="in"># 2. Build a mapping from communication events to entities</span></span>
<span id="cb45-711"><a href="#cb45-711" aria-hidden="true" tabindex="-1"></a><span class="in">send_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-712"><a href="#cb45-712" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "sent") %&gt;%</span></span>
<span id="cb45-713"><a href="#cb45-713" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(entity_index = from, event_index = to)</span></span>
<span id="cb45-714"><a href="#cb45-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-715"><a href="#cb45-715" aria-hidden="true" tabindex="-1"></a><span class="in">recv_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-716"><a href="#cb45-716" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "received") %&gt;%</span></span>
<span id="cb45-717"><a href="#cb45-717" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(event_index = from, entity_index = to)</span></span>
<span id="cb45-718"><a href="#cb45-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-719"><a href="#cb45-719" aria-hidden="true" tabindex="-1"></a><span class="in">event_to_entity &lt;- bind_rows(send_map, recv_map)</span></span>
<span id="cb45-720"><a href="#cb45-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-721"><a href="#cb45-721" aria-hidden="true" tabindex="-1"></a><span class="in"># 3. Join event_to_entity with comm_nodes, then keep only Person entities</span></span>
<span id="cb45-722"><a href="#cb45-722" aria-hidden="true" tabindex="-1"></a><span class="in">comm_by_person &lt;- event_to_entity %&gt;%</span></span>
<span id="cb45-723"><a href="#cb45-723" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(comm_nodes, by = "event_index") %&gt;%</span></span>
<span id="cb45-724"><a href="#cb45-724" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(</span></span>
<span id="cb45-725"><a href="#cb45-725" aria-hidden="true" tabindex="-1"></a><span class="in">    mc3_nodes_final %&gt;% </span></span>
<span id="cb45-726"><a href="#cb45-726" aria-hidden="true" tabindex="-1"></a><span class="in">      select(entity_index = new_index, sub_type, label),</span></span>
<span id="cb45-727"><a href="#cb45-727" aria-hidden="true" tabindex="-1"></a><span class="in">    by = "entity_index"</span></span>
<span id="cb45-728"><a href="#cb45-728" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb45-729"><a href="#cb45-729" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(sub_type == "Person") %&gt;%</span></span>
<span id="cb45-730"><a href="#cb45-730" aria-hidden="true" tabindex="-1"></a><span class="in">  select(person = label, content)</span></span>
<span id="cb45-731"><a href="#cb45-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-732"><a href="#cb45-732" aria-hidden="true" tabindex="-1"></a><span class="in"># 4. Collapse all texts per person</span></span>
<span id="cb45-733"><a href="#cb45-733" aria-hidden="true" tabindex="-1"></a><span class="in">person_texts &lt;- comm_by_person %&gt;%</span></span>
<span id="cb45-734"><a href="#cb45-734" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(person) %&gt;%</span></span>
<span id="cb45-735"><a href="#cb45-735" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(text = paste(content, collapse = " "), .groups = "drop")</span></span>
<span id="cb45-736"><a href="#cb45-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-737"><a href="#cb45-737" aria-hidden="true" tabindex="-1"></a><span class="in"># 5. Tokenize, remove stop‐words, and compute word frequencies per person</span></span>
<span id="cb45-738"><a href="#cb45-738" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_person_words &lt;- person_texts %&gt;%</span></span>
<span id="cb45-739"><a href="#cb45-739" aria-hidden="true" tabindex="-1"></a><span class="in">  unnest_tokens(word, text) %&gt;%</span></span>
<span id="cb45-740"><a href="#cb45-740" aria-hidden="true" tabindex="-1"></a><span class="in">  anti_join(stop_words, by = "word") %&gt;%</span></span>
<span id="cb45-741"><a href="#cb45-741" aria-hidden="true" tabindex="-1"></a><span class="in">  count(person, word, sort = TRUE)</span></span>
<span id="cb45-742"><a href="#cb45-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-743"><a href="#cb45-743" aria-hidden="true" tabindex="-1"></a><span class="in"># 6. Plot one word cloud per person</span></span>
<span id="cb45-744"><a href="#cb45-744" aria-hidden="true" tabindex="-1"></a><span class="in">person_list &lt;- unique(tidy_person_words$person)</span></span>
<span id="cb45-745"><a href="#cb45-745" aria-hidden="true" tabindex="-1"></a><span class="in">n_persons   &lt;- length(person_list)</span></span>
<span id="cb45-746"><a href="#cb45-746" aria-hidden="true" tabindex="-1"></a><span class="in">n_cols      &lt;- 4</span></span>
<span id="cb45-747"><a href="#cb45-747" aria-hidden="true" tabindex="-1"></a><span class="in">n_rows      &lt;- ceiling(n_persons / n_cols)</span></span>
<span id="cb45-748"><a href="#cb45-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-749"><a href="#cb45-749" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(n_rows, n_cols), mar = c(0, 0, 0, 0))</span></span>
<span id="cb45-750"><a href="#cb45-750" aria-hidden="true" tabindex="-1"></a><span class="in">for (p in person_list) {</span></span>
<span id="cb45-751"><a href="#cb45-751" aria-hidden="true" tabindex="-1"></a><span class="in">  freq_tbl &lt;- tidy_person_words %&gt;% filter(person == p)</span></span>
<span id="cb45-752"><a href="#cb45-752" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(freq_tbl) == 0) {</span></span>
<span id="cb45-753"><a href="#cb45-753" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.new()</span></span>
<span id="cb45-754"><a href="#cb45-754" aria-hidden="true" tabindex="-1"></a><span class="in">    title(main = p)</span></span>
<span id="cb45-755"><a href="#cb45-755" aria-hidden="true" tabindex="-1"></a><span class="in">    next</span></span>
<span id="cb45-756"><a href="#cb45-756" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb45-757"><a href="#cb45-757" aria-hidden="true" tabindex="-1"></a><span class="in">  v &lt;- setNames(freq_tbl$n, freq_tbl$word)</span></span>
<span id="cb45-758"><a href="#cb45-758" aria-hidden="true" tabindex="-1"></a><span class="in">  wordcloud(</span></span>
<span id="cb45-759"><a href="#cb45-759" aria-hidden="true" tabindex="-1"></a><span class="in">    words        = names(v),</span></span>
<span id="cb45-760"><a href="#cb45-760" aria-hidden="true" tabindex="-1"></a><span class="in">    freq         = as.numeric(v),</span></span>
<span id="cb45-761"><a href="#cb45-761" aria-hidden="true" tabindex="-1"></a><span class="in">    max.words    = 10,</span></span>
<span id="cb45-762"><a href="#cb45-762" aria-hidden="true" tabindex="-1"></a><span class="in">    scale        = c(3, 0.5),</span></span>
<span id="cb45-763"><a href="#cb45-763" aria-hidden="true" tabindex="-1"></a><span class="in">    random.order = FALSE</span></span>
<span id="cb45-764"><a href="#cb45-764" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb45-765"><a href="#cb45-765" aria-hidden="true" tabindex="-1"></a><span class="in">  title(main = p, line = -1)</span></span>
<span id="cb45-766"><a href="#cb45-766" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb45-767"><a href="#cb45-767" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1))</span></span>
<span id="cb45-768"><a href="#cb45-768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-769"><a href="#cb45-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-770"><a href="#cb45-770" aria-hidden="true" tabindex="-1"></a>**For Person Subgroups:**</span>
<span id="cb45-771"><a href="#cb45-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-772"><a href="#cb45-772" aria-hidden="true" tabindex="-1"></a>**Top 3 Commonly Used Words:**</span>
<span id="cb45-773"><a href="#cb45-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-774"><a href="#cb45-774" aria-hidden="true" tabindex="-1"></a>Mrs Money: Meeting, Nemo Reef, Intern</span>
<span id="cb45-775"><a href="#cb45-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-776"><a href="#cb45-776" aria-hidden="true" tabindex="-1"></a>The Intern: Nemo Reef, Lookout, Money</span>
<span id="cb45-777"><a href="#cb45-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-778"><a href="#cb45-778" aria-hidden="true" tabindex="-1"></a>The Lookout: Nemo Reef, Intern, tomorrow</span>
<span id="cb45-779"><a href="#cb45-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-780"><a href="#cb45-780" aria-hidden="true" tabindex="-1"></a>Boss: Nemo Reef, meeting, middleman</span>
<span id="cb45-781"><a href="#cb45-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-782"><a href="#cb45-782" aria-hidden="true" tabindex="-1"></a>The Middleman: Nemo reef, boss, meeting</span>
<span id="cb45-783"><a href="#cb45-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-784"><a href="#cb45-784" aria-hidden="true" tabindex="-1"></a>The Accountant: meeting, middleman, boss</span>
<span id="cb45-785"><a href="#cb45-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-786"><a href="#cb45-786" aria-hidden="true" tabindex="-1"></a>**It can be seen that these 6 people are in contact with each other as their most commonly used terms concern each other and usually revolves around Nemo Reef.**</span>
<span id="cb45-787"><a href="#cb45-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-788"><a href="#cb45-788" aria-hidden="true" tabindex="-1"></a>Liam Thorne: Nemo Reef, council, report</span>
<span id="cb45-789"><a href="#cb45-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-790"><a href="#cb45-790" aria-hidden="true" tabindex="-1"></a>Nadia Conti: Nemo Reef, documentation, meeting</span>
<span id="cb45-791"><a href="#cb45-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-792"><a href="#cb45-792" aria-hidden="true" tabindex="-1"></a>Rodriguez: Nemo reef, davis, remora</span>
<span id="cb45-793"><a href="#cb45-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-794"><a href="#cb45-794" aria-hidden="true" tabindex="-1"></a>Samantha Blake: Nemo Reef, tomorrow, city council</span>
<span id="cb45-795"><a href="#cb45-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-796"><a href="#cb45-796" aria-hidden="true" tabindex="-1"></a>Elise: Nemo Reef, tomorrow, meeting</span>
<span id="cb45-797"><a href="#cb45-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-798"><a href="#cb45-798" aria-hidden="true" tabindex="-1"></a>**It can also be seen that these group of people have common schedules like meeting, tomorrow and City Council, and they are also concerned about Nemo Reef.**</span>
<span id="cb45-799"><a href="#cb45-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-800"><a href="#cb45-800" aria-hidden="true" tabindex="-1"></a>Clepper Jensen: Miranda, equipment, environmental</span>
<span id="cb45-801"><a href="#cb45-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-802"><a href="#cb45-802" aria-hidden="true" tabindex="-1"></a>Miranda Jordan: Miranda, equipment, clepper Jensen</span>
<span id="cb45-803"><a href="#cb45-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-804"><a href="#cb45-804" aria-hidden="true" tabindex="-1"></a>Davis: Mako, security, equipment</span>
<span id="cb45-805"><a href="#cb45-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-806"><a href="#cb45-806" aria-hidden="true" tabindex="-1"></a>Sam: birdwatching, lookout, reef</span>
<span id="cb45-807"><a href="#cb45-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-808"><a href="#cb45-808" aria-hidden="true" tabindex="-1"></a>Mako: try, team, remora</span>
<span id="cb45-809"><a href="#cb45-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-810"><a href="#cb45-810" aria-hidden="true" tabindex="-1"></a>Kelly: sam, kelly</span>
<span id="cb45-811"><a href="#cb45-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-812"><a href="#cb45-812" aria-hidden="true" tabindex="-1"></a>**These group of people here have different focus and do not have commonailities with the groups above.**</span>
<span id="cb45-813"><a href="#cb45-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-814"><a href="#cb45-814" aria-hidden="true" tabindex="-1"></a><span class="fu">### Group by Vessels</span></span>
<span id="cb45-815"><a href="#cb45-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-816"><a href="#cb45-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, fig.width=14, fig.height=10}</span></span>
<span id="cb45-817"><a href="#cb45-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-818"><a href="#cb45-818" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb45-819"><a href="#cb45-819" aria-hidden="true" tabindex="-1"></a><span class="in">comm_nodes &lt;- mc3_nodes_final %&gt;%</span></span>
<span id="cb45-820"><a href="#cb45-820" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Event", sub_type == "Communication") %&gt;%</span></span>
<span id="cb45-821"><a href="#cb45-821" aria-hidden="true" tabindex="-1"></a><span class="in">  select(event_index = new_index, content)</span></span>
<span id="cb45-822"><a href="#cb45-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-823"><a href="#cb45-823" aria-hidden="true" tabindex="-1"></a><span class="in"># 2. Build a mapping from communication events to entities (sender/receiver)</span></span>
<span id="cb45-824"><a href="#cb45-824" aria-hidden="true" tabindex="-1"></a><span class="in">send_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-825"><a href="#cb45-825" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "sent") %&gt;%</span></span>
<span id="cb45-826"><a href="#cb45-826" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(entity_index = from, event_index = to)</span></span>
<span id="cb45-827"><a href="#cb45-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-828"><a href="#cb45-828" aria-hidden="true" tabindex="-1"></a><span class="in">recv_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb45-829"><a href="#cb45-829" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "received") %&gt;%</span></span>
<span id="cb45-830"><a href="#cb45-830" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(event_index = from, entity_index = to)</span></span>
<span id="cb45-831"><a href="#cb45-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-832"><a href="#cb45-832" aria-hidden="true" tabindex="-1"></a><span class="in">event_to_entity &lt;- bind_rows(send_map, recv_map)</span></span>
<span id="cb45-833"><a href="#cb45-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-834"><a href="#cb45-834" aria-hidden="true" tabindex="-1"></a><span class="in"># 3. Join event_to_entity with comm_nodes, then keep only Vessel entities</span></span>
<span id="cb45-835"><a href="#cb45-835" aria-hidden="true" tabindex="-1"></a><span class="in">comm_by_vessel &lt;- event_to_entity %&gt;%</span></span>
<span id="cb45-836"><a href="#cb45-836" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(comm_nodes, by = "event_index") %&gt;%</span></span>
<span id="cb45-837"><a href="#cb45-837" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(</span></span>
<span id="cb45-838"><a href="#cb45-838" aria-hidden="true" tabindex="-1"></a><span class="in">    mc3_nodes_final %&gt;%</span></span>
<span id="cb45-839"><a href="#cb45-839" aria-hidden="true" tabindex="-1"></a><span class="in">      select(entity_index = new_index, sub_type, label),</span></span>
<span id="cb45-840"><a href="#cb45-840" aria-hidden="true" tabindex="-1"></a><span class="in">    by = "entity_index"</span></span>
<span id="cb45-841"><a href="#cb45-841" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb45-842"><a href="#cb45-842" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(sub_type == "Vessel") %&gt;%      # &lt;— change here</span></span>
<span id="cb45-843"><a href="#cb45-843" aria-hidden="true" tabindex="-1"></a><span class="in">  select(vessel = label, content)</span></span>
<span id="cb45-844"><a href="#cb45-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-845"><a href="#cb45-845" aria-hidden="true" tabindex="-1"></a><span class="in"># 4. Collapse all texts per vessel</span></span>
<span id="cb45-846"><a href="#cb45-846" aria-hidden="true" tabindex="-1"></a><span class="in">vessel_texts &lt;- comm_by_vessel %&gt;%</span></span>
<span id="cb45-847"><a href="#cb45-847" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(vessel) %&gt;%</span></span>
<span id="cb45-848"><a href="#cb45-848" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(text = paste(content, collapse = " "), .groups = "drop")</span></span>
<span id="cb45-849"><a href="#cb45-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-850"><a href="#cb45-850" aria-hidden="true" tabindex="-1"></a><span class="in"># 5. Tokenize, remove stop‐words, and compute word frequencies per vessel</span></span>
<span id="cb45-851"><a href="#cb45-851" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_vessel_words &lt;- vessel_texts %&gt;%</span></span>
<span id="cb45-852"><a href="#cb45-852" aria-hidden="true" tabindex="-1"></a><span class="in">  unnest_tokens(word, text) %&gt;%</span></span>
<span id="cb45-853"><a href="#cb45-853" aria-hidden="true" tabindex="-1"></a><span class="in">  anti_join(stop_words, by = "word") %&gt;%</span></span>
<span id="cb45-854"><a href="#cb45-854" aria-hidden="true" tabindex="-1"></a><span class="in">  count(vessel, word, sort = TRUE)</span></span>
<span id="cb45-855"><a href="#cb45-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-856"><a href="#cb45-856" aria-hidden="true" tabindex="-1"></a><span class="in"># 6. Plot one word cloud per vessel</span></span>
<span id="cb45-857"><a href="#cb45-857" aria-hidden="true" tabindex="-1"></a><span class="in">vessel_list &lt;- unique(tidy_vessel_words$vessel)</span></span>
<span id="cb45-858"><a href="#cb45-858" aria-hidden="true" tabindex="-1"></a><span class="in">n_vess   &lt;- length(vessel_list)</span></span>
<span id="cb45-859"><a href="#cb45-859" aria-hidden="true" tabindex="-1"></a><span class="in">n_cols   &lt;- 4</span></span>
<span id="cb45-860"><a href="#cb45-860" aria-hidden="true" tabindex="-1"></a><span class="in">n_rows   &lt;- ceiling(n_vess / n_cols)</span></span>
<span id="cb45-861"><a href="#cb45-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-862"><a href="#cb45-862" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(n_rows, n_cols), mar = c(0, 0, 0, 0))</span></span>
<span id="cb45-863"><a href="#cb45-863" aria-hidden="true" tabindex="-1"></a><span class="in">for (ves in vessel_list) {</span></span>
<span id="cb45-864"><a href="#cb45-864" aria-hidden="true" tabindex="-1"></a><span class="in">  freq_tbl &lt;- tidy_vessel_words %&gt;% filter(vessel == ves)</span></span>
<span id="cb45-865"><a href="#cb45-865" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(freq_tbl) == 0) {</span></span>
<span id="cb45-866"><a href="#cb45-866" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.new()</span></span>
<span id="cb45-867"><a href="#cb45-867" aria-hidden="true" tabindex="-1"></a><span class="in">    title(main = ves)</span></span>
<span id="cb45-868"><a href="#cb45-868" aria-hidden="true" tabindex="-1"></a><span class="in">    next</span></span>
<span id="cb45-869"><a href="#cb45-869" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb45-870"><a href="#cb45-870" aria-hidden="true" tabindex="-1"></a><span class="in">  v &lt;- setNames(freq_tbl$n, freq_tbl$word)</span></span>
<span id="cb45-871"><a href="#cb45-871" aria-hidden="true" tabindex="-1"></a><span class="in">  wordcloud(</span></span>
<span id="cb45-872"><a href="#cb45-872" aria-hidden="true" tabindex="-1"></a><span class="in">    words        = names(v),</span></span>
<span id="cb45-873"><a href="#cb45-873" aria-hidden="true" tabindex="-1"></a><span class="in">    freq         = as.numeric(v),</span></span>
<span id="cb45-874"><a href="#cb45-874" aria-hidden="true" tabindex="-1"></a><span class="in">    max.words    = 20,</span></span>
<span id="cb45-875"><a href="#cb45-875" aria-hidden="true" tabindex="-1"></a><span class="in">    scale        = c(3, 0.5),</span></span>
<span id="cb45-876"><a href="#cb45-876" aria-hidden="true" tabindex="-1"></a><span class="in">    random.order = FALSE</span></span>
<span id="cb45-877"><a href="#cb45-877" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb45-878"><a href="#cb45-878" aria-hidden="true" tabindex="-1"></a><span class="in">  title(main = ves, line = -1)</span></span>
<span id="cb45-879"><a href="#cb45-879" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb45-880"><a href="#cb45-880" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1))</span></span>
<span id="cb45-881"><a href="#cb45-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-882"><a href="#cb45-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-883"><a href="#cb45-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-884"><a href="#cb45-884" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-885"><a href="#cb45-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-886"><a href="#cb45-886" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 3</span></span>
<span id="cb45-887"><a href="#cb45-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-888"><a href="#cb45-888" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb45-889"><a href="#cb45-889" aria-hidden="true" tabindex="-1"></a><span class="fu">### Daily Network Graph of Communication</span></span>
<span id="cb45-890"><a href="#cb45-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-891"><a href="#cb45-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mc3_daily_networks_direct_trimmed, message=FALSE, warning=FALSE, fig.width=16, fig.height=28}</span></span>
<span id="cb45-892"><a href="#cb45-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-893"><a href="#cb45-893" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb45-894"><a href="#cb45-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-895"><a href="#cb45-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-896"><a href="#cb45-896" aria-hidden="true" tabindex="-1"></a><span class="in">daily_comms &lt;- selected_nodes %&gt;%</span></span>
<span id="cb45-897"><a href="#cb45-897" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type=="Event", sub_type=="Communication") %&gt;%</span></span>
<span id="cb45-898"><a href="#cb45-898" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(date=as_date(timestamp)) %&gt;%</span></span>
<span id="cb45-899"><a href="#cb45-899" aria-hidden="true" tabindex="-1"></a><span class="in">  select(idx, date)</span></span>
<span id="cb45-900"><a href="#cb45-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-901"><a href="#cb45-901" aria-hidden="true" tabindex="-1"></a><span class="in">all_dates &lt;- sort(unique(daily_comms$date)) %&gt;% discard(is.na)</span></span>
<span id="cb45-902"><a href="#cb45-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-903"><a href="#cb45-903" aria-hidden="true" tabindex="-1"></a><span class="in">plots &lt;- map(all_dates, function(d) {</span></span>
<span id="cb45-904"><a href="#cb45-904" aria-hidden="true" tabindex="-1"></a><span class="in">  comm_idx &lt;- daily_comms %&gt;% filter(date==d) %&gt;% pull(idx)</span></span>
<span id="cb45-905"><a href="#cb45-905" aria-hidden="true" tabindex="-1"></a><span class="in">  es &lt;- selected_edges %&gt;% filter(type=="sent", to %in% comm_idx) %&gt;% transmute(comm=to, sender=from)</span></span>
<span id="cb45-906"><a href="#cb45-906" aria-hidden="true" tabindex="-1"></a><span class="in">  er &lt;- selected_edges %&gt;% filter(type=="received", from %in% comm_idx) %&gt;% transmute(comm=from, receiver=to)</span></span>
<span id="cb45-907"><a href="#cb45-907" aria-hidden="true" tabindex="-1"></a><span class="in">  dp &lt;- inner_join(es, er, by="comm") %&gt;% transmute(from=sender, to=receiver, type="sent")</span></span>
<span id="cb45-908"><a href="#cb45-908" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(dp)==0) return(NULL)</span></span>
<span id="cb45-909"><a href="#cb45-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-910"><a href="#cb45-910" aria-hidden="true" tabindex="-1"></a><span class="in">  nodes_d &lt;- selected_nodes %&gt;%</span></span>
<span id="cb45-911"><a href="#cb45-911" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(idx %in% unique(c(dp$from, dp$to)), sub_type %in% c("Person", "Vessel"))</span></span>
<span id="cb45-912"><a href="#cb45-912" aria-hidden="true" tabindex="-1"></a><span class="in">  dp &lt;- dp %&gt;% filter(from %in% nodes_d$idx, to %in% nodes_d$idx)</span></span>
<span id="cb45-913"><a href="#cb45-913" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(dp)==0) return(NULL)</span></span>
<span id="cb45-914"><a href="#cb45-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-915"><a href="#cb45-915" aria-hidden="true" tabindex="-1"></a><span class="in">  nm &lt;- tibble(old=nodes_d$idx, new=seq_len(nrow(nodes_d)))</span></span>
<span id="cb45-916"><a href="#cb45-916" aria-hidden="true" tabindex="-1"></a><span class="in">  edges2 &lt;- dp %&gt;%</span></span>
<span id="cb45-917"><a href="#cb45-917" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(nm, by=c("from"="old")) %&gt;% mutate(from=new) %&gt;% select(-new) %&gt;%</span></span>
<span id="cb45-918"><a href="#cb45-918" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(nm, by=c("to"="old")) %&gt;% mutate(to=new) %&gt;% select(-new)</span></span>
<span id="cb45-919"><a href="#cb45-919" aria-hidden="true" tabindex="-1"></a><span class="in">  nodes2 &lt;- nodes_d %&gt;% mutate(idx2=seq_len(nrow(nodes_d)))</span></span>
<span id="cb45-920"><a href="#cb45-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-921"><a href="#cb45-921" aria-hidden="true" tabindex="-1"></a><span class="in">  g &lt;- tbl_graph(nodes=nodes2, edges=edges2, directed=TRUE)</span></span>
<span id="cb45-922"><a href="#cb45-922" aria-hidden="true" tabindex="-1"></a><span class="in">  lay &lt;- create_layout(g, layout="fr", niter=500, area=vcount(g)^2, repulse=vcount(g)^1.2)</span></span>
<span id="cb45-923"><a href="#cb45-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-924"><a href="#cb45-924" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(lay) +</span></span>
<span id="cb45-925"><a href="#cb45-925" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_edge_link(aes(color=type),</span></span>
<span id="cb45-926"><a href="#cb45-926" aria-hidden="true" tabindex="-1"></a><span class="in">                   arrow=arrow(length=unit(4,"mm"), type="closed"),</span></span>
<span id="cb45-927"><a href="#cb45-927" aria-hidden="true" tabindex="-1"></a><span class="in">                   alpha=0.8, width=1) +</span></span>
<span id="cb45-928"><a href="#cb45-928" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_node_point(aes(color=sub_type), size=4) +</span></span>
<span id="cb45-929"><a href="#cb45-929" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_node_text(aes(label=ifelse(sub_type %in% c("Person","Vessel"), label, "")),</span></span>
<span id="cb45-930"><a href="#cb45-930" aria-hidden="true" tabindex="-1"></a><span class="in">                   repel=TRUE, point.padding=unit(0.5,"lines"),</span></span>
<span id="cb45-931"><a href="#cb45-931" aria-hidden="true" tabindex="-1"></a><span class="in">                   box.padding=unit(0.5,"lines"), size=6) +</span></span>
<span id="cb45-932"><a href="#cb45-932" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_edge_color_manual(values=c(sent="#7570B3")) +</span></span>
<span id="cb45-933"><a href="#cb45-933" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values=c(Person="#1b9e77", Vessel="#d95f02")) +</span></span>
<span id="cb45-934"><a href="#cb45-934" aria-hidden="true" tabindex="-1"></a><span class="in">    ggtitle(as.character(d)) +</span></span>
<span id="cb45-935"><a href="#cb45-935" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_void() +</span></span>
<span id="cb45-936"><a href="#cb45-936" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(plot.title=element_text(size=12,hjust=0.5), legend.position="right")</span></span>
<span id="cb45-937"><a href="#cb45-937" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb45-938"><a href="#cb45-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-939"><a href="#cb45-939" aria-hidden="true" tabindex="-1"></a><span class="in">wrap_plots(plots, ncol=2) +</span></span>
<span id="cb45-940"><a href="#cb45-940" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides="collect") +</span></span>
<span id="cb45-941"><a href="#cb45-941" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(title="MC3 Communications by Day")</span></span>
<span id="cb45-942"><a href="#cb45-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-943"><a href="#cb45-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-944"><a href="#cb45-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-945"><a href="#cb45-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-946"><a href="#cb45-946" aria-hidden="true" tabindex="-1"></a><span class="fu">### Communication between People and Vessels</span></span>
<span id="cb45-947"><a href="#cb45-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-948"><a href="#cb45-948" aria-hidden="true" tabindex="-1"></a>**Additional visualisations are done below to further investigate the communication between the pseudonyms and real names.**</span>
<span id="cb45-949"><a href="#cb45-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-952"><a href="#cb45-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-953"><a href="#cb45-953" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-954"><a href="#cb45-954" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb45-955"><a href="#cb45-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-956"><a href="#cb45-956" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Keep only Person/Vessel nodes, assigning colors by sub_type</span></span>
<span id="cb45-957"><a href="#cb45-957" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb45-958"><a href="#cb45-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-959"><a href="#cb45-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb45-960"><a href="#cb45-960" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> idx,</span>
<span id="cb45-961"><a href="#cb45-961" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,</span>
<span id="cb45-962"><a href="#cb45-962" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span>)</span>
<span id="cb45-963"><a href="#cb45-963" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-964"><a href="#cb45-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-965"><a href="#cb45-965" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build direct sender→receiver pairs from communication events</span></span>
<span id="cb45-966"><a href="#cb45-966" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb45-967"><a href="#cb45-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-968"><a href="#cb45-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> to, <span class="at">sender =</span> from)</span>
<span id="cb45-969"><a href="#cb45-969" aria-hidden="true" tabindex="-1"></a>er <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb45-970"><a href="#cb45-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-971"><a href="#cb45-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> from, <span class="at">receiver =</span> to)</span>
<span id="cb45-972"><a href="#cb45-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-973"><a href="#cb45-973" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join on the communication node to get from→to, then count occurrences</span></span>
<span id="cb45-974"><a href="#cb45-974" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(es, er, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-975"><a href="#cb45-975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb45-976"><a href="#cb45-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-977"><a href="#cb45-977" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> dp <span class="sc">%&gt;%</span></span>
<span id="cb45-978"><a href="#cb45-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(from, to, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-979"><a href="#cb45-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes<span class="sc">$</span>id, to <span class="sc">%in%</span> nodes<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb45-980"><a href="#cb45-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">width =</span> count, <span class="at">label =</span> <span class="fu">as.character</span>(count))</span>
<span id="cb45-981"><a href="#cb45-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-982"><a href="#cb45-982" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Draw a visNetwork: node colors by type, edge width and label by count</span></span>
<span id="cb45-983"><a href="#cb45-983" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes, edges) <span class="sc">%&gt;%</span></span>
<span id="cb45-984"><a href="#cb45-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>, <span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-985"><a href="#cb45-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb45-986"><a href="#cb45-986" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb45-987"><a href="#cb45-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#AAAAAA"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb45-988"><a href="#cb45-988" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb45-989"><a href="#cb45-989" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-990"><a href="#cb45-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb45-991"><a href="#cb45-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-992"><a href="#cb45-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span></span>
<span id="cb45-993"><a href="#cb45-993" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-994"><a href="#cb45-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-995"><a href="#cb45-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-996"><a href="#cb45-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-997"><a href="#cb45-997" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb45-998"><a href="#cb45-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-999"><a href="#cb45-999" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3 Part A </span></span>
<span id="cb45-1000"><a href="#cb45-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1001"><a href="#cb45-1001" aria-hidden="true" tabindex="-1"></a>The pseudonyms used are:</span>
<span id="cb45-1002"><a href="#cb45-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1003"><a href="#cb45-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss</span>
<span id="cb45-1004"><a href="#cb45-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1005"><a href="#cb45-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Intern</span>
<span id="cb45-1006"><a href="#cb45-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1007"><a href="#cb45-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mrs Money</span>
<span id="cb45-1008"><a href="#cb45-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1009"><a href="#cb45-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Lookout</span>
<span id="cb45-1010"><a href="#cb45-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1011"><a href="#cb45-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Accountant</span>
<span id="cb45-1012"><a href="#cb45-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1013"><a href="#cb45-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Middleman</span>
<span id="cb45-1014"><a href="#cb45-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1015"><a href="#cb45-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3 Part B</span></span>
<span id="cb45-1016"><a href="#cb45-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1017"><a href="#cb45-1017" aria-hidden="true" tabindex="-1"></a>My visualisations help to break down the communication on a daily basis and to draw the connections between the different people based on their communication groups.</span>
<span id="cb45-1018"><a href="#cb45-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1019"><a href="#cb45-1019" aria-hidden="true" tabindex="-1"></a>From the figures above, it can be seen that the Boss is mostly always on the receiving end of the communication, with the exception of Mako(Vessel). The ones who are in direct contact with Boss are Mrs Money, The Middleman, Rodriguez, Davis, Liam Thorne, The Accountant and Mako (Vessel).</span>
<span id="cb45-1020"><a href="#cb45-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1021"><a href="#cb45-1021" aria-hidden="true" tabindex="-1"></a>Mrs Money, however, receives information mainly from The Intern.</span>
<span id="cb45-1022"><a href="#cb45-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1023"><a href="#cb45-1023" aria-hidden="true" tabindex="-1"></a>The Lookout and The Intern, however, usually communicates in both directions, with The Intern usually on the receiving end of information.</span>
<span id="cb45-1024"><a href="#cb45-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1025"><a href="#cb45-1025" aria-hidden="true" tabindex="-1"></a>The Accountant only got communicated with Boss on 11 October and he is often communicating with The Middleman.</span>
<span id="cb45-1026"><a href="#cb45-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1027"><a href="#cb45-1027" aria-hidden="true" tabindex="-1"></a>The Lookout also sends informations to Sam.</span>
<span id="cb45-1028"><a href="#cb45-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1029"><a href="#cb45-1029" aria-hidden="true" tabindex="-1"></a>**There is a clear hierachy when sending information:**</span>
<span id="cb45-1030"><a href="#cb45-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1031"><a href="#cb45-1031" aria-hidden="true" tabindex="-1"></a>Lookout -<span class="sc">\&gt;</span> Intern -<span class="sc">\&gt;</span> Mrs Money/The Accountant/The Middleman -<span class="sc">\&gt;</span> Boss</span>
<span id="cb45-1032"><a href="#cb45-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1033"><a href="#cb45-1033" aria-hidden="true" tabindex="-1"></a>Lookout -<span class="sc">\&gt;</span> Sam</span>
<span id="cb45-1034"><a href="#cb45-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1035"><a href="#cb45-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1036"><a href="#cb45-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3 Part C</span></span>
<span id="cb45-1037"><a href="#cb45-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1038"><a href="#cb45-1038" aria-hidden="true" tabindex="-1"></a>These visualisations have confirmed my understanding that Boss is likely the leader of the group and the Vessel that is in contact with boss is likely Mako for illegal activities. The illegal activities should be taking place around Nemo Reef or meetings are held around Nemo Reef. The ones of higher positions are probably Mrs Money, The Middleman and The Accountant who reports directly to Boss.</span>
<span id="cb45-1039"><a href="#cb45-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1040"><a href="#cb45-1040" aria-hidden="true" tabindex="-1"></a>Rodriguez, Liam Thorne and Davis seem to be involved directly with The Boss as well.</span>
<span id="cb45-1041"><a href="#cb45-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1042"><a href="#cb45-1042" aria-hidden="true" tabindex="-1"></a>Strangely, Nadia Conti seems to be at the receiving end of the communciation from Elise, Davis and Rodriguez and only replies to Liam Thorne. Nadia Conti is also in contact with several vessels.</span>
<span id="cb45-1043"><a href="#cb45-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1044"><a href="#cb45-1044" aria-hidden="true" tabindex="-1"></a>The Intern and The Lookout seems to be of the same position in the syndicate, but The Intern is the only one who communicates with Mrs Money.</span>
<span id="cb45-1045"><a href="#cb45-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1046"><a href="#cb45-1046" aria-hidden="true" tabindex="-1"></a>The Lookout seems to be reporting to Sam as well, as the communication is always in 1 direction.</span>
<span id="cb45-1047"><a href="#cb45-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-1048"><a href="#cb45-1048" aria-hidden="true" tabindex="-1"></a>**From all the previous analysis, I would like to conclude that Rodriguez and Davis are likely involved in the illegal activities as they are in direct contact with Boss. Sam is also likely involved as The Lookout reports to him frequently.**</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>