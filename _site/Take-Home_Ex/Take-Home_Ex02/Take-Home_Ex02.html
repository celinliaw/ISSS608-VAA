<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liaw Ying Ting, Celin">
<meta name="dcterms.date" content="2025-05-27">

<title>Take-Home_Ex02 – Celin’s ISSS608 Site</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Assets/orange_cat_favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2f6844b3748638c5738d4cf93630e566.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Celin’s ISSS608 Site</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 3 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part1.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part2.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part3.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04_Part4.html">
 <span class="dropdown-text">Hands-on Exercise 4 Part 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex01/In-Class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex02/In-Class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex03/In-Class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex04/In-Class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex05/In-Class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex06/In-Class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex07/In-Class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex08/In-Class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex09/In-Class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-Class _Ex/In-Class_Ex10/In-Class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01_Part2.html">
 <span class="dropdown-text">Take-Home Exercise 1 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#task-and-question" id="toc-task-and-question" class="nav-link" data-scroll-target="#task-and-question">Task and Question</a></li>
  <li><a href="#mc3-kickstarter" id="toc-mc3-kickstarter" class="nav-link" data-scroll-target="#mc3-kickstarter">MC3 Kickstarter</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#import-knowledge-graph-data" id="toc-import-knowledge-graph-data" class="nav-link" data-scroll-target="#import-knowledge-graph-data">Import knowledge Graph Data</a></li>
  <li><a href="#inspecting-knowledge-graph-structure" id="toc-inspecting-knowledge-graph-structure" class="nav-link" data-scroll-target="#inspecting-knowledge-graph-structure">Inspecting Knowledge graph structure</a></li>
  <li><a href="#extracting-the-edges-and-nodes-tables" id="toc-extracting-the-edges-and-nodes-tables" class="nav-link" data-scroll-target="#extracting-the-edges-and-nodes-tables">Extracting the edges and nodes tables</a></li>
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">Initial EDA</a></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">Data Cleaning and Wrangling</a></li>
  <li><a href="#cleaning-and-wrangling-edges" id="toc-cleaning-and-wrangling-edges" class="nav-link" data-scroll-target="#cleaning-and-wrangling-edges">Cleaning and wrangling edges</a></li>
  </ul></li>
  <li><a href="#building-the-tidygraph-object" id="toc-building-the-tidygraph-object" class="nav-link" data-scroll-target="#building-the-tidygraph-object">Building the tidygraph object</a></li>
  <li><a href="#visualising-the-knowledge-graph" id="toc-visualising-the-knowledge-graph" class="nav-link" data-scroll-target="#visualising-the-knowledge-graph">Visualising the knowledge graph</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-Home_Ex02</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liaw Ying Ting, Celin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 27, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 1, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<p>For this take-home exercise 2, Mini-Challenge 3 will be chosen and the visualisation will be done on this topic. The background of the mini challenge and the questions will be listed below. For this mini challenge, I will only be displaying and addressing Question 3 below.</p>
</section>
<section id="background" class="level1">
<h1>Background</h1>
<p>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</p>
<p>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</p>
</section>
<section id="task-and-question" class="level1">
<h1>Task and Question</h1>
<p>Clepper diligently recorded all intercepted radio communications over the last two weeks. With the help of his intern, they have analyzed their content to identify important events and relationships between key players. The result is a knowledge graph describing the last two weeks on Oceanus. Clepper and his intern have spent a large amount of time generating this knowledge graph, and they would now like some assistance using it to answer the following questions.</p>
<ol type="1">
<li><p><strong>Clepper found that messages frequently came in at around the same time each day.</strong></p>
<ul>
<li><p>Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.</p></li>
<li><p>How do these patterns shift over the two weeks of observations?</p></li>
<li><p>Focus on a specific entity and use this information to determine who has influence over them.</p></li>
</ul></li>
<li><p><strong>Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.</strong></p>
<ul>
<li><p>Use visual analytics to help Clepper understand and explore the interactions and relationships between vessels and people in the knowledge graph.</p></li>
<li><p>Are there groups that are more closely associated? If so, what are the topic areas that are predominant for each group?</p>
<ul>
<li>For example, these groupings could be related to: Environmentalism (known associates of Green Guardians), Sailor Shift, and fishing/leisure vessels.</li>
</ul></li>
</ul></li>
<li><p><strong>It was noted by Clepper’s intern that some people and vessels are using pseudonyms to communicate.</strong></p>
<ul>
<li><p>Expanding upon your prior visual analytics, determine who is using pseudonyms to communicate, and what these pseudonyms are.</p>
<p>Some that Clepper has already identified include: “Boss”, and “The Lookout”, but there appear to be many more.</p>
<p>To complicate the matter, pseudonyms may be used by multiple people or vessels.</p></li>
<li><p>Describe how your visualizations make it easier for Clepper to identify common entities in the knowledge graph.</p></li>
<li><p>How does your understanding of activities change given your understanding of pseudonyms?</p></li>
</ul></li>
<li><p><strong>Clepper suspects that Nadia Conti, who was formerly entangled in an illegal fishing scheme, may have continued illicit activity within Oceanus.</strong></p>
<ul>
<li><p>Through visual analytics, provide evidence that Nadia is, or is not, doing something illegal.</p></li>
<li><p>Summarize Nadia’s actions visually. Are Clepper’s suspicions justified?</p></li>
</ul></li>
</ol>
<p><strong>Reflection Questions</strong></p>
<ul>
<li><p>Given the task to develop visualizations for knowledge graphs, did you find that the challenge pushed you to develop new techniques for visual representation?</p></li>
<li><p>Did you participate in last year’s challenge? If so, did your experience last year help prepare you for this year’s challenge?</p></li>
<li><p>What was the most difficult part of working on this year’s data and what could have made it more accessible?</p></li>
</ul>
</section>
<section id="mc3-kickstarter" class="level1">
<h1>MC3 Kickstarter</h1>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>In the code chunk below, <code>p_load()</code> of pacman package is used to load the R packages into R environment.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               tidygraph, ggraph,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               SmartEDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-knowledge-graph-data" class="level2">
<h2 class="anchored" data-anchor-id="import-knowledge-graph-data">Import knowledge Graph Data</h2>
<p>For this exercise, <em>mc3.json</em> file will be used. In the code chunk below, <code>fromJSON()</code> of jsonlite package is used to import <em>mc3.json</em> file into R and save the output object.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inspecting-knowledge-graph-structure" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-knowledge-graph-structure">Inspecting Knowledge graph structure</h2>
<p>In the code chunk below, <code>glimpse()</code> is used to reveal the structure of the <em>mc3</em> knowledge graph.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ directed  : logi TRUE
 $ multigraph: logi FALSE
 $ graph     :List of 4
  ..$ mode        : chr "static"
  ..$ edge_default: Named list()
  ..$ node_default: Named list()
  ..$ name        : chr "VAST_MC3_Knowledge_Graph"
 $ nodes     :'data.frame': 1159 obs. of  31 variables:
  ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  ..$ findings         : chr [1:1159] NA NA NA NA ...
  ..$ content          : chr [1:1159] NA NA NA NA ...
  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  ..$ results          : chr [1:1159] NA NA NA NA ...
  ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  ..$ destination      : chr [1:1159] NA NA NA NA ...
  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  ..$ outcome          : chr [1:1159] NA NA NA NA ...
  ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  ..$ thing_collected  :'data.frame':   1159 obs. of  2 variables:
  .. ..$ type: chr [1:1159] NA NA NA NA ...
  .. ..$ name: chr [1:1159] NA NA NA NA ...
  ..$ reference        : chr [1:1159] NA NA NA NA ...
  ..$ date             : chr [1:1159] NA NA NA NA ...
  ..$ time             : chr [1:1159] NA NA NA NA ...
  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  ..$ start_date       : chr [1:1159] NA NA NA NA ...
  ..$ end_date         : chr [1:1159] NA NA NA NA ...
  ..$ report_type      : chr [1:1159] NA NA NA NA ...
  ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  ..$ operational_role : chr [1:1159] NA NA NA NA ...
 $ edges     :'data.frame': 3226 obs. of  5 variables:
  ..$ id         : chr [1:3226] "2" "3" "5" "3013" ...
  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  ..$ source     : chr [1:3226] "Sam" "Sam" "Sam" "Sam" ...
  ..$ target     : chr [1:3226] "Relationship_Suspicious_217" "Event_Communication_370" "Event_Assessment_600" "Relationship_Colleagues_430" ...
  ..$ type       : chr [1:3226] NA "sent" NA NA ...</code></pre>
</div>
</div>
</section>
<section id="extracting-the-edges-and-nodes-tables" class="level2">
<h2 class="anchored" data-anchor-id="extracting-the-edges-and-nodes-tables">Extracting the edges and nodes tables</h2>
<p>Next, <code>as_tibble()</code> of tibble package is used to extract the nodes and links tibble data frames from <em>mc3</em> tibble dataframe into two separate tibble dataframes called <em>mc3_nodes</em> and <em>mc3_edges</em> respectively.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">Initial EDA</h2>
<p>In the code chunk below, <code>ExpCatViz()</code> of SmartEDA package is used to reveal the frequency distribution of all categorical fields in <em>mc3_nodes</em> tibble dataframe</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[13]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[14]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-5-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On the other hand, code chunk below uses <code>ExpCATViz()</code> of SmartEDA package to reveal the frequency distribution of all categorical fields in <em>mc3_edges</em> tibble dataframe</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_edges,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-cleaning-and-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-wrangling">Data Cleaning and Wrangling</h2>
<p>The code chunk below performs the following data cleaning tasks:</p>
<ul>
<li><p>convert values in id field into character data type</p></li>
<li><p>exclude records with <code>id</code> value</p></li>
<li><p>exclude records with similar id values</p></li>
<li><p>exclude <code>thing_collected</code> field</p></li>
<li><p>save the cleaned tibble dataframe into a new tibble datatable called <code>mc_nodes_cleaned</code></p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaning-and-wrangling-edges" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-and-wrangling-edges">Cleaning and wrangling edges</h2>
<p>Next, the code chunk will be used to:</p>
<ul>
<li><p>rename source and target fields to form_id and to_id respectively</p></li>
<li><p>convert values in from_id and to_id fields to character data type</p></li>
<li><p>exclude values in from_id and to_id which is not found in the id field of mc3_nodes_cleaned</p></li>
<li><p>exclude records whereby from_id and/or to_id values are missing</p></li>
<li><p>save the cleaned tibble dataframe and call it mc3_edges_cleaned</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, code chunk below will be used to create mapping of character id in <code>mc3_nodes_cleaned</code> to row index.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to join and convert <code>from_id</code> and <code>to_id</code> to integer indices. At the same time, we will drop rows with unmatched nodes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below is used to subset nodes to only those referenced by edges</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will then use th code chunk below to rebuild lookup from old index to new index</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below will be used to update edge indices to match new node table</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc3_edges_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,226
Columns: 4
$ from        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3…
$ to          &lt;int&gt; 1138, 357, 747, 895, 876, 888, 896, 145, 404, 876, 888, 92…
$ is_inferred &lt;lgl&gt; TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, T…
$ type        &lt;chr&gt; NA, "sent", NA, NA, NA, NA, NA, "sent", "sent", NA, NA, NA…</code></pre>
</div>
</div>
</section>
</section>
<section id="building-the-tidygraph-object" class="level1">
<h1>Building the tidygraph object</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'tbl_graph', 'igraph'  hidden list of 10
 $ : num 1159
 $ : logi TRUE
 $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...
 $ : num [1:3226] 1137 356 746 894 875 ...
 $ : NULL
 $ : NULL
 $ : NULL
 $ : NULL
 $ :List of 4
  ..$ : num [1:3] 1 0 1
  ..$ : Named list()
  ..$ :List of 31
  .. ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  .. ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  .. ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ findings         : chr [1:1159] NA NA NA NA ...
  .. ..$ content          : chr [1:1159] NA NA NA NA ...
  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ results          : chr [1:1159] NA NA NA NA ...
  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ destination      : chr [1:1159] NA NA NA NA ...
  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...
  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ reference        : chr [1:1159] NA NA NA NA ...
  .. ..$ date             : chr [1:1159] NA NA NA NA ...
  .. ..$ time             : chr [1:1159] NA NA NA NA ...
  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...
  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...
  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...
  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...
  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ :List of 2
  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  .. ..$ type       : chr [1:3226] NA "sent" NA NA ...
 $ :&lt;environment: 0x0000021feaf7d970&gt; 
 - attr(*, "active")= chr "nodes"</code></pre>
</div>
</div>
</section>
<section id="visualising-the-knowledge-graph" class="level1">
<h1>Visualising the knowledge graph</h1>
<p>Several of the ggraph layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the code chunk below, ggraph fundtions are used to create the whole graph</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-1" class="level1">
<h1>Question 1</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)   <span class="co"># date‐time parsing</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   <span class="co"># data manipulation &amp; ggplot2</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extract timestamp of each Communication event</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>comm_times <span class="ot">&lt;-</span> mc3_graph <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"Event"</span>, sub_type<span class="sc">==</span><span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">dt   =</span> <span class="fu">ymd_hms</span>(timestamp),         <span class="co"># full POSIX</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">day  =</span> <span class="fu">as_date</span>(dt),                <span class="co"># calendar date</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(dt)                    <span class="co"># hour of day</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Count per day/hour</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>heat <span class="ot">&lt;-</span> comm_times <span class="sc">%&gt;%</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(day, hour)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot heatmap</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heat, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> hour, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name=</span><span class="st">"Messages"</span>) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Communications by Day and Hour"</span>,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Two‐week window"</span>,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Hour of Day"</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/viz1-comm-heatmap-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Re‐use comm_times from Viz 1</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>daily_trend <span class="ot">&lt;-</span> comm_times <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(day)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Plot line chart</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_trend, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Communication Volume"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Number of Messages"</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ─────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization 1.1: Bar chart of the top 20 words in Communication events</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ─────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># dplyr, ggplot2</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)     <span class="co"># unnest_tokens, stop_words</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extract all Communication event texts</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>comms <span class="ot">&lt;-</span> mc3_graph <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"nodes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(content)      <span class="co"># just keep the text column</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Tokenize into individual words (lowercased)</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> comms <span class="sc">%&gt;%</span> </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, content)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Remove English stop-words (a, the, is, etc.)</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"stop_words"</span>)    <span class="co"># from tidytext</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>clean_words <span class="ot">&lt;-</span> words <span class="sc">%&gt;%</span> </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by =</span> <span class="st">"word"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Count and keep the top 20 most frequent words</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>top20 <span class="ot">&lt;-</span> clean_words <span class="sc">%&gt;%</span> </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Plot as a horizontal bar chart</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top20, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(word, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 20 Words in Communication Events"</span>,</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Word"</span>,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Ex02_files/figure-html/top20-communication-words-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)     <span class="co"># for arrow() helper</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)       <span class="co"># for unit()</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. select only the nodes we care about</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>selected_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Entity"</span>     <span class="sc">&amp;</span> sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">|</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Event"</span>      <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span>)      <span class="sc">|</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Relationship"</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idx =</span> <span class="fu">row_number</span>())  <span class="co"># new index in the filtered graph</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping old_index → new idx</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>id_map <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">old =</span> new_index, <span class="at">new =</span> idx)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. filter edges so both ends are in selected_nodes</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>selected_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> id_map<span class="sc">$</span>old, to <span class="sc">%in%</span> id_map<span class="sc">$</span>old) <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. re-index the endpoints</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span>   <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new   =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># — assume selected_nodes and selected_edges have already been defined earlier —</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter edges to only the three types we care about</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>viz_edges <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sent"</span>, <span class="st">"received"</span>, <span class="st">"evidence_for"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> from,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">to   =</span> to,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> type,        <span class="co"># show “sent” / “received” / “evidence_for” on hover</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>        <span class="co"># add an arrowhead pointing at the “to” node</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Build a node table containing every node that appears in viz_edges</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>all_node_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(viz_edges<span class="sc">$</span>from, viz_edges<span class="sc">$</span>to))</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>viz_nodes <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(idx <span class="sc">%in%</span> all_node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> idx,             <span class="co"># must match viz_edges$from/to</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,           <span class="co"># human‐readable name for hover/selection</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> sub_type         <span class="co"># this will drive automatic coloring and legend</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) A minimal visNetwork call</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(viz_nodes, viz_edges, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"700px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">list</span>(</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">color     =</span> <span class="st">"#999999"</span>,  <span class="co"># default edge color (light gray)</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">highlight =</span> <span class="st">"#FF0000"</span>   <span class="co"># color when you hover over an edge</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest  =</span> <span class="cn">TRUE</span>,   <span class="co"># highlight edges when you hover a node</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection  =</span> <span class="cn">TRUE</span>    <span class="co"># dropdown to select a node by label</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">position  =</span> <span class="st">"right"</span>,</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">main      =</span> <span class="st">"Node Sub-type"</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-b316f80421c5be0435d7" style="width:100%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-b316f80421c5be0435d7">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"group":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"]},"edges":{"from":[1,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,29,29,29,29,29,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,34,35,35,36,37,37,38,38,39,39,39,39,40,41,42,43,44,45,45,46,47,47,48,48,48,49,50,50,50,50,51,52,52,54,54,55,55,56,56,57,57,58,58,58,58,59,59,60,61,61,62,63,63,65,67,68,69,69,69,70,71,71,72,74,74,75,75,75,76,77,77,78,79,79,80,81,82,82,82,83,84,84,85,85,86,87,88,88,88,89,90,90,90,91,91,91,92,92,93,93,94,94,96,96,97,97,98,99,100,100,100,100,101,102,102,102,103,104,105,105,106,106,106,107,107,107,108,108,109,109,109,110,111,112,113,114,114,114,115,115,117,117,117,118,120,121,122,122,122,123,123,123,124,125,125,125,126,127,128,129,130,131,132,133,134,135,135,135,135,136,136,138,138,139,139,140,140,141,141,142,142,143,143,143,144,144,144,145,145,145,145,145,146,146,146,147,147,147,148,148,149,149,150,150,151,151,153,154,155,156,156,157,157,157,158,158,158,159,159,160,160,160,161,163,164,165,166,167,167,168,168,169,170,170,171,172,172,173,173,173,173,174,175,176,177,177,177,178,178,179,179,179,180,181,182,183,183,183,184,184,184,185,185,186,186,187,187,187,188,188,188,189,189,189,189,189,189,189,189,190,190,190,190,191,191,191,192,192,193,194,194,195,196,196,197,197,198,198,199,200,201,203,204,205,206,206,206,208,208,209,210,211,211,212,213,214,214,215,216,217,218,218,219,220,221,223,223,223,225,226,226,227,227,228,228,229,229,230,230,231,231,232,233,233,234,234,235,235,237,238,238,238,238,239,239,240,240,241,242,243,243,244,244,244,244,244,246,246,247,247,248,248,248,248,249,249,249,250,250,250,251,251,251,253,254,254,255,255,256,256,257,257,257,258,258,258,259,259,260,261,261,261,262,263,263,264,264,265,266,266,267,268,269,269,269,270,270,270,271,272,272,272,273,274,275,276,277,277,278,278,280,281,281,281,281,282,282,282,282,283,283,284,284,284,285,285,285,286,287,287,287,288,289,290,290,292,292,293,294,295,295,296,296,296,297,297,298,298,299,299,300,300,301,301,301,302,303,303,304,304,305,305,306,306,307,308,308,309,310,311,312,312,313,313,313,314,314,315,315,316,316,316,317,318,319,319,320,320,321,321,322,323,324,325,325,326,326,327,327,328,328,329,329,329,330,330,330,331,331,332,333,334,335,336,336,336,337,337,337,337,338,338,339,340,340,340,341,341,341,342,343,343,343,343,344,344,345,346,346,347,347,348,348,349,349,350,350,350,351,351,351,352,352,353,353,353,354,354,355,355,356,356,357,357,358,358,359,360,360,361,362,362,363,363,363,364,364,364,365,365,365,366,367,367,369,370,370,371,371,372,373,373,374,374,374,374,375,376,377,378,378,379,379,380,381,382,382,383,383,385,385,385,386,386,387,388,388,389,389,390,391,391,391,392,392,393,395,396,396,396,396,397,397,398,398,399,399,400,401,403,404,405,405,406,406,406,406,407,408,409,411,411,411,412,413,413,414,414,415,416,416,418,418,419,419,420,420,421,421,422,422,423,423,424,424,424,425,425,426,426,428,428,429,429,429,430,430,431,431,432,432,433,433,435,435,435,436,436,437,437,438,438,439,439,440,441,441,441,442,442,442,443,443,444,444,444,444,444,445,445,446,447,448,448,449,450,450,450,451,452,452,453,453,453,455,456,456,457,457,457,458,458,459,459,459,459,460,460,461,461,462,462,462,463,463,465,465,466,466,466,467,467,468,468,468,469,469,470,470,470,471,471,471,472,473,473,473,474,474,474,474,475,475,475,476,476,476,477,477,477,478,478,479,479,480,480,481,481,482,482,483,484,484,485,485,485,486,486,486,487,488,489,490,491,491,493,494,494,495,496,497,497,497,498,498,498,499,500,500,501,501,501,502,502,502,503,503,503,504,504,505,505,506,506,506,507,507,508,508,508,509,510,510,511,511,511,511,512,513,513,514,514,515,515,515,516,517,517,518,519,519,520,520,521,522,522,522,522,523,523,523,524,524,525,526,526,526,527,527,527,527,527,528,528,529,529,529,530,530,530,533,533,534,534,534,535,535,536,536,537,537,538,538,539,540,541,542,542,543,543,544,544,545,545,546,546,547,547,548,549,549,550,550,551,551,552,553,553,554,555,556,556,557,557,558,559,560,561,561,562,563,564,565,566,566,566,567,567,568,568,569,570,570,570,571,571,571,572,572,573,574,574,575,575,576,576,576,577,578,579,579,579,579,580,580,581,582,582,583,584,585,585,585,586,586,586,587,588,588,588,589,589,589,589,590,590,590,592,593,593,594,594,595,596,596,596,597,597,598,599,599,599,600,600,600,601,601,601,602,603,603,605,606,607,607,607,608,608,608,609,609,610,611,612,612,613,614,614,615,615,616,616,617,617],"to":[248,36,295,219,222,338,342,344,372,497,531,337,383,412,444,454,61,224,339,341,452,461,466,468,551,580,591,70,72,89,95,257,348,407,434,436,49,96,178,190,191,196,198,228,334,351,352,370,371,373,406,501,511,528,529,536,545,571,596,597,608,114,143,169,217,269,328,359,374,478,502,503,506,558,606,105,107,108,110,145,147,149,238,240,242,254,306,308,310,312,314,480,482,484,486,104,106,109,144,146,148,239,241,253,307,309,311,313,479,481,483,485,487,35,37,79,82,125,127,171,211,250,294,296,336,379,382,414,442,443,448,450,540,542,574,576,582,34,78,83,124,132,139,170,199,210,249,293,335,375,377,378,395,413,415,432,446,447,449,494,496,499,539,541,569,575,577,581,583,611,453,543,590,38,40,51,80,81,100,126,128,172,174,189,245,247,251,301,304,346,380,456,42,44,59,60,119,185,187,188,332,451,498,544,589,39,41,43,50,173,186,207,209,244,115,122,329,507,527,592,607,270,272,274,279,280,282,284,300,302,318,325,326,327,331,343,345,350,357,381,387,388,401,410,422,469,471,474,476,512,514,516,535,557,605,64,66,101,103,193,195,368,45,47,53,161,265,273,324,518,46,68,86,97,102,112,116,176,182,205,231,243,256,258,267,271,298,303,305,321,347,349,353,366,417,419,424,433,470,472,505,509,561,573,610,52,130,159,160,175,194,260,285,315,317,319,364,367,384,392,393,397,399,420,421,431,445,462,464,500,519,538,549,559,562,572,587,588,600,75,92,94,151,215,278,289,361,376,524,548,550,595,604,430,492,495,91,93,150,277,398,457,458,460,463,467,594,601,602,603,73,76,152,181,183,184,200,212,288,316,360,365,427,429,532,560,570,598,85,111,113,416,504,510,129,131,437,537,615,162,164,166,402,56,121,123,153,154,227,262,283,320,322,330,354,355,356,386,423,475,508,515,533,546,547,584,586,593,554,609,616,617,12,13,618,1,15,644,17,620,15,630,620,621,17,16,17,16,17,22,650,21,23,650,22,797,663,7,15,621,630,620,16,21,650,21,674,31,687,622,687,718,743,5,756,744,749,15,630,15,757,739,757,23,758,20,20,31,23,745,866,759,6,652,695,24,760,27,761,768,24,25,763,1,15,644,12,12,13,720,644,1,28,764,22,813,623,721,6,695,749,670,26,722,778,24,765,778,26,766,24,778,26,766,22,648,831,832,674,674,17,630,627,620,22,20,833,624,31,10,11,632,10,651,723,11,870,873,11,632,10,724,871,11,22,28,22,8,834,668,22,767,21,748,674,5,27,8,31,625,652,22,626,687,12,15,627,644,12,15,16,23,29,25,27,749,749,23,735,749,866,735,866,5,749,27,653,25,835,24,761,31,655,17,656,628,10,836,875,11,872,873,874,632,10,837,875,11,876,632,10,877,11,632,24,778,27,768,655,657,749,769,629,31,658,878,31,659,856,21,650,21,660,661,22,30,662,30,898,30,746,768,840,7,1,675,15,17,720,15,627,847,620,16,22,23,22,746,675,7,831,22,746,675,27,22,27,24,879,781,22,663,879,17,749,16,621,15,621,630,17,621,630,17,838,839,664,630,620,656,621,31,665,747,865,31,666,865,31,831,23,20,796,31,7,831,22,749,7,831,27,24,725,22,22,675,5,770,739,17,844,22,12,15,675,840,679,749,679,888,31,17,3,667,667,667,3,5,771,739,749,31,787,22,787,668,831,669,690,22,675,7,668,749,670,749,23,704,866,704,772,11,841,632,872,10,726,11,632,10,11,17,675,15,880,842,843,620,15,671,12,671,2,631,881,638,12,727,882,15,720,675,17,811,675,10,11,632,22,675,6,773,22,695,749,17,899,749,23,774,672,22,673,752,643,17,775,21,650,674,19,694,675,675,7,675,648,22,676,807,19,21,776,671,19,777,840,749,24,778,22,779,780,19,844,845,777,31,677,844,790,19,787,31,678,790,24,818,672,830,27,679,749,24,27,781,840,846,752,1,13,1,619,15,782,860,22,668,793,668,19,694,4,783,19,784,680,22,4,788,22,847,27,675,11,632,10,11,632,10,11,10,11,632,10,728,785,11,632,27,786,23,786,883,19,23,24,884,22,787,31,797,787,31,19,22,788,22,680,31,790,789,857,31,681,682,19,790,683,4,791,5,3,3,12,15,860,694,3,900,638,635,5,684,739,5,739,749,3,885,640,19,3,633,634,635,19,636,4,31,637,6,797,22,695,19,675,22,848,685,19,831,694,22,831,31,686,788,22,792,22,787,19,793,31,790,31,687,15,24,883,27,886,840,23,794,823,27,729,823,22,883,675,27,23,786,20,7,688,3,643,20,3,849,8,850,675,648,24,25,730,12,644,15,720,19,860,15,644,3,887,23,749,704,19,792,734,31,790,851,830,888,23,689,752,749,704,704,730,23,736,866,729,26,795,23,798,20,796,19,734,690,844,22,844,797,831,856,879,695,748,19,30,691,692,5,12,644,13,644,1,22,693,22,675,6,675,20,796,26,798,31,790,22,787,31,694,797,26,699,26,765,27,731,3,889,749,23,799,25,816,24,800,6,792,6,695,749,22,675,23,801,866,823,27,696,749,5,802,749,12,697,890,15,644,3,803,638,639,635,25,816,24,12,13,644,12,15,644,627,5,4,891,17,804,897,4,12,852,26,698,749,749,699,26,699,805,749,5,732,17,806,26,732,795,23,732,5,758,26,750,699,5,700,3,892,640,22,788,19,853,793,22,854,788,855,19,807,808,31,860,856,790,19,893,814,807,808,811,31,856,860,17,857,10,701,11,632,10,702,11,632,10,11,632,10,894,753,11,895,632,10,840,749,749,25,703,25,730,672,809,1,5,810,640,14,733,646,23,29,704,22,811,831,7,675,648,3,675,648,22,705,31,812,8,858,857,31,859,22,811,787,28,22,813,22,706,707,831,734,19,860,31,790,19,814,860,815,7,861,23,862,704,24,830,888,735,749,866,704,24,736,830,26,766,671,8,860,694,7,641,642,737,647,863,643,3,863,643,3,643,671,22,787,19,864,643,31,790,31,865,23,704,25,816,1,13,1,15,720,17,817,14,817,3,643,22,708,7,865,23,24,818,25,819,739,714,902,32,709,709,710,19,676,7,711,31,27,22,27,820,23,866,901,752,27,712,752,738,840,25,821,27,22,751,696,7,896,831,22,822,23,13,644,12,644,15,644,627,24,752,5,713,753,739,739,714,12,13,644,12,716,31,715,867,3,868,716,23,26,795,704,14,645,621,646,16,897,646,31,869,740,24,741,766,17,831,675,22,642,25,23,823,729,754,755,704,26,824,717,27,27,825,7,8,7,647,826,31,648,865,22,827,742,24,828,703,902,26,722,22,704,7,649,7,829],"label":["sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","received","received","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","received","evidence_for","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":{"color":"#999999","highlight":"#FF0000"}},"layout":{"randomSeed":123}},"groups":["Person","Vessel","Communication","Friends","Colleagues","AccessPermission","Reports","Jurisdiction","Coordinates","Operates","Suspicious","Unfriendly"],"width":"100%","height":"700px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"main":{"text":"Node Sub-type","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;"}}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># — assume selected_nodes &amp; selected_edges exist already —</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Filter only the edges we want</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>viz_edges <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sent"</span>, <span class="st">"received"</span>, <span class="st">"evidence_for"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> from,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> to,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> type,      <span class="co"># hover‐label shows sent/received/evidence_for</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>       <span class="co"># draw one arrowhead pointing toward the “to” node</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Build the node table: color by exact sub_type, which we’ll call “group”</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>all_node_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(viz_edges<span class="sc">$</span>from, viz_edges<span class="sc">$</span>to))</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>viz_nodes <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(idx <span class="sc">%in%</span> all_node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> idx,        <span class="co"># must match viz_edges$from/to</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,      <span class="co"># human‐readable name under each node</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> sub_type    <span class="co"># exact sub_type: Person, Vessel, Communication,</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># or any of the eight Relationship subtypes</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Draw a visNetwork with multi‐select enabled on “group”</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(viz_nodes, viz_edges, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"700px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#AAAAAA"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">4</span>            <span class="co"># thicker edge lines</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">30</span>,            <span class="co"># bigger node circles</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>) <span class="co"># bigger node labels</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Here’s the key change: allow multiple groups to be selected at once</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="fu">list</span>(</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">variable =</span> <span class="st">"group"</span>,</span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">multiple =</span> <span class="cn">TRUE</span>,     <span class="co"># multi‐select dropdown: you can pick (“Person”, “Vessel”) together</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">style    =</span> <span class="st">'width:200px; height:26px; font-size:14px;'</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">position  =</span> <span class="st">"right"</span>,</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">main      =</span> <span class="st">"Node Sub-types"</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-ba0d097b346deca10955" style="width:100%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba0d097b346deca10955">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"],"group":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Communication","Friends","Friends","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","Colleagues","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","AccessPermission","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Reports","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Jurisdiction","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Coordinates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Operates","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Suspicious","Unfriendly","Unfriendly","Unfriendly","Unfriendly","Unfriendly"]},"edges":{"from":[1,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,29,29,29,29,29,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,34,35,35,36,37,37,38,38,39,39,39,39,40,41,42,43,44,45,45,46,47,47,48,48,48,49,50,50,50,50,51,52,52,54,54,55,55,56,56,57,57,58,58,58,58,59,59,60,61,61,62,63,63,65,67,68,69,69,69,70,71,71,72,74,74,75,75,75,76,77,77,78,79,79,80,81,82,82,82,83,84,84,85,85,86,87,88,88,88,89,90,90,90,91,91,91,92,92,93,93,94,94,96,96,97,97,98,99,100,100,100,100,101,102,102,102,103,104,105,105,106,106,106,107,107,107,108,108,109,109,109,110,111,112,113,114,114,114,115,115,117,117,117,118,120,121,122,122,122,123,123,123,124,125,125,125,126,127,128,129,130,131,132,133,134,135,135,135,135,136,136,138,138,139,139,140,140,141,141,142,142,143,143,143,144,144,144,145,145,145,145,145,146,146,146,147,147,147,148,148,149,149,150,150,151,151,153,154,155,156,156,157,157,157,158,158,158,159,159,160,160,160,161,163,164,165,166,167,167,168,168,169,170,170,171,172,172,173,173,173,173,174,175,176,177,177,177,178,178,179,179,179,180,181,182,183,183,183,184,184,184,185,185,186,186,187,187,187,188,188,188,189,189,189,189,189,189,189,189,190,190,190,190,191,191,191,192,192,193,194,194,195,196,196,197,197,198,198,199,200,201,203,204,205,206,206,206,208,208,209,210,211,211,212,213,214,214,215,216,217,218,218,219,220,221,223,223,223,225,226,226,227,227,228,228,229,229,230,230,231,231,232,233,233,234,234,235,235,237,238,238,238,238,239,239,240,240,241,242,243,243,244,244,244,244,244,246,246,247,247,248,248,248,248,249,249,249,250,250,250,251,251,251,253,254,254,255,255,256,256,257,257,257,258,258,258,259,259,260,261,261,261,262,263,263,264,264,265,266,266,267,268,269,269,269,270,270,270,271,272,272,272,273,274,275,276,277,277,278,278,280,281,281,281,281,282,282,282,282,283,283,284,284,284,285,285,285,286,287,287,287,288,289,290,290,292,292,293,294,295,295,296,296,296,297,297,298,298,299,299,300,300,301,301,301,302,303,303,304,304,305,305,306,306,307,308,308,309,310,311,312,312,313,313,313,314,314,315,315,316,316,316,317,318,319,319,320,320,321,321,322,323,324,325,325,326,326,327,327,328,328,329,329,329,330,330,330,331,331,332,333,334,335,336,336,336,337,337,337,337,338,338,339,340,340,340,341,341,341,342,343,343,343,343,344,344,345,346,346,347,347,348,348,349,349,350,350,350,351,351,351,352,352,353,353,353,354,354,355,355,356,356,357,357,358,358,359,360,360,361,362,362,363,363,363,364,364,364,365,365,365,366,367,367,369,370,370,371,371,372,373,373,374,374,374,374,375,376,377,378,378,379,379,380,381,382,382,383,383,385,385,385,386,386,387,388,388,389,389,390,391,391,391,392,392,393,395,396,396,396,396,397,397,398,398,399,399,400,401,403,404,405,405,406,406,406,406,407,408,409,411,411,411,412,413,413,414,414,415,416,416,418,418,419,419,420,420,421,421,422,422,423,423,424,424,424,425,425,426,426,428,428,429,429,429,430,430,431,431,432,432,433,433,435,435,435,436,436,437,437,438,438,439,439,440,441,441,441,442,442,442,443,443,444,444,444,444,444,445,445,446,447,448,448,449,450,450,450,451,452,452,453,453,453,455,456,456,457,457,457,458,458,459,459,459,459,460,460,461,461,462,462,462,463,463,465,465,466,466,466,467,467,468,468,468,469,469,470,470,470,471,471,471,472,473,473,473,474,474,474,474,475,475,475,476,476,476,477,477,477,478,478,479,479,480,480,481,481,482,482,483,484,484,485,485,485,486,486,486,487,488,489,490,491,491,493,494,494,495,496,497,497,497,498,498,498,499,500,500,501,501,501,502,502,502,503,503,503,504,504,505,505,506,506,506,507,507,508,508,508,509,510,510,511,511,511,511,512,513,513,514,514,515,515,515,516,517,517,518,519,519,520,520,521,522,522,522,522,523,523,523,524,524,525,526,526,526,527,527,527,527,527,528,528,529,529,529,530,530,530,533,533,534,534,534,535,535,536,536,537,537,538,538,539,540,541,542,542,543,543,544,544,545,545,546,546,547,547,548,549,549,550,550,551,551,552,553,553,554,555,556,556,557,557,558,559,560,561,561,562,563,564,565,566,566,566,567,567,568,568,569,570,570,570,571,571,571,572,572,573,574,574,575,575,576,576,576,577,578,579,579,579,579,580,580,581,582,582,583,584,585,585,585,586,586,586,587,588,588,588,589,589,589,589,590,590,590,592,593,593,594,594,595,596,596,596,597,597,598,599,599,599,600,600,600,601,601,601,602,603,603,605,606,607,607,607,608,608,608,609,609,610,611,612,612,613,614,614,615,615,616,616,617,617],"to":[248,36,295,219,222,338,342,344,372,497,531,337,383,412,444,454,61,224,339,341,452,461,466,468,551,580,591,70,72,89,95,257,348,407,434,436,49,96,178,190,191,196,198,228,334,351,352,370,371,373,406,501,511,528,529,536,545,571,596,597,608,114,143,169,217,269,328,359,374,478,502,503,506,558,606,105,107,108,110,145,147,149,238,240,242,254,306,308,310,312,314,480,482,484,486,104,106,109,144,146,148,239,241,253,307,309,311,313,479,481,483,485,487,35,37,79,82,125,127,171,211,250,294,296,336,379,382,414,442,443,448,450,540,542,574,576,582,34,78,83,124,132,139,170,199,210,249,293,335,375,377,378,395,413,415,432,446,447,449,494,496,499,539,541,569,575,577,581,583,611,453,543,590,38,40,51,80,81,100,126,128,172,174,189,245,247,251,301,304,346,380,456,42,44,59,60,119,185,187,188,332,451,498,544,589,39,41,43,50,173,186,207,209,244,115,122,329,507,527,592,607,270,272,274,279,280,282,284,300,302,318,325,326,327,331,343,345,350,357,381,387,388,401,410,422,469,471,474,476,512,514,516,535,557,605,64,66,101,103,193,195,368,45,47,53,161,265,273,324,518,46,68,86,97,102,112,116,176,182,205,231,243,256,258,267,271,298,303,305,321,347,349,353,366,417,419,424,433,470,472,505,509,561,573,610,52,130,159,160,175,194,260,285,315,317,319,364,367,384,392,393,397,399,420,421,431,445,462,464,500,519,538,549,559,562,572,587,588,600,75,92,94,151,215,278,289,361,376,524,548,550,595,604,430,492,495,91,93,150,277,398,457,458,460,463,467,594,601,602,603,73,76,152,181,183,184,200,212,288,316,360,365,427,429,532,560,570,598,85,111,113,416,504,510,129,131,437,537,615,162,164,166,402,56,121,123,153,154,227,262,283,320,322,330,354,355,356,386,423,475,508,515,533,546,547,584,586,593,554,609,616,617,12,13,618,1,15,644,17,620,15,630,620,621,17,16,17,16,17,22,650,21,23,650,22,797,663,7,15,621,630,620,16,21,650,21,674,31,687,622,687,718,743,5,756,744,749,15,630,15,757,739,757,23,758,20,20,31,23,745,866,759,6,652,695,24,760,27,761,768,24,25,763,1,15,644,12,12,13,720,644,1,28,764,22,813,623,721,6,695,749,670,26,722,778,24,765,778,26,766,24,778,26,766,22,648,831,832,674,674,17,630,627,620,22,20,833,624,31,10,11,632,10,651,723,11,870,873,11,632,10,724,871,11,22,28,22,8,834,668,22,767,21,748,674,5,27,8,31,625,652,22,626,687,12,15,627,644,12,15,16,23,29,25,27,749,749,23,735,749,866,735,866,5,749,27,653,25,835,24,761,31,655,17,656,628,10,836,875,11,872,873,874,632,10,837,875,11,876,632,10,877,11,632,24,778,27,768,655,657,749,769,629,31,658,878,31,659,856,21,650,21,660,661,22,30,662,30,898,30,746,768,840,7,1,675,15,17,720,15,627,847,620,16,22,23,22,746,675,7,831,22,746,675,27,22,27,24,879,781,22,663,879,17,749,16,621,15,621,630,17,621,630,17,838,839,664,630,620,656,621,31,665,747,865,31,666,865,31,831,23,20,796,31,7,831,22,749,7,831,27,24,725,22,22,675,5,770,739,17,844,22,12,15,675,840,679,749,679,888,31,17,3,667,667,667,3,5,771,739,749,31,787,22,787,668,831,669,690,22,675,7,668,749,670,749,23,704,866,704,772,11,841,632,872,10,726,11,632,10,11,17,675,15,880,842,843,620,15,671,12,671,2,631,881,638,12,727,882,15,720,675,17,811,675,10,11,632,22,675,6,773,22,695,749,17,899,749,23,774,672,22,673,752,643,17,775,21,650,674,19,694,675,675,7,675,648,22,676,807,19,21,776,671,19,777,840,749,24,778,22,779,780,19,844,845,777,31,677,844,790,19,787,31,678,790,24,818,672,830,27,679,749,24,27,781,840,846,752,1,13,1,619,15,782,860,22,668,793,668,19,694,4,783,19,784,680,22,4,788,22,847,27,675,11,632,10,11,632,10,11,10,11,632,10,728,785,11,632,27,786,23,786,883,19,23,24,884,22,787,31,797,787,31,19,22,788,22,680,31,790,789,857,31,681,682,19,790,683,4,791,5,3,3,12,15,860,694,3,900,638,635,5,684,739,5,739,749,3,885,640,19,3,633,634,635,19,636,4,31,637,6,797,22,695,19,675,22,848,685,19,831,694,22,831,31,686,788,22,792,22,787,19,793,31,790,31,687,15,24,883,27,886,840,23,794,823,27,729,823,22,883,675,27,23,786,20,7,688,3,643,20,3,849,8,850,675,648,24,25,730,12,644,15,720,19,860,15,644,3,887,23,749,704,19,792,734,31,790,851,830,888,23,689,752,749,704,704,730,23,736,866,729,26,795,23,798,20,796,19,734,690,844,22,844,797,831,856,879,695,748,19,30,691,692,5,12,644,13,644,1,22,693,22,675,6,675,20,796,26,798,31,790,22,787,31,694,797,26,699,26,765,27,731,3,889,749,23,799,25,816,24,800,6,792,6,695,749,22,675,23,801,866,823,27,696,749,5,802,749,12,697,890,15,644,3,803,638,639,635,25,816,24,12,13,644,12,15,644,627,5,4,891,17,804,897,4,12,852,26,698,749,749,699,26,699,805,749,5,732,17,806,26,732,795,23,732,5,758,26,750,699,5,700,3,892,640,22,788,19,853,793,22,854,788,855,19,807,808,31,860,856,790,19,893,814,807,808,811,31,856,860,17,857,10,701,11,632,10,702,11,632,10,11,632,10,894,753,11,895,632,10,840,749,749,25,703,25,730,672,809,1,5,810,640,14,733,646,23,29,704,22,811,831,7,675,648,3,675,648,22,705,31,812,8,858,857,31,859,22,811,787,28,22,813,22,706,707,831,734,19,860,31,790,19,814,860,815,7,861,23,862,704,24,830,888,735,749,866,704,24,736,830,26,766,671,8,860,694,7,641,642,737,647,863,643,3,863,643,3,643,671,22,787,19,864,643,31,790,31,865,23,704,25,816,1,13,1,15,720,17,817,14,817,3,643,22,708,7,865,23,24,818,25,819,739,714,902,32,709,709,710,19,676,7,711,31,27,22,27,820,23,866,901,752,27,712,752,738,840,25,821,27,22,751,696,7,896,831,22,822,23,13,644,12,644,15,644,627,24,752,5,713,753,739,739,714,12,13,644,12,716,31,715,867,3,868,716,23,26,795,704,14,645,621,646,16,897,646,31,869,740,24,741,766,17,831,675,22,642,25,23,823,729,754,755,704,26,824,717,27,27,825,7,8,7,647,826,31,648,865,22,827,742,24,828,703,902,26,722,22,704,7,649,7,829],"label":["sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","sent","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","received","received","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","received","evidence_for","received","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","received","received","received","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","received","evidence_for","received","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","received","received","evidence_for","evidence_for","evidence_for","evidence_for","evidence_for","received","evidence_for","evidence_for","received","received","evidence_for","received","received","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","received","evidence_for","evidence_for","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for","received","evidence_for"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":30,"font":{"size":20}},"manipulation":{"enabled":false},"edges":{"width":4,"arrows":"to","color":{"color":"#AAAAAA","highlight":"#FF0000"}},"layout":{"randomSeed":42}},"groups":["Person","Vessel","Communication","Friends","Colleagues","AccessPermission","Reports","Jurisdiction","Coordinates","Operates","Suspicious","Unfriendly"],"width":"100%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width:200px; height:26px; font-size:14px;","multiple":true,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["AccessPermission","Colleagues","Communication","Coordinates","Friends","Jurisdiction","Operates","Person","Reports","Suspicious","Unfriendly","Vessel"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"main":{"text":"Node Sub-types","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;"}}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a tiny example</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>sel_nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">idx       =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label     =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>,<span class="st">"Bob"</span>,<span class="st">"Comm1"</span>,<span class="st">"Alice"</span>,<span class="st">"Bob"</span>,<span class="st">"Comm2"</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type  =</span> <span class="fu">c</span>(<span class="st">"Person"</span>,<span class="st">"Person"</span>,<span class="st">"Communication"</span>,<span class="st">"Person"</span>,<span class="st">"Person"</span>,<span class="st">"Communication"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>sel_edges <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>), </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">to   =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">5</span>), </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"sent"</span>,<span class="st">"received"</span>,<span class="st">"sent"</span>,<span class="st">"received"</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>viz_edges <span class="ot">&lt;-</span> sel_edges <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">from =</span> from, <span class="at">to =</span> to, <span class="at">label =</span> type, <span class="at">arrows =</span> <span class="st">"to"</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>viz_nodes <span class="ot">&lt;-</span> sel_nodes <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">id    =</span> idx,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> label,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">group =</span> sub_type)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(viz_nodes, viz_edges, <span class="at">width=</span><span class="st">"100%"</span>, <span class="at">height=</span><span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows=</span><span class="st">"to"</span>, <span class="at">width=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="fu">list</span>(<span class="at">variable=</span><span class="st">"group"</span>, <span class="at">multiple=</span><span class="cn">TRUE</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(<span class="at">useGroups=</span><span class="cn">TRUE</span>, <span class="at">position=</span><span class="st">"right"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-560a2c4adb7b237140e1" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-560a2c4adb7b237140e1">{"x":{"nodes":{"id":[1,2,3,4,5,6],"label":["Alice","Bob","Comm1","Alice","Bob","Comm2"],"group":["Person","Person","Communication","Person","Person","Communication"]},"edges":{"from":[1,3,4,6],"to":[3,2,6,5],"label":["sent","received","sent","received"],"arrows":["to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":20,"font":{"size":16}},"manipulation":{"enabled":false},"edges":{"width":3,"arrows":"to"},"layout":{"randomSeed":42}},"groups":["Person","Communication"],"width":"100%","height":"400px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":true,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Communication","Person"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-Home_Ex02"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Liaw Ying Ting, Celin"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 27 May 2025</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>For this take-home exercise 2, Mini-Challenge 3 will be chosen and the visualisation will be done on this topic. The background of the mini challenge and the questions will be listed below. For this mini challenge, I will only be displaying and addressing **Questions 2 and 3** below.</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Background</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Task and Question</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>Clepper diligently recorded all intercepted radio communications over the last two weeks. With the help of his intern, they have analyzed their content to identify important events and relationships between key players. The result is a knowledge graph describing the last two weeks on Oceanus. Clepper and his intern have spent a large amount of time generating this knowledge graph, and they would now like some assistance using it to answer the following questions.</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Clepper found that messages frequently came in at around the same time each day.**</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>How do these patterns shift over the two weeks of observations?</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Focus on a specific entity and use this information to determine who has influence over them.</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Clepper has noticed that people often communicate with (or about) the same people or vessels, and that grouping them together may help with the investigation.**</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use visual analytics to help Clepper understand and explore the interactions and relationships between vessels and people in the knowledge graph.</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Are there groups that are more closely associated? If so, what are the topic areas that are predominant for each group?</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>For example, these groupings could be related to: Environmentalism (known associates of Green Guardians), Sailor Shift, and fishing/leisure vessels.</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**It was noted by Clepper’s intern that some people and vessels are using pseudonyms to communicate.**</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Expanding upon your prior visual analytics, determine who is using pseudonyms to communicate, and what these pseudonyms are.</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>        Some that Clepper has already identified include: “Boss”, and “The Lookout”, but there appear to be many more.</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>        To complicate the matter, pseudonyms may be used by multiple people or vessels.</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Describe how your visualizations make it easier for Clepper to identify common entities in the knowledge graph.</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>How does your understanding of activities change given your understanding of pseudonyms?</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Clepper suspects that Nadia Conti, who was formerly entangled in an illegal fishing scheme, may have continued illicit activity within Oceanus.**</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Through visual analytics, provide evidence that Nadia is, or is not, doing something illegal.</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Summarize Nadia’s actions visually. Are Clepper’s suspicions justified?</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>**Reflection Questions**</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given the task to develop visualizations for knowledge graphs, did you find that the challenge pushed you to develop new techniques for visual representation?</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Did you participate in last year’s challenge? If so, did your experience last year help prepare you for this year’s challenge?</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What was the most difficult part of working on this year’s data and what could have made it more accessible?</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="fu"># MC3 Kickstarter</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting Started</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`p_load()`</span> of pacman package is used to load the R packages into R environment.</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite,</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>               tidygraph, ggraph,</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>               SmartEDA, lubridate,</span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>               dplyr, igraph,</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>               grid)</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import knowledge Graph Data</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>For this exercise, *mc3.json* file will be used. In the code chunk below, `fromJSON()` of jsonlite package is used to import *mc3.json* file into R and save the output object.</span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspecting Knowledge graph structure</span></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`glimpse()`</span> is used to reveal the structure of the *mc3* knowledge graph.</span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Extracting the edges and nodes tables</span></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a>Next, <span class="in">`as_tibble()`</span> of tibble package is used to extract the nodes and links tibble data frames from *mc3* tibble dataframe into two separate tibble dataframes called *mc3_nodes* and *mc3_edges* respectively.</span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Initial EDA</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a>In the code chunk below, <span class="in">`ExpCatViz()`</span> of SmartEDA package is used to reveal the frequency distribution of all categorical fields in *mc3_nodes* tibble dataframe</span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes,</span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a>On the other hand, code chunk below uses <span class="in">`ExpCATViz()`</span> of SmartEDA package to reveal the frequency distribution of all categorical fields in *mc3_edges* tibble dataframe</span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_edges,</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"lightblue"</span>)</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Cleaning and Wrangling</span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a>The code chunk below performs the following data cleaning tasks:</span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert values in id field into character data type</span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records with <span class="in">`id`</span> value</span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records with similar id values</span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude <span class="in">`thing_collected`</span> field</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>save the cleaned tibble dataframe into a new tibble datatable called <span class="in">`mc_nodes_cleaned`</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning and wrangling edges</span></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a>Next, the code chunk will be used to:</span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>rename source and target fields to form_id and to_id respectively</span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert values in from_id and to_id fields to character data type</span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude values in from_id and to_id which is not found in the id field of mc3_nodes_cleaned</span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exclude records whereby from_id and/or to_id values are missing</span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>save the cleaned tibble dataframe and call it mc3_edges_cleaned</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source,</span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id),</span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>Next, code chunk below will be used to create mapping of character id in <span class="in">`mc3_nodes_cleaned`</span> to row index.</span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a>Next, the code chunk below will be used to join and convert <span class="in">`from_id`</span> and <span class="in">`to_id`</span> to integer indices. At the same time, we will drop rows with unmatched nodes.</span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a>Next, the code chunk below is used to subset nodes to only those referenced by edges</span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>We will then use th code chunk below to rebuild lookup from old index to new index</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a>Lastly, the code chunk below will be used to update edge indices to match new node table</span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc3_edges_final)</span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a><span class="fu"># Building the tidygraph object</span></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualising the knowledge graph</span></span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>Several of the ggraph layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.</span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a>In the code chunk below, ggraph functions are used to create the whole graph</span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 1</span></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a>For question 1 visualisations, kindly refer to my teammate <span class="co">[</span><span class="ot">Shermainn's</span><span class="co">](https://isss608-sherm.netlify.app/take-home_ex/take-home_ex02/take-home_ex02)</span> website and I will be building on her answers.</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 2</span></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a>For nodes, the code <span class="in">`filter()`</span> will be used to filter out only *Person and Vessel* from *Entity*, and *Communication* from *Event* and their *relationship.*</span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a>After this filter, the nodes only contain:</span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>entity nodes whose sub_type is Person or Vessel</span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Event nodes whose sub_type is Communication</span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Any node whose type is Relationship.</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> adds a new column called idx to the filtered data frame</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span> extracts 2 columns from *selected_nodes* and give them a new id and rename to *id_map*</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a>For Edges, <span class="in">`filter()`</span> keeps only those where both endpoints are in the *old* column of *id_map.*</span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a><span class="in">`left_join()`</span> matches each row's *to* value against *id_map\$old* and brings in *id_map\$new* for that *to* node and renames it *to_new*. Same thing for the *from* column.</span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>selected_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Entity"</span>     <span class="sc">&amp;</span> sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">|</span></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Event"</span>      <span class="sc">&amp;</span> sub_type <span class="sc">==</span> <span class="st">"Communication"</span>)      <span class="sc">|</span></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">==</span> <span class="st">"Relationship"</span>)</span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idx =</span> <span class="fu">row_number</span>())</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a><span class="co"># mapping old_index → new idx</span></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>id_map <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">old =</span> new_index, <span class="at">new =</span> idx)</span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. filter edges so both ends are in selected_nodes</span></span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>selected_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> id_map<span class="sc">$</span>old, to <span class="sc">%in%</span> id_map<span class="sc">$</span>old) <span class="sc">%&gt;%</span></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. re-index the endpoints</span></span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(id_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span>   <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new   =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, type)</span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a>Step 1: we proceed to <span class="in">`filter()`</span> only the edges that we want, specifically *sent, received and evidence_for*. The labels for the edges show "sent", "received" and "evidence_for" using <span class="in">`transmute()`</span>.</span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a>Step 2: We then build the node table and colour by sub_type which is called *group*. The label for the names/vessels will be placed under the node using *label.*</span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a>Step 3: Draw a Viznetwork graph.</span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mc3_viznetwork_multi_select, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="in">library(visNetwork)</span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a><span class="in"># 1</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a><span class="in">viz_edges &lt;- selected_edges %&gt;%</span></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type %in% c("sent", "received", "evidence_for")) %&gt;%</span></span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a><span class="in">    from   = from,</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a><span class="in">    to     = to,</span></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a><span class="in">    label  = type,      </span></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a><span class="in">    arrows = "to"       </span></span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a><span class="in"># 2 </span></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="in">all_node_ids &lt;- unique(c(viz_edges$from, viz_edges$to))</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a><span class="in">viz_nodes &lt;- selected_nodes %&gt;%</span></span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(idx %in% all_node_ids) %&gt;%</span></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="in">    id    = idx,        </span></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a><span class="in">    label = label,      </span></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a><span class="in">    group = sub_type   </span></span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a><span class="in">                        </span></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a><span class="in"># 3</span></span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a><span class="in">visNetwork(viz_nodes, viz_edges, width = "100%", height = "700px") %&gt;%</span></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a><span class="in">  visEdges(</span></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a><span class="in">    arrows = "to",</span></span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a><span class="in">    color  = list(color = "#AAAAAA", highlight = "#FF0000"),</span></span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a><span class="in">    width  = 4            # thicker edge lines</span></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="in">  visNodes(</span></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 30,            # bigger node circles</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="in">    font = list(size = 20) # bigger node labels</span></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a><span class="in">  visOptions(</span></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a><span class="in">    highlightNearest = TRUE,</span></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a><span class="in">    nodesIdSelection = FALSE,</span></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a><span class="in">    # Here’s the key change: allow multiple groups to be selected at once</span></span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a><span class="in">    selectedBy       = list(</span></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a><span class="in">      variable = "group",</span></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a><span class="in">      style    = 'width:200px; height:26px; font-size:14px;'</span></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a><span class="in">  visLegend(</span></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a><span class="in">    useGroups = TRUE,</span></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a><span class="in">    position  = "right",</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="in">    main      = "Node Sub-types"</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a><span class="in">  visLayout(randomSeed = 42)</span></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mc3_viznetwork_multi_select_with_pv_rel, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a><span class="in"># 1) Build the “base” edges exactly as before, but include a default color</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a><span class="in">viz_edges_base &lt;- selected_edges %&gt;%</span></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type %in% c("sent", "received", "evidence_for")) %&gt;%</span></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a><span class="in">    from   = from,</span></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a><span class="in">    to     = to,</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a><span class="in">    label  = type,          # “sent” / “received” / “evidence_for”</span></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a><span class="in">    arrows = "to",</span></span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a><span class="in">    color  = "#AAAAAA"      # default gray for these original edges</span></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a><span class="in"># 2) Identify Person/Vessel ↔ Communication links (type = sent or received).</span></span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a><span class="in">#    For “sent”:   from = Person/Vessel, to = Communication</span></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a><span class="in">#    For “received”: from = Communication, to = Person/Vessel</span></span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a><span class="in">pc_links &lt;- selected_edges %&gt;%</span></span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type %in% c("sent", "received")) %&gt;%</span></span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a><span class="in">    person = ifelse(type == "sent", from, to),</span></span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a><span class="in">    comm   = ifelse(type == "sent", to, from)</span></span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a><span class="in"># 3) Identify Communication → Relationship edges (type = evidence_for)</span></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="in">cr_links &lt;- selected_edges %&gt;%</span></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "evidence_for") %&gt;%</span></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a><span class="in">    comm         = from,</span></span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a><span class="in">    relationship = to</span></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="in"># 4) Join them so that for each (person, comm) we find all (comm → relationship).</span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a><span class="in">#    This creates new edges: Person → Relationship</span></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="in">new_pv_rel_edges &lt;- pc_links %&gt;%</span></span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(cr_links, by = "comm") %&gt;%</span></span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a><span class="in">    from   = person,</span></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="in">    to     = relationship,</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a><span class="in">    label  = "implied",   # or “related”—pick any hover‐label you like</span></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a><span class="in">    arrows = "to",</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a><span class="in">    color  = "blue"       # draw these edges in blue</span></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a><span class="in">  distinct()             # in case multiple duplicates arise</span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="in"># 5) Combine the “base” edges with our new Person→Relationship edges</span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a><span class="in">viz_edges &lt;- bind_rows(viz_edges_base, new_pv_rel_edges)</span></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a><span class="in"># 6) Build the node data frame from all IDs appearing in viz_edges</span></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a><span class="in">all_node_ids &lt;- unique(c(viz_edges$from, viz_edges$to))</span></span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a><span class="in">viz_nodes &lt;- selected_nodes %&gt;%</span></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(idx %in% all_node_ids) %&gt;%</span></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(</span></span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a><span class="in">    id    = idx,         # must match viz_edges$from/to</span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a><span class="in">    label = label,       # human‐readable node label</span></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a><span class="in">    group = sub_type     # Person, Vessel, Communication, or Relationship</span></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a><span class="in"># 7) Plot with visNetwork. Because each edge row has its own 'color',</span></span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a><span class="in">#    visNetwork will draw original edges in gray and the new Person→Relationship</span></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a><span class="in">#    edges in blue. We still supply highlight color for hover, and allow multi‐select.</span></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="in">visNetwork(viz_nodes, viz_edges, width = "100%", height = "700px") %&gt;%</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a><span class="in">  visEdges(</span></span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a><span class="in">    color = list(highlight = "#FF0000"),  # when hovering, edge turns red</span></span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a><span class="in">    width = 4</span></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a><span class="in">  visNodes(</span></span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 30,</span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a><span class="in">    font = list(size = 20)</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a><span class="in">  visOptions(</span></span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a><span class="in">    highlightNearest  = TRUE,</span></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a><span class="in">    nodesIdSelection  = FALSE,</span></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a><span class="in">    selectedBy        = list(</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a><span class="in">      variable = "group",</span></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a><span class="in">      style    = 'width:200px; height:26px; font-size:14px;'</span></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a><span class="in">  visLegend(</span></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a><span class="in">    useGroups = TRUE,</span></span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a><span class="in">    position  = "right",</span></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a><span class="in">    main      = "Node Sub-types"</span></span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a><span class="in">  visLayout(randomSeed = 42)</span></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a>By selecting the different sub-groups from the drop-down below, we can conclude the following information.</span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a>**Colleagues:**</span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a>Person and Person:</span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Accountant and The Middleman</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Intern and Lookout</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Small Fry and Davis</span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Elise and Nadia Conti</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Liame Thorne and Nadia Conti</span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss and Rodriguez</span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Kelly and Sam</span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss and Mrs Money</span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a>Person and Vessel:</span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nadia Conti and Neptune</span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>**Friends:**</span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sam and Kelly</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Intern and Lookout</span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Continue from after mc3_edges_final has been created</span></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)       <span class="co"># for pivot_longer()</span></span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Build sender/receiver pairs and their relationship nodes</span></span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a>send_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> from, <span class="at">comm =</span> to) <span class="sc">%&gt;%</span></span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sender, comm)</span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a>recv_pairs <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(receiver, comm)</span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a>rel_edges <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"evidence_for"</span>, <span class="st">"is_inferred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rel =</span> to, <span class="at">comm =</span> from) <span class="sc">%&gt;%</span></span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rel, comm)</span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Join to get each (sender, receiver, rel) for every communication event</span></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a>triplets <span class="ot">&lt;-</span> send_pairs <span class="sc">%&gt;%</span></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(recv_pairs, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span>          </span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(rel_edges, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span>            </span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a>    <span class="at">person1 =</span> <span class="fu">pmin</span>(sender, receiver),</span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">person2 =</span> <span class="fu">pmax</span>(sender, receiver)</span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(person1, person2, rel, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(person1, person2, rel)</span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Collect unique node‐IDs used (persons/vessels and relationship nodes)</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a>node_ids_used <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(triplets<span class="sc">$</span>person1, triplets<span class="sc">$</span>person2, triplets<span class="sc">$</span>rel))</span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Build a small lookup of node info for those IDs</span></span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a>nodes_sub <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(new_index <span class="sc">%in%</span> node_ids_used) <span class="sc">%&gt;%</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(new_index, label, type, sub_type)</span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a><span class="co"># 4a. Define groups:</span></span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a><span class="co">#    - For entity (Person/Vessel) nodes: group = the person's label (unique per entity)</span></span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a><span class="co">#    - For relationship nodes: group = the relationship subtype (common to many)</span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>nodes_grouped <span class="ot">&lt;-</span> nodes_sub <span class="sc">%&gt;%</span></span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Entity"</span> <span class="sc">&amp;</span> sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>) <span class="sc">~</span> label,</span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="st">"Relationship"</span>                              <span class="sc">~</span> sub_type</span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a><span class="co"># 4b. Assign one distinct color per entity (Person/Vessel) group</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a>entity_groups <span class="ot">&lt;-</span> nodes_grouped <span class="sc">%&gt;%</span></span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(group)</span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a>n_entities <span class="ot">&lt;-</span> <span class="fu">nrow</span>(entity_groups)</span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a>entity_colors <span class="ot">&lt;-</span> grDevices<span class="sc">::</span><span class="fu">rainbow</span>(n_entities)</span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a>entity_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> entity_groups<span class="sc">$</span>group,</span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_entity =</span> entity_colors</span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a><span class="co"># 4c. Assign one distinct color per relationship subtype group</span></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a>rel_groups <span class="ot">&lt;-</span> nodes_grouped <span class="sc">%&gt;%</span></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Relationship"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(group) </span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a>n_rels <span class="ot">&lt;-</span> <span class="fu">nrow</span>(rel_groups)</span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a>  brewer_base <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">min</span>(n_rels, <span class="dv">8</span>), <span class="st">"Set1"</span>)</span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a>  rel_colors <span class="ot">&lt;-</span> <span class="cf">if</span> (n_rels <span class="sc">&gt;</span> <span class="fu">length</span>(brewer_base)) {</span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colorRampPalette</span>(brewer_base)(n_rels)</span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a>    brewer_base[<span class="dv">1</span><span class="sc">:</span>n_rels]</span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a>  rel_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> rel_groups<span class="sc">$</span>group,</span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">color_rel =</span> rel_colors</span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a>  rel_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">character</span>(<span class="dv">0</span>), <span class="at">color_rel =</span> <span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a><span class="co"># 4d. Combine color assignments and build nodes_vis</span></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> nodes_grouped <span class="sc">%&gt;%</span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(entity_map, <span class="at">by =</span> <span class="st">"group"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rel_map,    <span class="at">by =</span> <span class="st">"group"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> new_index,</span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,</span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> group,</span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(color_entity), color_entity, color_rel)</span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Build the visNetwork 'edges' data frame</span></span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a><span class="co"># 5a. Edges between the two people/vessels (the "communication" edge)</span></span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a>edges_comm_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person1,</span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> person2,</span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">"comm"</span>,</span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">2</span>,</span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a><span class="co"># 5b. For each triplet, connect both persons to the relationship node (no label text)</span></span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a>edges_rel_vis <span class="ot">&lt;-</span> triplets <span class="sc">%&gt;%</span></span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="fu">c</span>(person1, person2),</span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="cn">NULL</span>,</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"person"</span></span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a>    <span class="at">from   =</span> person,</span>
<span id="cb44-666"><a href="#cb44-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">to     =</span> rel,</span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">label  =</span> <span class="st">""</span>,   <span class="co"># blank so "is_inferred"/"evidence_for" does not show</span></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">1</span>,</span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a><span class="co"># 5c. Combine both sets of edges</span></span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(edges_comm_vis, edges_rel_vis)</span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-675"><a href="#cb44-675" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Draw the visNetwork with a dropdown filter by 'group'</span></span>
<span id="cb44-676"><a href="#cb44-676" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis) <span class="sc">%&gt;%</span></span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidth         =</span> <span class="dv">1</span>,</span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderWidthSelected =</span> <span class="dv">2</span></span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#AAAAAA"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-686"><a href="#cb44-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb44-687"><a href="#cb44-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy       =</span> <span class="st">"group"</span></span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-693"><a href="#cb44-693" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">c</span>(entity_map<span class="sc">$</span>group, rel_map<span class="sc">$</span>group),</span>
<span id="cb44-694"><a href="#cb44-694" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> <span class="st">"dot"</span>,</span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">c</span>(entity_map<span class="sc">$</span>color_entity, rel_map<span class="sc">$</span>color_rel),</span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Group"</span></span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span></span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidytext)</span></span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a><span class="in">library(wordcloud)</span></span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a><span class="in"># 1. Extract communication‐event nodes with their new_index and content</span></span>
<span id="cb44-710"><a href="#cb44-710" aria-hidden="true" tabindex="-1"></a><span class="in">comm_nodes &lt;- mc3_nodes_final %&gt;%</span></span>
<span id="cb44-711"><a href="#cb44-711" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "Event", sub_type == "Communication") %&gt;%</span></span>
<span id="cb44-712"><a href="#cb44-712" aria-hidden="true" tabindex="-1"></a><span class="in">  select(event_index = new_index, content)</span></span>
<span id="cb44-713"><a href="#cb44-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-714"><a href="#cb44-714" aria-hidden="true" tabindex="-1"></a><span class="in"># 2. Build a mapping from communication events to entities (Organization subtype)</span></span>
<span id="cb44-715"><a href="#cb44-715" aria-hidden="true" tabindex="-1"></a><span class="in">send_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb44-716"><a href="#cb44-716" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "sent") %&gt;%</span></span>
<span id="cb44-717"><a href="#cb44-717" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(entity_index = from, event_index = to)</span></span>
<span id="cb44-718"><a href="#cb44-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-719"><a href="#cb44-719" aria-hidden="true" tabindex="-1"></a><span class="in">recv_map &lt;- mc3_edges_final %&gt;%</span></span>
<span id="cb44-720"><a href="#cb44-720" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type == "received") %&gt;%</span></span>
<span id="cb44-721"><a href="#cb44-721" aria-hidden="true" tabindex="-1"></a><span class="in">  transmute(event_index = from, entity_index = to)</span></span>
<span id="cb44-722"><a href="#cb44-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-723"><a href="#cb44-723" aria-hidden="true" tabindex="-1"></a><span class="in">event_to_entity &lt;- bind_rows(send_map, recv_map)</span></span>
<span id="cb44-724"><a href="#cb44-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-725"><a href="#cb44-725" aria-hidden="true" tabindex="-1"></a><span class="in"># 3. Join event_to_entity with comm_nodes, then keep only Organization entities</span></span>
<span id="cb44-726"><a href="#cb44-726" aria-hidden="true" tabindex="-1"></a><span class="in">comm_by_entity &lt;- event_to_entity %&gt;%</span></span>
<span id="cb44-727"><a href="#cb44-727" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(comm_nodes, by = "event_index") %&gt;%</span></span>
<span id="cb44-728"><a href="#cb44-728" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(</span></span>
<span id="cb44-729"><a href="#cb44-729" aria-hidden="true" tabindex="-1"></a><span class="in">    mc3_nodes_final %&gt;% </span></span>
<span id="cb44-730"><a href="#cb44-730" aria-hidden="true" tabindex="-1"></a><span class="in">      select(entity_index = new_index, sub_type, label),</span></span>
<span id="cb44-731"><a href="#cb44-731" aria-hidden="true" tabindex="-1"></a><span class="in">    by = "entity_index"</span></span>
<span id="cb44-732"><a href="#cb44-732" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb44-733"><a href="#cb44-733" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(sub_type == "Organization") %&gt;%</span></span>
<span id="cb44-734"><a href="#cb44-734" aria-hidden="true" tabindex="-1"></a><span class="in">  select(organization = label, content)</span></span>
<span id="cb44-735"><a href="#cb44-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-736"><a href="#cb44-736" aria-hidden="true" tabindex="-1"></a><span class="in"># 4. Collapse all texts per organization</span></span>
<span id="cb44-737"><a href="#cb44-737" aria-hidden="true" tabindex="-1"></a><span class="in">org_texts &lt;- comm_by_entity %&gt;%</span></span>
<span id="cb44-738"><a href="#cb44-738" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(organization) %&gt;%</span></span>
<span id="cb44-739"><a href="#cb44-739" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(text = paste(content, collapse = " "), .groups = "drop")</span></span>
<span id="cb44-740"><a href="#cb44-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-741"><a href="#cb44-741" aria-hidden="true" tabindex="-1"></a><span class="in"># 5. Tokenize, remove stop‐words, and compute word frequencies per organization</span></span>
<span id="cb44-742"><a href="#cb44-742" aria-hidden="true" tabindex="-1"></a><span class="in">tidy_org_words &lt;- org_texts %&gt;%</span></span>
<span id="cb44-743"><a href="#cb44-743" aria-hidden="true" tabindex="-1"></a><span class="in">  unnest_tokens(word, text) %&gt;%</span></span>
<span id="cb44-744"><a href="#cb44-744" aria-hidden="true" tabindex="-1"></a><span class="in">  anti_join(stop_words, by = "word") %&gt;%</span></span>
<span id="cb44-745"><a href="#cb44-745" aria-hidden="true" tabindex="-1"></a><span class="in">  count(organization, word, sort = TRUE)</span></span>
<span id="cb44-746"><a href="#cb44-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-747"><a href="#cb44-747" aria-hidden="true" tabindex="-1"></a><span class="in"># 6. Plot one word cloud per organization</span></span>
<span id="cb44-748"><a href="#cb44-748" aria-hidden="true" tabindex="-1"></a><span class="in">org_list &lt;- unique(tidy_org_words$organization)</span></span>
<span id="cb44-749"><a href="#cb44-749" aria-hidden="true" tabindex="-1"></a><span class="in">n_orgs   &lt;- length(org_list)</span></span>
<span id="cb44-750"><a href="#cb44-750" aria-hidden="true" tabindex="-1"></a><span class="in">n_cols   &lt;- 2</span></span>
<span id="cb44-751"><a href="#cb44-751" aria-hidden="true" tabindex="-1"></a><span class="in">n_rows   &lt;- ceiling(n_orgs / n_cols)</span></span>
<span id="cb44-752"><a href="#cb44-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-753"><a href="#cb44-753" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(n_rows, n_cols), mar = c(0, 0, 2, 0))</span></span>
<span id="cb44-754"><a href="#cb44-754" aria-hidden="true" tabindex="-1"></a><span class="in">for (org in org_list) {</span></span>
<span id="cb44-755"><a href="#cb44-755" aria-hidden="true" tabindex="-1"></a><span class="in">  freq_tbl &lt;- tidy_org_words %&gt;% filter(organization == org)</span></span>
<span id="cb44-756"><a href="#cb44-756" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(freq_tbl) == 0) {</span></span>
<span id="cb44-757"><a href="#cb44-757" aria-hidden="true" tabindex="-1"></a><span class="in">    plot.new()</span></span>
<span id="cb44-758"><a href="#cb44-758" aria-hidden="true" tabindex="-1"></a><span class="in">    title(main = org)</span></span>
<span id="cb44-759"><a href="#cb44-759" aria-hidden="true" tabindex="-1"></a><span class="in">    next</span></span>
<span id="cb44-760"><a href="#cb44-760" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb44-761"><a href="#cb44-761" aria-hidden="true" tabindex="-1"></a><span class="in">  v &lt;- setNames(freq_tbl$n, freq_tbl$word)</span></span>
<span id="cb44-762"><a href="#cb44-762" aria-hidden="true" tabindex="-1"></a><span class="in">  wordcloud(</span></span>
<span id="cb44-763"><a href="#cb44-763" aria-hidden="true" tabindex="-1"></a><span class="in">    words        = names(v),</span></span>
<span id="cb44-764"><a href="#cb44-764" aria-hidden="true" tabindex="-1"></a><span class="in">    freq         = as.numeric(v),</span></span>
<span id="cb44-765"><a href="#cb44-765" aria-hidden="true" tabindex="-1"></a><span class="in">    max.words    = 100,</span></span>
<span id="cb44-766"><a href="#cb44-766" aria-hidden="true" tabindex="-1"></a><span class="in">    scale        = c(3, 0.5),</span></span>
<span id="cb44-767"><a href="#cb44-767" aria-hidden="true" tabindex="-1"></a><span class="in">    random.order = FALSE</span></span>
<span id="cb44-768"><a href="#cb44-768" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-769"><a href="#cb44-769" aria-hidden="true" tabindex="-1"></a><span class="in">  title(main = org, line = -1)</span></span>
<span id="cb44-770"><a href="#cb44-770" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb44-771"><a href="#cb44-771" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 1))</span></span>
<span id="cb44-772"><a href="#cb44-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-773"><a href="#cb44-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-774"><a href="#cb44-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-775"><a href="#cb44-775" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 3</span></span>
<span id="cb44-776"><a href="#cb44-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-777"><a href="#cb44-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mc3_daily_networks_direct_trimmed, message=FALSE, warning=FALSE, fig.width=16, fig.height=28}</span></span>
<span id="cb44-778"><a href="#cb44-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-779"><a href="#cb44-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-780"><a href="#cb44-780" aria-hidden="true" tabindex="-1"></a><span class="in">daily_comms &lt;- selected_nodes %&gt;%</span></span>
<span id="cb44-781"><a href="#cb44-781" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(type=="Event", sub_type=="Communication") %&gt;%</span></span>
<span id="cb44-782"><a href="#cb44-782" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(date=as_date(timestamp)) %&gt;%</span></span>
<span id="cb44-783"><a href="#cb44-783" aria-hidden="true" tabindex="-1"></a><span class="in">  select(idx, date)</span></span>
<span id="cb44-784"><a href="#cb44-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-785"><a href="#cb44-785" aria-hidden="true" tabindex="-1"></a><span class="in">all_dates &lt;- sort(unique(daily_comms$date)) %&gt;% discard(is.na)</span></span>
<span id="cb44-786"><a href="#cb44-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-787"><a href="#cb44-787" aria-hidden="true" tabindex="-1"></a><span class="in">plots &lt;- map(all_dates, function(d) {</span></span>
<span id="cb44-788"><a href="#cb44-788" aria-hidden="true" tabindex="-1"></a><span class="in">  comm_idx &lt;- daily_comms %&gt;% filter(date==d) %&gt;% pull(idx)</span></span>
<span id="cb44-789"><a href="#cb44-789" aria-hidden="true" tabindex="-1"></a><span class="in">  es &lt;- selected_edges %&gt;% filter(type=="sent", to %in% comm_idx) %&gt;% transmute(comm=to, sender=from)</span></span>
<span id="cb44-790"><a href="#cb44-790" aria-hidden="true" tabindex="-1"></a><span class="in">  er &lt;- selected_edges %&gt;% filter(type=="received", from %in% comm_idx) %&gt;% transmute(comm=from, receiver=to)</span></span>
<span id="cb44-791"><a href="#cb44-791" aria-hidden="true" tabindex="-1"></a><span class="in">  dp &lt;- inner_join(es, er, by="comm") %&gt;% transmute(from=sender, to=receiver, type="sent")</span></span>
<span id="cb44-792"><a href="#cb44-792" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(dp)==0) return(NULL)</span></span>
<span id="cb44-793"><a href="#cb44-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-794"><a href="#cb44-794" aria-hidden="true" tabindex="-1"></a><span class="in">  nodes_d &lt;- selected_nodes %&gt;%</span></span>
<span id="cb44-795"><a href="#cb44-795" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(idx %in% unique(c(dp$from, dp$to)), sub_type %in% c("Person", "Vessel"))</span></span>
<span id="cb44-796"><a href="#cb44-796" aria-hidden="true" tabindex="-1"></a><span class="in">  dp &lt;- dp %&gt;% filter(from %in% nodes_d$idx, to %in% nodes_d$idx)</span></span>
<span id="cb44-797"><a href="#cb44-797" aria-hidden="true" tabindex="-1"></a><span class="in">  if (nrow(dp)==0) return(NULL)</span></span>
<span id="cb44-798"><a href="#cb44-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-799"><a href="#cb44-799" aria-hidden="true" tabindex="-1"></a><span class="in">  nm &lt;- tibble(old=nodes_d$idx, new=seq_len(nrow(nodes_d)))</span></span>
<span id="cb44-800"><a href="#cb44-800" aria-hidden="true" tabindex="-1"></a><span class="in">  edges2 &lt;- dp %&gt;%</span></span>
<span id="cb44-801"><a href="#cb44-801" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(nm, by=c("from"="old")) %&gt;% mutate(from=new) %&gt;% select(-new) %&gt;%</span></span>
<span id="cb44-802"><a href="#cb44-802" aria-hidden="true" tabindex="-1"></a><span class="in">    left_join(nm, by=c("to"="old")) %&gt;% mutate(to=new) %&gt;% select(-new)</span></span>
<span id="cb44-803"><a href="#cb44-803" aria-hidden="true" tabindex="-1"></a><span class="in">  nodes2 &lt;- nodes_d %&gt;% mutate(idx2=seq_len(nrow(nodes_d)))</span></span>
<span id="cb44-804"><a href="#cb44-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-805"><a href="#cb44-805" aria-hidden="true" tabindex="-1"></a><span class="in">  g &lt;- tbl_graph(nodes=nodes2, edges=edges2, directed=TRUE)</span></span>
<span id="cb44-806"><a href="#cb44-806" aria-hidden="true" tabindex="-1"></a><span class="in">  lay &lt;- create_layout(g, layout="fr", niter=500, area=vcount(g)^2, repulse=vcount(g)^1.2)</span></span>
<span id="cb44-807"><a href="#cb44-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-808"><a href="#cb44-808" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(lay) +</span></span>
<span id="cb44-809"><a href="#cb44-809" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_edge_link(aes(color=type),</span></span>
<span id="cb44-810"><a href="#cb44-810" aria-hidden="true" tabindex="-1"></a><span class="in">                   arrow=arrow(length=unit(4,"mm"), type="closed"),</span></span>
<span id="cb44-811"><a href="#cb44-811" aria-hidden="true" tabindex="-1"></a><span class="in">                   alpha=0.8, width=1) +</span></span>
<span id="cb44-812"><a href="#cb44-812" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_node_point(aes(color=sub_type), size=4) +</span></span>
<span id="cb44-813"><a href="#cb44-813" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_node_text(aes(label=ifelse(sub_type %in% c("Person","Vessel"), label, "")),</span></span>
<span id="cb44-814"><a href="#cb44-814" aria-hidden="true" tabindex="-1"></a><span class="in">                   repel=TRUE, point.padding=unit(0.5,"lines"),</span></span>
<span id="cb44-815"><a href="#cb44-815" aria-hidden="true" tabindex="-1"></a><span class="in">                   box.padding=unit(0.5,"lines"), size=6) +</span></span>
<span id="cb44-816"><a href="#cb44-816" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_edge_color_manual(values=c(sent="#7570B3")) +</span></span>
<span id="cb44-817"><a href="#cb44-817" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values=c(Person="#1b9e77", Vessel="#d95f02")) +</span></span>
<span id="cb44-818"><a href="#cb44-818" aria-hidden="true" tabindex="-1"></a><span class="in">    ggtitle(as.character(d)) +</span></span>
<span id="cb44-819"><a href="#cb44-819" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_void() +</span></span>
<span id="cb44-820"><a href="#cb44-820" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(plot.title=element_text(size=12,hjust=0.5), legend.position="right")</span></span>
<span id="cb44-821"><a href="#cb44-821" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb44-822"><a href="#cb44-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-823"><a href="#cb44-823" aria-hidden="true" tabindex="-1"></a><span class="in">wrap_plots(plots, ncol=2) +</span></span>
<span id="cb44-824"><a href="#cb44-824" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(guides="collect") +</span></span>
<span id="cb44-825"><a href="#cb44-825" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_annotation(title="MC3 Communications by Day")</span></span>
<span id="cb44-826"><a href="#cb44-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-827"><a href="#cb44-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-828"><a href="#cb44-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-829"><a href="#cb44-829" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part A</span></span>
<span id="cb44-830"><a href="#cb44-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-831"><a href="#cb44-831" aria-hidden="true" tabindex="-1"></a>The pseudonyms used are:</span>
<span id="cb44-832"><a href="#cb44-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-833"><a href="#cb44-833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Boss</span>
<span id="cb44-834"><a href="#cb44-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-835"><a href="#cb44-835" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Intern</span>
<span id="cb44-836"><a href="#cb44-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-837"><a href="#cb44-837" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mrs Money</span>
<span id="cb44-838"><a href="#cb44-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-839"><a href="#cb44-839" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Lookout</span>
<span id="cb44-840"><a href="#cb44-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-841"><a href="#cb44-841" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Accountant</span>
<span id="cb44-842"><a href="#cb44-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-843"><a href="#cb44-843" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Middleman</span>
<span id="cb44-844"><a href="#cb44-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-845"><a href="#cb44-845" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part B</span></span>
<span id="cb44-846"><a href="#cb44-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-847"><a href="#cb44-847" aria-hidden="true" tabindex="-1"></a>My visualisations help to break down the communication on a daily basis and to draw the connections between the different relationships.</span>
<span id="cb44-848"><a href="#cb44-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-849"><a href="#cb44-849" aria-hidden="true" tabindex="-1"></a>From the figures above, it can be seen that the Boss is mostly always on the receiving end of the communication, with the exception of Mako. The ones who are in direct contact with Boss are Mrs Money, The Middleman, Davis, Liam Thorne, The Accountant and Mako (Vessel).</span>
<span id="cb44-850"><a href="#cb44-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-851"><a href="#cb44-851" aria-hidden="true" tabindex="-1"></a>Mrs Money, however, receives information mainly from The Intern.</span>
<span id="cb44-852"><a href="#cb44-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-853"><a href="#cb44-853" aria-hidden="true" tabindex="-1"></a>The Lookout and The Intern, however, usually communicates in both directions, with The Intern usually on the receiving end of information.</span>
<span id="cb44-854"><a href="#cb44-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-855"><a href="#cb44-855" aria-hidden="true" tabindex="-1"></a>The Lookout also sends informations to Sam.</span>
<span id="cb44-856"><a href="#cb44-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-857"><a href="#cb44-857" aria-hidden="true" tabindex="-1"></a>**There is a clear hierachy when sending information:**</span>
<span id="cb44-858"><a href="#cb44-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-859"><a href="#cb44-859" aria-hidden="true" tabindex="-1"></a>Lookout -<span class="sc">\&gt;</span> Intern -<span class="sc">\&gt;</span> Mrs Money/The Accountant/The Middleman -<span class="sc">\&gt;</span> Boss</span>
<span id="cb44-860"><a href="#cb44-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-861"><a href="#cb44-861" aria-hidden="true" tabindex="-1"></a>Lookout -<span class="sc">\&gt;</span> Sam</span>
<span id="cb44-862"><a href="#cb44-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-863"><a href="#cb44-863" aria-hidden="true" tabindex="-1"></a>**Additional visualisations are done below to further investigate the communication between the pseudonyms and real names.**</span>
<span id="cb44-864"><a href="#cb44-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-867"><a href="#cb44-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-868"><a href="#cb44-868" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-869"><a href="#cb44-869" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb44-870"><a href="#cb44-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-871"><a href="#cb44-871" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Keep only Person/Vessel nodes, assigning colors by sub_type</span></span>
<span id="cb44-872"><a href="#cb44-872" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> selected_nodes <span class="sc">%&gt;%</span></span>
<span id="cb44-873"><a href="#cb44-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-874"><a href="#cb44-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-875"><a href="#cb44-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">id    =</span> idx,</span>
<span id="cb44-876"><a href="#cb44-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> label,</span>
<span id="cb44-877"><a href="#cb44-877" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">ifelse</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span>)</span>
<span id="cb44-878"><a href="#cb44-878" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-879"><a href="#cb44-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-880"><a href="#cb44-880" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Build direct sender→receiver pairs from communication events</span></span>
<span id="cb44-881"><a href="#cb44-881" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb44-882"><a href="#cb44-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-883"><a href="#cb44-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> to, <span class="at">sender =</span> from)</span>
<span id="cb44-884"><a href="#cb44-884" aria-hidden="true" tabindex="-1"></a>er <span class="ot">&lt;-</span> selected_edges <span class="sc">%&gt;%</span></span>
<span id="cb44-885"><a href="#cb44-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-886"><a href="#cb44-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">comm =</span> from, <span class="at">receiver =</span> to)</span>
<span id="cb44-887"><a href="#cb44-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-888"><a href="#cb44-888" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Join on the communication node to get from→to, then count occurrences</span></span>
<span id="cb44-889"><a href="#cb44-889" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(es, er, <span class="at">by =</span> <span class="st">"comm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-890"><a href="#cb44-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">from =</span> sender, <span class="at">to =</span> receiver)</span>
<span id="cb44-891"><a href="#cb44-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-892"><a href="#cb44-892" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> dp <span class="sc">%&gt;%</span></span>
<span id="cb44-893"><a href="#cb44-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(from, to, <span class="at">name =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-894"><a href="#cb44-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> nodes<span class="sc">$</span>id, to <span class="sc">%in%</span> nodes<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb44-895"><a href="#cb44-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">width =</span> count, <span class="at">label =</span> <span class="fu">as.character</span>(count))</span>
<span id="cb44-896"><a href="#cb44-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-897"><a href="#cb44-897" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Draw a visNetwork: node colors by type, edge width and label by count</span></span>
<span id="cb44-898"><a href="#cb44-898" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes, edges) <span class="sc">%&gt;%</span></span>
<span id="cb44-899"><a href="#cb44-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb44-900"><a href="#cb44-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb44-901"><a href="#cb44-901" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#AAAAAA"</span>, <span class="at">highlight =</span> <span class="st">"#FF0000"</span>),</span>
<span id="cb44-902"><a href="#cb44-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">font   =</span> <span class="fu">list</span>(<span class="at">align =</span> <span class="st">"middle"</span>)</span>
<span id="cb44-903"><a href="#cb44-903" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-904"><a href="#cb44-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb44-905"><a href="#cb44-905" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-906"><a href="#cb44-906" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection  =</span> <span class="cn">TRUE</span></span>
<span id="cb44-907"><a href="#cb44-907" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-908"><a href="#cb44-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-909"><a href="#cb44-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-910"><a href="#cb44-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-911"><a href="#cb44-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>